2024-06-01 00:08:00,400 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_cf_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_01_06_2024_00:08:00', 'train_ratio': 0.8, 'gnn': 'lgntaucf', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-01 00:08:02,438 - [INFO] - load train.txt
2024-06-01 00:08:06,455 - [INFO] - building the adj mat ...
2024-06-01 00:08:07,006 - [INFO] - train set len is 810128
2024-06-01 00:08:07,007 - [INFO] - test set len is 217242
2024-06-01 00:08:07,007 - [INFO] - loading over ...
2024-06-01 00:08:07,007 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-01 00:08:19,187 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-01 00:08:19,187 - [INFO] - start training ...
6.425596769544532
2024-06-01 00:08:19,222 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:08:56,043 - [INFO] - E:0|TAU:9.179 9.179, train_time: 35.58, VALID_time: 1.235, loss: 1.603e+03, emb_loss:2.978e-07, nce_loss:-0.5293, best_valid(recall@20): -inf
valid 	 N@5: 0.123, R@5: 0.07959, P@5: 0.09676
valid 	 N@10: 0.125, R@10: 0.1159, P@10: 0.07104
valid 	 N@15: 0.1322, R@15: 0.1436, P@15: 0.05884
valid 	 N@20: 0.1391, R@20: 0.1663, P@20: 0.05118
valid 	 N@25: 0.1457, R@25: 0.1869, P@25: 0.04612
valid 	 N@30: 0.1513, R@30: 0.2044, P@30: 0.04218
valid 	 N@40: 0.1608, R@40: 0.2351, P@40: 0.0365
valid 	 N@50: 0.1688, R@50: 0.2615, P@50: 0.03263

6.425596769544532
2024-06-01 00:08:56,090 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:09:32,555 - [INFO] - E:1|TAU:6.201 24.95, train_time: 35.3, VALID_time: 1.163, loss: 1.529e+03, emb_loss:5.974e-07, nce_loss:-0.5472, best_valid(recall@20): 0.1663
valid 	 N@5: 0.1232, R@5: 0.07862, P@5: 0.0963
valid 	 N@10: 0.125, R@10: 0.1152, P@10: 0.07106
valid 	 N@15: 0.1321, R@15: 0.1426, P@15: 0.05891
valid 	 N@20: 0.1389, R@20: 0.165, P@20: 0.05135
valid 	 N@25: 0.1449, R@25: 0.1841, P@25: 0.04596
valid 	 N@30: 0.1502, R@30: 0.2008, P@30: 0.04192
valid 	 N@40: 0.1592, R@40: 0.2297, P@40: 0.03619
valid 	 N@50: 0.1664, R@50: 0.2534, P@50: 0.03215

6.425596769544532
2024-06-01 00:09:32,585 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:10:19,705 - [INFO] - E:2|TAU:6.504 23.81, train_time: 45.47, VALID_time: 1.651, loss: 1.315e+03, emb_loss:9.008e-07, nce_loss:-0.5607, best_valid(recall@20): 0.1663
valid 	 N@5: 0.1311, R@5: 0.08472, P@5: 0.1029
valid 	 N@10: 0.1326, R@10: 0.1223, P@10: 0.07516
valid 	 N@15: 0.14, R@15: 0.151, P@15: 0.06232
valid 	 N@20: 0.1473, R@20: 0.1748, P@20: 0.05431
valid 	 N@25: 0.1539, R@25: 0.1958, P@25: 0.04874
valid 	 N@30: 0.1597, R@30: 0.2139, P@30: 0.04452
valid 	 N@40: 0.1695, R@40: 0.2452, P@40: 0.03847
valid 	 N@50: 0.1777, R@50: 0.2723, P@50: 0.03437

6.425596769544532
2024-06-01 00:10:19,774 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:11:24,485 - [INFO] - E:3|TAU:6.478 24.81, train_time: 62.94, VALID_time: 1.772, loss: 1.286e+03, emb_loss:1.162e-06, nce_loss:-0.5673, best_valid(recall@20): 0.1748
valid 	 N@5: 0.1324, R@5: 0.08535, P@5: 0.1039
valid 	 N@10: 0.1345, R@10: 0.1246, P@10: 0.07623
valid 	 N@15: 0.1425, R@15: 0.1547, P@15: 0.06349
valid 	 N@20: 0.15, R@20: 0.1792, P@20: 0.05535
valid 	 N@25: 0.1568, R@25: 0.2007, P@25: 0.04973
valid 	 N@30: 0.1626, R@30: 0.219, P@30: 0.04534
valid 	 N@40: 0.1727, R@40: 0.2513, P@40: 0.03922
valid 	 N@50: 0.1809, R@50: 0.2784, P@50: 0.03489

6.425596769544532
2024-06-01 00:11:24,555 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:12:29,455 - [INFO] - E:4|TAU:6.466 22.53, train_time: 63.26, VALID_time: 1.634, loss: 1.263e+03, emb_loss:1.427e-06, nce_loss:-0.5687, best_valid(recall@20): 0.1792
valid 	 N@5: 0.1349, R@5: 0.08733, P@5: 0.1057
valid 	 N@10: 0.1369, R@10: 0.1269, P@10: 0.07737
valid 	 N@15: 0.1447, R@15: 0.1566, P@15: 0.06414
valid 	 N@20: 0.1527, R@20: 0.1822, P@20: 0.05619
valid 	 N@25: 0.1595, R@25: 0.2036, P@25: 0.0504
valid 	 N@30: 0.1655, R@30: 0.2225, P@30: 0.04601
valid 	 N@40: 0.1754, R@40: 0.2546, P@40: 0.03966
valid 	 N@50: 0.1837, R@50: 0.2818, P@50: 0.0353

6.425596769544532
2024-06-01 00:12:29,529 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:13:34,433 - [INFO] - E:5|TAU:6.486 20.27, train_time: 63.14, VALID_time: 1.764, loss: 1.249e+03, emb_loss:1.702e-06, nce_loss:-0.569, best_valid(recall@20): 0.1822
valid 	 N@5: 0.1357, R@5: 0.0879, P@5: 0.1065
valid 	 N@10: 0.1379, R@10: 0.1281, P@10: 0.07813
valid 	 N@15: 0.1456, R@15: 0.1577, P@15: 0.06456
valid 	 N@20: 0.1535, R@20: 0.1832, P@20: 0.05645
valid 	 N@25: 0.1603, R@25: 0.2047, P@25: 0.05057
valid 	 N@30: 0.1664, R@30: 0.2239, P@30: 0.04624
valid 	 N@40: 0.1765, R@40: 0.2564, P@40: 0.03995
valid 	 N@50: 0.185, R@50: 0.2842, P@50: 0.03559

6.425596769544532
2024-06-01 00:13:34,502 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:14:39,316 - [INFO] - E:6|TAU:6.486 19.32, train_time: 63.22, VALID_time: 1.591, loss: 1.238e+03, emb_loss:1.994e-06, nce_loss:-0.5702, best_valid(recall@20): 0.1832
valid 	 N@5: 0.1365, R@5: 0.08853, P@5: 0.1069
valid 	 N@10: 0.1386, R@10: 0.1285, P@10: 0.07827
valid 	 N@15: 0.1462, R@15: 0.1578, P@15: 0.06463
valid 	 N@20: 0.1542, R@20: 0.1837, P@20: 0.0566
valid 	 N@25: 0.1611, R@25: 0.2054, P@25: 0.05074
valid 	 N@30: 0.1672, R@30: 0.2246, P@30: 0.04636
valid 	 N@40: 0.1773, R@40: 0.2571, P@40: 0.04004
valid 	 N@50: 0.1855, R@50: 0.2838, P@50: 0.03556

6.425596769544532
2024-06-01 00:14:39,391 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:15:44,210 - [INFO] - E:7|TAU:6.497 20.04, train_time: 63.23, VALID_time: 1.58, loss: 1.232e+03, emb_loss:2.299e-06, nce_loss:-0.5707, best_valid(recall@20): 0.1837
valid 	 N@5: 0.1364, R@5: 0.08865, P@5: 0.1071
valid 	 N@10: 0.1387, R@10: 0.1289, P@10: 0.07858
valid 	 N@15: 0.1466, R@15: 0.159, P@15: 0.06504
valid 	 N@20: 0.1544, R@20: 0.1842, P@20: 0.0568
valid 	 N@25: 0.1613, R@25: 0.2062, P@25: 0.05098
valid 	 N@30: 0.1676, R@30: 0.2258, P@30: 0.04664
valid 	 N@40: 0.1778, R@40: 0.2585, P@40: 0.04026
valid 	 N@50: 0.186, R@50: 0.2854, P@50: 0.03578

6.425596769544532
2024-06-01 00:15:44,278 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:16:48,635 - [INFO] - E:8|TAU:6.489 19.05, train_time: 62.78, VALID_time: 1.571, loss: 1.226e+03, emb_loss:2.618e-06, nce_loss:-0.571, best_valid(recall@20): 0.1842
valid 	 N@5: 0.1369, R@5: 0.08887, P@5: 0.1076
valid 	 N@10: 0.1392, R@10: 0.1294, P@10: 0.07883
valid 	 N@15: 0.1472, R@15: 0.1598, P@15: 0.06541
valid 	 N@20: 0.155, R@20: 0.1853, P@20: 0.05699
valid 	 N@25: 0.162, R@25: 0.2071, P@25: 0.05116
valid 	 N@30: 0.1682, R@30: 0.2267, P@30: 0.04682
valid 	 N@40: 0.1784, R@40: 0.2591, P@40: 0.0404
valid 	 N@50: 0.1866, R@50: 0.2861, P@50: 0.03589

6.425596769544532
2024-06-01 00:16:48,701 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:17:54,012 - [INFO] - E:9|TAU:6.493 18.59, train_time: 63.73, VALID_time: 1.582, loss: 1.221e+03, emb_loss:2.953e-06, nce_loss:-0.5715, best_valid(recall@20): 0.1853
valid 	 N@5: 0.1372, R@5: 0.08897, P@5: 0.1079
valid 	 N@10: 0.1395, R@10: 0.1295, P@10: 0.07896
valid 	 N@15: 0.1476, R@15: 0.1602, P@15: 0.06546
valid 	 N@20: 0.1555, R@20: 0.1857, P@20: 0.05718
valid 	 N@25: 0.1625, R@25: 0.2077, P@25: 0.05129
valid 	 N@30: 0.1686, R@30: 0.2272, P@30: 0.04689
valid 	 N@40: 0.1788, R@40: 0.2596, P@40: 0.04045
valid 	 N@50: 0.1871, R@50: 0.2869, P@50: 0.03599

6.425596769544532
2024-06-01 00:17:54,086 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:18:59,054 - [INFO] - E:10|TAU:6.487 18.98, train_time: 63.26, VALID_time: 1.709, loss: 1.217e+03, emb_loss:3.301e-06, nce_loss:-0.5719, best_valid(recall@20): 0.1857
valid 	 N@5: 0.1377, R@5: 0.08924, P@5: 0.108
valid 	 N@10: 0.1402, R@10: 0.1303, P@10: 0.07943
valid 	 N@15: 0.1482, R@15: 0.1607, P@15: 0.06576
valid 	 N@20: 0.1561, R@20: 0.1862, P@20: 0.05734
valid 	 N@25: 0.163, R@25: 0.208, P@25: 0.05139
valid 	 N@30: 0.169, R@30: 0.2271, P@30: 0.04688
valid 	 N@40: 0.1796, R@40: 0.2608, P@40: 0.04062
valid 	 N@50: 0.1878, R@50: 0.2879, P@50: 0.0361

6.425596769544532
2024-06-01 00:18:59,140 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:20:04,139 - [INFO] - E:11|TAU:6.494 18.46, train_time: 63.33, VALID_time: 1.661, loss: 1.213e+03, emb_loss:3.664e-06, nce_loss:-0.5721, best_valid(recall@20): 0.1862
valid 	 N@5: 0.1374, R@5: 0.08916, P@5: 0.1078
valid 	 N@10: 0.1402, R@10: 0.1305, P@10: 0.07946
valid 	 N@15: 0.1482, R@15: 0.1608, P@15: 0.06581
valid 	 N@20: 0.156, R@20: 0.1862, P@20: 0.05735
valid 	 N@25: 0.1632, R@25: 0.2087, P@25: 0.05156
valid 	 N@30: 0.1692, R@30: 0.2277, P@30: 0.04703
valid 	 N@40: 0.1796, R@40: 0.2608, P@40: 0.04063
valid 	 N@50: 0.1878, R@50: 0.2878, P@50: 0.03612

6.425596769544532
2024-06-01 00:20:04,165 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:21:09,040 - [INFO] - E:12|TAU:6.497 18.67, train_time: 63.16, VALID_time: 1.713, loss: 1.21e+03, emb_loss:4.039e-06, nce_loss:-0.5725, best_valid(recall@20): 0.1862
valid 	 N@5: 0.138, R@5: 0.08932, P@5: 0.1083
valid 	 N@10: 0.1405, R@10: 0.1303, P@10: 0.07953
valid 	 N@15: 0.1487, R@15: 0.1613, P@15: 0.06594
valid 	 N@20: 0.1564, R@20: 0.1865, P@20: 0.05745
valid 	 N@25: 0.1635, R@25: 0.2089, P@25: 0.05159
valid 	 N@30: 0.1696, R@30: 0.228, P@30: 0.04706
valid 	 N@40: 0.1799, R@40: 0.261, P@40: 0.04071
valid 	 N@50: 0.1881, R@50: 0.2881, P@50: 0.03614

6.425596769544532
2024-06-01 00:21:09,111 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:22:13,832 - [INFO] - E:13|TAU:6.491 18.78, train_time: 63.19, VALID_time: 1.53, loss: 1.207e+03, emb_loss:4.427e-06, nce_loss:-0.5728, best_valid(recall@20): 0.1865
valid 	 N@5: 0.1382, R@5: 0.08977, P@5: 0.1086
valid 	 N@10: 0.1404, R@10: 0.1305, P@10: 0.07954
valid 	 N@15: 0.1488, R@15: 0.1617, P@15: 0.06611
valid 	 N@20: 0.1565, R@20: 0.1868, P@20: 0.05763
valid 	 N@25: 0.1636, R@25: 0.209, P@25: 0.05173
valid 	 N@30: 0.1696, R@30: 0.2282, P@30: 0.04713
valid 	 N@40: 0.18, R@40: 0.2613, P@40: 0.04078
valid 	 N@50: 0.1882, R@50: 0.2883, P@50: 0.03619

6.425596769544532
2024-06-01 00:22:13,886 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:23:18,747 - [INFO] - E:14|TAU:6.502 18.43, train_time: 63.14, VALID_time: 1.716, loss: 1.204e+03, emb_loss:4.827e-06, nce_loss:-0.5731, best_valid(recall@20): 0.1868
valid 	 N@5: 0.1381, R@5: 0.08989, P@5: 0.1085
valid 	 N@10: 0.1405, R@10: 0.1305, P@10: 0.07966
valid 	 N@15: 0.1488, R@15: 0.1619, P@15: 0.0661
valid 	 N@20: 0.1566, R@20: 0.1872, P@20: 0.05767
valid 	 N@25: 0.1636, R@25: 0.2091, P@25: 0.05173
valid 	 N@30: 0.1698, R@30: 0.2288, P@30: 0.04722
valid 	 N@40: 0.1801, R@40: 0.2616, P@40: 0.0408
valid 	 N@50: 0.1882, R@50: 0.2884, P@50: 0.03623

6.425596769544532
2024-06-01 00:23:18,818 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:24:23,672 - [INFO] - E:15|TAU:6.495 18.38, train_time: 63.21, VALID_time: 1.638, loss: 1.201e+03, emb_loss:5.237e-06, nce_loss:-0.5732, best_valid(recall@20): 0.1872
valid 	 N@5: 0.1382, R@5: 0.08961, P@5: 0.1084
valid 	 N@10: 0.141, R@10: 0.1311, P@10: 0.07996
valid 	 N@15: 0.1492, R@15: 0.1621, P@15: 0.06626
valid 	 N@20: 0.1569, R@20: 0.1872, P@20: 0.05773
valid 	 N@25: 0.1639, R@25: 0.2091, P@25: 0.05177
valid 	 N@30: 0.1699, R@30: 0.228, P@30: 0.0472
valid 	 N@40: 0.1804, R@40: 0.2618, P@40: 0.04086
valid 	 N@50: 0.1888, R@50: 0.2893, P@50: 0.03633

6.425596769544532
2024-06-01 00:24:23,703 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:25:28,576 - [INFO] - E:16|TAU:6.508 18.37, train_time: 63.31, VALID_time: 1.56, loss: 1.199e+03, emb_loss:5.656e-06, nce_loss:-0.5735, best_valid(recall@20): 0.1872
valid 	 N@5: 0.1384, R@5: 0.08966, P@5: 0.1085
valid 	 N@10: 0.1411, R@10: 0.131, P@10: 0.07995
valid 	 N@15: 0.1494, R@15: 0.1623, P@15: 0.06635
valid 	 N@20: 0.1572, R@20: 0.1876, P@20: 0.05783
valid 	 N@25: 0.164, R@25: 0.209, P@25: 0.05179
valid 	 N@30: 0.1704, R@30: 0.229, P@30: 0.04738
valid 	 N@40: 0.1807, R@40: 0.262, P@40: 0.04085
valid 	 N@50: 0.1891, R@50: 0.2896, P@50: 0.03635

6.425596769544532
2024-06-01 00:25:28,637 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:26:33,369 - [INFO] - E:17|TAU:6.498 18.68, train_time: 63.19, VALID_time: 1.539, loss: 1.197e+03, emb_loss:6.085e-06, nce_loss:-0.5737, best_valid(recall@20): 0.1876
valid 	 N@5: 0.1385, R@5: 0.08997, P@5: 0.1085
valid 	 N@10: 0.1413, R@10: 0.1314, P@10: 0.08006
valid 	 N@15: 0.1496, R@15: 0.1626, P@15: 0.06636
valid 	 N@20: 0.1575, R@20: 0.1882, P@20: 0.05787
valid 	 N@25: 0.1644, R@25: 0.2099, P@25: 0.05195
valid 	 N@30: 0.1705, R@30: 0.2291, P@30: 0.0474
valid 	 N@40: 0.1809, R@40: 0.2625, P@40: 0.04094
valid 	 N@50: 0.1892, R@50: 0.2895, P@50: 0.03637

6.425596769544532
2024-06-01 00:26:33,434 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:27:38,291 - [INFO] - E:18|TAU:6.493 17.65, train_time: 63.19, VALID_time: 1.665, loss: 1.194e+03, emb_loss:6.523e-06, nce_loss:-0.574, best_valid(recall@20): 0.1882
valid 	 N@5: 0.1383, R@5: 0.08963, P@5: 0.1083
valid 	 N@10: 0.1412, R@10: 0.1314, P@10: 0.0801
valid 	 N@15: 0.1497, R@15: 0.163, P@15: 0.06659
valid 	 N@20: 0.1575, R@20: 0.1883, P@20: 0.05794
valid 	 N@25: 0.1644, R@25: 0.2102, P@25: 0.05196
valid 	 N@30: 0.1706, R@30: 0.2297, P@30: 0.04745
valid 	 N@40: 0.181, R@40: 0.2627, P@40: 0.04097
valid 	 N@50: 0.1893, R@50: 0.2899, P@50: 0.0364

6.425596769544532
2024-06-01 00:27:38,363 - [INFO] - current w_0 is 9.17942388767301
