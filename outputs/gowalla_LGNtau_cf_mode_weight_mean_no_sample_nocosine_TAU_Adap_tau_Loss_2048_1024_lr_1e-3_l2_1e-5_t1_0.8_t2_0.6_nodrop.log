2024-07-03 20:35:47,033 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_cf_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_03_07_2024_20:35:47', 'train_ratio': 0.8, 'gnn': 'lgntaucf', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-07-03 20:35:48,319 - [INFO] - load train.txt
2024-07-03 20:35:50,966 - [INFO] - building the adj mat ...
2024-07-03 20:35:51,306 - [INFO] - train set len is 810128
2024-07-03 20:35:51,307 - [INFO] - test set len is 217242
2024-07-03 20:35:51,307 - [INFO] - loading over ...
2024-07-03 20:35:51,307 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-07-03 20:36:00,096 - [INFO] - Evaluation Protocols is 1 @ 20
2024-07-03 20:36:00,096 - [INFO] - start training ...
6.425596769544532
2024-07-03 20:36:00,133 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:36:46,673 - [INFO] - E:0|TAU:9.179 9.179, train_time: 45.3, VALID_time: 1.237, loss: 5.354e+03, emb_loss:4.078e-07, nce_loss:15.14, best_valid(recall@20): -inf
valid 	 N@5: 0.1125, R@5: 0.07624, P@5: 0.08867
valid 	 N@10: 0.1166, R@10: 0.1123, P@10: 0.06559
valid 	 N@15: 0.1242, R@15: 0.1386, P@15: 0.05438
valid 	 N@20: 0.1315, R@20: 0.1611, P@20: 0.04755
valid 	 N@25: 0.1381, R@25: 0.181, P@25: 0.04293
valid 	 N@30: 0.1437, R@30: 0.1982, P@30: 0.03935
valid 	 N@40: 0.1532, R@40: 0.2281, P@40: 0.03421
valid 	 N@50: 0.1611, R@50: 0.254, P@50: 0.03057

6.425596769544532
2024-07-03 20:36:46,712 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:37:33,186 - [INFO] - E:1|TAU:6.216 24.95, train_time: 45.25, VALID_time: 1.217, loss: 5.032e+03, emb_loss:8.113e-07, nce_loss:15.14, best_valid(recall@20): 0.1611
valid 	 N@5: 0.1178, R@5: 0.07518, P@5: 0.09267
valid 	 N@10: 0.1191, R@10: 0.1094, P@10: 0.06801
valid 	 N@15: 0.1257, R@15: 0.1353, P@15: 0.05632
valid 	 N@20: 0.1318, R@20: 0.1554, P@20: 0.049
valid 	 N@25: 0.1376, R@25: 0.1736, P@25: 0.04397
valid 	 N@30: 0.1425, R@30: 0.1892, P@30: 0.04013
valid 	 N@40: 0.1509, R@40: 0.2158, P@40: 0.0346
valid 	 N@50: 0.1579, R@50: 0.2385, P@50: 0.03078

6.425596769544532
2024-07-03 20:37:33,206 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:38:19,776 - [INFO] - E:2|TAU:6.499 23.11, train_time: 45.36, VALID_time: 1.201, loss: 4.934e+03, emb_loss:1.225e-06, nce_loss:15.13, best_valid(recall@20): 0.1611
valid 	 N@5: 0.1275, R@5: 0.08296, P@5: 0.1002
valid 	 N@10: 0.1297, R@10: 0.1203, P@10: 0.07365
valid 	 N@15: 0.1373, R@15: 0.1487, P@15: 0.06104
valid 	 N@20: 0.1448, R@20: 0.1727, P@20: 0.05343
valid 	 N@25: 0.1514, R@25: 0.1933, P@25: 0.0479
valid 	 N@30: 0.1571, R@30: 0.2111, P@30: 0.04374
valid 	 N@40: 0.1667, R@40: 0.2417, P@40: 0.03781
valid 	 N@50: 0.1746, R@50: 0.2678, P@50: 0.03368

6.425596769544532
2024-07-03 20:38:19,820 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:39:06,374 - [INFO] - E:3|TAU:6.486 24.9, train_time: 45.37, VALID_time: 1.183, loss: 4.917e+03, emb_loss:1.575e-06, nce_loss:15.13, best_valid(recall@20): 0.1727
valid 	 N@5: 0.1299, R@5: 0.08437, P@5: 0.1027
valid 	 N@10: 0.1321, R@10: 0.123, P@10: 0.07543
valid 	 N@15: 0.1404, R@15: 0.1537, P@15: 0.06299
valid 	 N@20: 0.148, R@20: 0.178, P@20: 0.05498
valid 	 N@25: 0.1546, R@25: 0.1986, P@25: 0.04928
valid 	 N@30: 0.1606, R@30: 0.2175, P@30: 0.04508
valid 	 N@40: 0.1704, R@40: 0.2486, P@40: 0.03897
valid 	 N@50: 0.1783, R@50: 0.2746, P@50: 0.03461

6.425596769544532
2024-07-03 20:39:06,418 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:40:03,374 - [INFO] - E:4|TAU:6.483 21.96, train_time: 55.52, VALID_time: 1.43, loss: 4.883e+03, emb_loss:1.917e-06, nce_loss:15.13, best_valid(recall@20): 0.178
valid 	 N@5: 0.1335, R@5: 0.0869, P@5: 0.1046
valid 	 N@10: 0.1363, R@10: 0.1268, P@10: 0.0772
valid 	 N@15: 0.1446, R@15: 0.1574, P@15: 0.06428
valid 	 N@20: 0.1523, R@20: 0.1823, P@20: 0.056
valid 	 N@25: 0.159, R@25: 0.2033, P@25: 0.05026
valid 	 N@30: 0.1651, R@30: 0.2224, P@30: 0.04594
valid 	 N@40: 0.1751, R@40: 0.2542, P@40: 0.03968
valid 	 N@50: 0.1832, R@50: 0.2808, P@50: 0.03528

6.425596769544532
2024-07-03 20:40:03,417 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:41:46,673 - [INFO] - E:5|TAU:6.498 20.83, train_time: 101.8, VALID_time: 1.446, loss: 4.877e+03, emb_loss:2.261e-06, nce_loss:15.13, best_valid(recall@20): 0.1823
valid 	 N@5: 0.1345, R@5: 0.08788, P@5: 0.1058
valid 	 N@10: 0.1369, R@10: 0.1276, P@10: 0.07768
valid 	 N@15: 0.1451, R@15: 0.158, P@15: 0.06456
valid 	 N@20: 0.1529, R@20: 0.1832, P@20: 0.05634
valid 	 N@25: 0.1599, R@25: 0.2049, P@25: 0.05065
valid 	 N@30: 0.1661, R@30: 0.2242, P@30: 0.04635
valid 	 N@40: 0.1762, R@40: 0.2564, P@40: 0.03999
valid 	 N@50: 0.1845, R@50: 0.2837, P@50: 0.03559

6.425596769544532
2024-07-03 20:41:46,718 - [INFO] - current w_0 is 9.17942388767301
2024-07-03 20:43:29,207 - [INFO] - E:6|TAU:6.499 19.42, train_time: 101.1, VALID_time: 1.419, loss: 4.889e+03, emb_loss:2.613e-06, nce_loss:15.13, best_valid(recall@20): 0.1832
valid 	 N@5: 0.1359, R@5: 0.08848, P@5: 0.1064
valid 	 N@10: 0.1382, R@10: 0.128, P@10: 0.078
valid 	 N@15: 0.1465, R@15: 0.1586, P@15: 0.06498
valid 	 N@20: 0.1543, R@20: 0.1839, P@20: 0.05664
valid 	 N@25: 0.1613, R@25: 0.2057, P@25: 0.05083
valid 	 N@30: 0.1672, R@30: 0.2244, P@30: 0.04641
valid 	 N@40: 0.1777, R@40: 0.258, P@40: 0.04017
valid 	 N@50: 0.1859, R@50: 0.2851, P@50: 0.03569

6.425596769544532
2024-07-03 20:43:29,253 - [INFO] - current w_0 is 9.17942388767301
