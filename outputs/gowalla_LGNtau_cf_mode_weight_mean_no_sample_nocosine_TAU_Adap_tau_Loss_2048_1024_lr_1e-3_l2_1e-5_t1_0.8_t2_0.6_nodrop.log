2024-06-06 20:34:22,698 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_cf_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_06_06_2024_20:34:22', 'train_ratio': 0.8, 'gnn': 'lgntaucf', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-06 20:34:24,978 - [INFO] - load train.txt
2024-06-06 20:34:29,233 - [INFO] - building the adj mat ...
2024-06-06 20:34:29,813 - [INFO] - train set len is 810128
2024-06-06 20:34:29,813 - [INFO] - test set len is 217242
2024-06-06 20:34:29,813 - [INFO] - loading over ...
2024-06-06 20:34:29,813 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-06 20:34:49,887 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-06 20:34:49,888 - [INFO] - start training ...
6.425596769544532
2024-06-06 20:34:49,918 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:35:17,380 - [INFO] - E:0|TAU:9.179 9.179, train_time: 26.25, VALID_time: 1.214, loss: 4.757e+03, emb_loss:3.082e-07, nce_loss:15.05, best_valid(recall@20): -inf
valid 	 N@5: 0.1195, R@5: 0.07866, P@5: 0.0942
valid 	 N@10: 0.1226, R@10: 0.1155, P@10: 0.06951
valid 	 N@15: 0.1299, R@15: 0.1427, P@15: 0.05751
valid 	 N@20: 0.1372, R@20: 0.1658, P@20: 0.05026
valid 	 N@25: 0.1437, R@25: 0.1859, P@25: 0.04523
valid 	 N@30: 0.1494, R@30: 0.2035, P@30: 0.04143
valid 	 N@40: 0.1593, R@40: 0.235, P@40: 0.03602
valid 	 N@50: 0.1672, R@50: 0.2611, P@50: 0.03217

6.425596769544532
2024-06-06 20:35:17,450 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:35:57,366 - [INFO] - E:1|TAU:6.237 24.95, train_time: 38.15, VALID_time: 1.743, loss: 4.695e+03, emb_loss:6.164e-07, nce_loss:15.03, best_valid(recall@20): 0.1658
valid 	 N@5: 0.1219, R@5: 0.07779, P@5: 0.09551
valid 	 N@10: 0.1237, R@10: 0.114, P@10: 0.07044
valid 	 N@15: 0.13, R@15: 0.1395, P@15: 0.05791
valid 	 N@20: 0.1366, R@20: 0.1612, P@20: 0.05049
valid 	 N@25: 0.1424, R@25: 0.1798, P@25: 0.04527
valid 	 N@30: 0.1477, R@30: 0.1965, P@30: 0.04138
valid 	 N@40: 0.1566, R@40: 0.2248, P@40: 0.03574
valid 	 N@50: 0.1639, R@50: 0.2487, P@50: 0.0318

6.425596769544532
2024-06-06 20:35:57,400 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:36:57,942 - [INFO] - E:2|TAU:6.44 21.39, train_time: 58.81, VALID_time: 1.708, loss: 4.502e+03, emb_loss:9.265e-07, nce_loss:15.03, best_valid(recall@20): 0.1658
valid 	 N@5: 0.1269, R@5: 0.08237, P@5: 0.09961
valid 	 N@10: 0.1291, R@10: 0.1195, P@10: 0.07329
valid 	 N@15: 0.1368, R@15: 0.1484, P@15: 0.06094
valid 	 N@20: 0.1439, R@20: 0.1714, P@20: 0.05304
valid 	 N@25: 0.1504, R@25: 0.1918, P@25: 0.0476
valid 	 N@30: 0.1564, R@30: 0.2102, P@30: 0.04366
valid 	 N@40: 0.166, R@40: 0.2412, P@40: 0.03771
valid 	 N@50: 0.1739, R@50: 0.2671, P@50: 0.0336

6.425596769544532
2024-06-06 20:36:58,022 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:37:59,611 - [INFO] - E:3|TAU:6.699 24.95, train_time: 60.36, VALID_time: 1.205, loss: 4.502e+03, emb_loss:1.19e-06, nce_loss:15.03, best_valid(recall@20): 0.1714
valid 	 N@5: 0.1301, R@5: 0.08389, P@5: 0.1025
valid 	 N@10: 0.1326, R@10: 0.1233, P@10: 0.07572
valid 	 N@15: 0.1405, R@15: 0.1531, P@15: 0.06295
valid 	 N@20: 0.1482, R@20: 0.1779, P@20: 0.05499
valid 	 N@25: 0.1545, R@25: 0.1979, P@25: 0.04915
valid 	 N@30: 0.1605, R@30: 0.2168, P@30: 0.04503
valid 	 N@40: 0.1705, R@40: 0.2486, P@40: 0.03891
valid 	 N@50: 0.1782, R@50: 0.2739, P@50: 0.03451

6.425596769544532
2024-06-06 20:37:59,686 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:39:02,677 - [INFO] - E:4|TAU:6.721 22.34, train_time: 61.29, VALID_time: 1.678, loss: 4.455e+03, emb_loss:1.466e-06, nce_loss:15.03, best_valid(recall@20): 0.1779
valid 	 N@5: 0.1337, R@5: 0.08647, P@5: 0.1046
valid 	 N@10: 0.1365, R@10: 0.1268, P@10: 0.07732
valid 	 N@15: 0.1443, R@15: 0.1565, P@15: 0.06412
valid 	 N@20: 0.1518, R@20: 0.1809, P@20: 0.0558
valid 	 N@25: 0.1589, R@25: 0.2029, P@25: 0.05024
valid 	 N@30: 0.1648, R@30: 0.2215, P@30: 0.04586
valid 	 N@40: 0.1748, R@40: 0.2534, P@40: 0.03958
valid 	 N@50: 0.183, R@50: 0.2806, P@50: 0.03524

6.425596769544532
2024-06-06 20:39:02,750 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:40:04,767 - [INFO] - E:5|TAU:6.722 24.22, train_time: 60.26, VALID_time: 1.736, loss: 4.451e+03, emb_loss:1.743e-06, nce_loss:15.02, best_valid(recall@20): 0.1809
valid 	 N@5: 0.1345, R@5: 0.08744, P@5: 0.1056
valid 	 N@10: 0.1371, R@10: 0.1276, P@10: 0.07793
valid 	 N@15: 0.1451, R@15: 0.1576, P@15: 0.0647
valid 	 N@20: 0.153, R@20: 0.1832, P@20: 0.05642
valid 	 N@25: 0.1597, R@25: 0.2044, P@25: 0.05055
valid 	 N@30: 0.1658, R@30: 0.2235, P@30: 0.04619
valid 	 N@40: 0.1759, R@40: 0.2558, P@40: 0.0399
valid 	 N@50: 0.1842, R@50: 0.2833, P@50: 0.03552

6.425596769544532
2024-06-06 20:40:04,861 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:41:07,337 - [INFO] - E:6|TAU:6.729 20.75, train_time: 60.94, VALID_time: 1.512, loss: 4.432e+03, emb_loss:2.04e-06, nce_loss:15.02, best_valid(recall@20): 0.1832
valid 	 N@5: 0.1361, R@5: 0.08829, P@5: 0.1066
valid 	 N@10: 0.1386, R@10: 0.1282, P@10: 0.07846
valid 	 N@15: 0.1466, R@15: 0.1585, P@15: 0.06497
valid 	 N@20: 0.1546, R@20: 0.1844, P@20: 0.05675
valid 	 N@25: 0.1615, R@25: 0.2062, P@25: 0.05097
valid 	 N@30: 0.1675, R@30: 0.2248, P@30: 0.04651
valid 	 N@40: 0.1776, R@40: 0.2573, P@40: 0.04016
valid 	 N@50: 0.186, R@50: 0.2849, P@50: 0.03571

6.425596769544532
2024-06-06 20:41:07,417 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:42:09,817 - [INFO] - E:7|TAU:6.739 21.24, train_time: 60.66, VALID_time: 1.709, loss: 4.43e+03, emb_loss:2.341e-06, nce_loss:15.02, best_valid(recall@20): 0.1844
valid 	 N@5: 0.1365, R@5: 0.08861, P@5: 0.1071
valid 	 N@10: 0.1393, R@10: 0.1299, P@10: 0.07904
valid 	 N@15: 0.1471, R@15: 0.1598, P@15: 0.06534
valid 	 N@20: 0.155, R@20: 0.1853, P@20: 0.05705
valid 	 N@25: 0.1621, R@25: 0.2075, P@25: 0.05127
valid 	 N@30: 0.168, R@30: 0.2261, P@30: 0.04671
valid 	 N@40: 0.1782, R@40: 0.2587, P@40: 0.04037
valid 	 N@50: 0.1866, R@50: 0.2863, P@50: 0.03589

6.425596769544532
2024-06-06 20:42:09,892 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:43:12,194 - [INFO] - E:8|TAU:6.724 20.74, train_time: 60.53, VALID_time: 1.754, loss: 4.42e+03, emb_loss:2.663e-06, nce_loss:15.02, best_valid(recall@20): 0.1853
valid 	 N@5: 0.1376, R@5: 0.08956, P@5: 0.108
valid 	 N@10: 0.14, R@10: 0.1299, P@10: 0.07935
valid 	 N@15: 0.148, R@15: 0.1606, P@15: 0.06571
valid 	 N@20: 0.1559, R@20: 0.1859, P@20: 0.05728
valid 	 N@25: 0.163, R@25: 0.2083, P@25: 0.05148
valid 	 N@30: 0.1689, R@30: 0.2269, P@30: 0.04694
valid 	 N@40: 0.1792, R@40: 0.2595, P@40: 0.04053
valid 	 N@50: 0.1874, R@50: 0.2869, P@50: 0.03602

6.425596769544532
2024-06-06 20:43:12,280 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:44:14,758 - [INFO] - E:9|TAU:6.722 21.09, train_time: 60.73, VALID_time: 1.717, loss: 4.418e+03, emb_loss:2.994e-06, nce_loss:15.02, best_valid(recall@20): 0.1859
valid 	 N@5: 0.1368, R@5: 0.08885, P@5: 0.1073
valid 	 N@10: 0.1398, R@10: 0.1301, P@10: 0.07937
valid 	 N@15: 0.148, R@15: 0.1611, P@15: 0.06582
valid 	 N@20: 0.1559, R@20: 0.1866, P@20: 0.05747
valid 	 N@25: 0.1629, R@25: 0.2086, P@25: 0.05154
valid 	 N@30: 0.169, R@30: 0.2278, P@30: 0.04704
valid 	 N@40: 0.1794, R@40: 0.2609, P@40: 0.04066
valid 	 N@50: 0.1877, R@50: 0.2881, P@50: 0.03613

6.425596769544532
2024-06-06 20:44:14,843 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:45:17,311 - [INFO] - E:10|TAU:6.718 20.91, train_time: 60.9, VALID_time: 1.542, loss: 4.413e+03, emb_loss:3.343e-06, nce_loss:15.02, best_valid(recall@20): 0.1866
valid 	 N@5: 0.1383, R@5: 0.09025, P@5: 0.1084
valid 	 N@10: 0.1409, R@10: 0.131, P@10: 0.07974
valid 	 N@15: 0.149, R@15: 0.1618, P@15: 0.06609
valid 	 N@20: 0.1568, R@20: 0.187, P@20: 0.0576
valid 	 N@25: 0.1637, R@25: 0.2088, P@25: 0.05164
valid 	 N@30: 0.1698, R@30: 0.2276, P@30: 0.04714
valid 	 N@40: 0.1802, R@40: 0.2611, P@40: 0.04077
valid 	 N@50: 0.1884, R@50: 0.2881, P@50: 0.03616

6.425596769544532
2024-06-06 20:45:17,387 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:46:20,806 - [INFO] - E:11|TAU:6.724 20.94, train_time: 61.82, VALID_time: 1.57, loss: 4.411e+03, emb_loss:3.699e-06, nce_loss:15.02, best_valid(recall@20): 0.187
valid 	 N@5: 0.1377, R@5: 0.08953, P@5: 0.108
valid 	 N@10: 0.1408, R@10: 0.1312, P@10: 0.07989
valid 	 N@15: 0.149, R@15: 0.1622, P@15: 0.06618
valid 	 N@20: 0.1567, R@20: 0.1874, P@20: 0.05763
valid 	 N@25: 0.1638, R@25: 0.2095, P@25: 0.05174
valid 	 N@30: 0.1699, R@30: 0.2285, P@30: 0.04728
valid 	 N@40: 0.1801, R@40: 0.2612, P@40: 0.04072
valid 	 N@50: 0.1886, R@50: 0.2892, P@50: 0.03626

6.425596769544532
2024-06-06 20:46:20,880 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:47:16,798 - [INFO] - E:12|TAU:6.73 20.65, train_time: 54.31, VALID_time: 1.586, loss: 4.406e+03, emb_loss:4.073e-06, nce_loss:15.02, best_valid(recall@20): 0.1874
valid 	 N@5: 0.1384, R@5: 0.08986, P@5: 0.1084
valid 	 N@10: 0.141, R@10: 0.1309, P@10: 0.07987
valid 	 N@15: 0.1494, R@15: 0.1623, P@15: 0.06632
valid 	 N@20: 0.1572, R@20: 0.1877, P@20: 0.05777
valid 	 N@25: 0.1643, R@25: 0.2097, P@25: 0.05188
valid 	 N@30: 0.1705, R@30: 0.2292, P@30: 0.04737
valid 	 N@40: 0.1806, R@40: 0.2615, P@40: 0.04081
valid 	 N@50: 0.1888, R@50: 0.2885, P@50: 0.03621

6.425596769544532
2024-06-06 20:47:16,868 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:48:19,404 - [INFO] - E:13|TAU:6.715 20.87, train_time: 60.94, VALID_time: 1.577, loss: 4.405e+03, emb_loss:4.455e-06, nce_loss:15.02, best_valid(recall@20): 0.1877
valid 	 N@5: 0.138, R@5: 0.08991, P@5: 0.1084
valid 	 N@10: 0.1406, R@10: 0.1309, P@10: 0.07988
valid 	 N@15: 0.1488, R@15: 0.162, P@15: 0.0662
valid 	 N@20: 0.1568, R@20: 0.1878, P@20: 0.05782
valid 	 N@25: 0.1638, R@25: 0.2097, P@25: 0.05193
valid 	 N@30: 0.1699, R@30: 0.2289, P@30: 0.04737
valid 	 N@40: 0.1801, R@40: 0.2615, P@40: 0.04078
valid 	 N@50: 0.1886, R@50: 0.2896, P@50: 0.03633

6.425596769544532
2024-06-06 20:48:19,473 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:49:22,020 - [INFO] - E:14|TAU:6.74 20.48, train_time: 61.03, VALID_time: 1.493, loss: 4.401e+03, emb_loss:4.852e-06, nce_loss:15.02, best_valid(recall@20): 0.1878
valid 	 N@5: 0.1388, R@5: 0.09036, P@5: 0.1089
valid 	 N@10: 0.1414, R@10: 0.1316, P@10: 0.08015
valid 	 N@15: 0.1494, R@15: 0.1619, P@15: 0.0663
valid 	 N@20: 0.1575, R@20: 0.188, P@20: 0.05788
valid 	 N@25: 0.1646, R@25: 0.2101, P@25: 0.05198
valid 	 N@30: 0.1707, R@30: 0.2293, P@30: 0.04744
valid 	 N@40: 0.1809, R@40: 0.2618, P@40: 0.04087
valid 	 N@50: 0.1893, R@50: 0.2895, P@50: 0.03635

6.425596769544532
2024-06-06 20:49:22,091 - [INFO] - current w_0 is 9.17942388767301
