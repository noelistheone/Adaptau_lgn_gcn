2024-05-29 13:19:53,556 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_cf_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_29_05_2024_13:19:53', 'train_ratio': 0.8, 'gnn': 'lgntaucf', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-05-29 13:19:55,663 - [INFO] - load train.txt
2024-05-29 13:19:59,876 - [INFO] - building the adj mat ...
2024-05-29 13:20:00,464 - [INFO] - train set len is 810128
2024-05-29 13:20:00,464 - [INFO] - test set len is 217242
2024-05-29 13:20:00,464 - [INFO] - loading over ...
2024-05-29 13:20:00,464 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-05-29 13:20:27,125 - [INFO] - Evaluation Protocols is 1 @ 20
2024-05-29 13:20:27,126 - [INFO] - start training ...
6.425596769544532
2024-05-29 13:20:27,164 - [INFO] - current w_0 is 9.17942388767301
2024-05-29 13:21:51,908 - [INFO] - E:0|TAU:9.179 9.179, train_time: 82.93, VALID_time: 1.812, loss: 9.636e+03, emb_loss:3.022e-07, nce_loss:19.75, best_valid(recall@20): -inf
valid 	 N@5: 0.121, R@5: 0.0785, P@5: 0.09524
valid 	 N@10: 0.1228, R@10: 0.1138, P@10: 0.0698
valid 	 N@15: 0.1301, R@15: 0.1413, P@15: 0.05787
valid 	 N@20: 0.137, R@20: 0.1639, P@20: 0.05046
valid 	 N@25: 0.1434, R@25: 0.1839, P@25: 0.04541
valid 	 N@30: 0.1489, R@30: 0.2013, P@30: 0.04153
valid 	 N@40: 0.1585, R@40: 0.2319, P@40: 0.03602
valid 	 N@50: 0.1662, R@50: 0.2576, P@50: 0.03212

6.425596769544532
2024-05-29 13:21:51,958 - [INFO] - current w_0 is 9.17942388767301
2024-05-29 13:23:17,269 - [INFO] - E:1|TAU:6.133 24.95, train_time: 83.51, VALID_time: 1.794, loss: 9.579e+03, emb_loss:5.985e-07, nce_loss:19.73, best_valid(recall@20): 0.1639
valid 	 N@5: 0.1232, R@5: 0.07894, P@5: 0.09671
valid 	 N@10: 0.1249, R@10: 0.1154, P@10: 0.07109
valid 	 N@15: 0.1321, R@15: 0.1432, P@15: 0.05895
valid 	 N@20: 0.1386, R@20: 0.165, P@20: 0.0512
valid 	 N@25: 0.1446, R@25: 0.184, P@25: 0.04587
valid 	 N@30: 0.1499, R@30: 0.2008, P@30: 0.04185
valid 	 N@40: 0.1588, R@40: 0.2293, P@40: 0.03608
valid 	 N@50: 0.1665, R@50: 0.2547, P@50: 0.03216

6.425596769544532
2024-05-29 13:23:17,339 - [INFO] - current w_0 is 9.17942388767301
2024-05-29 13:24:42,330 - [INFO] - E:2|TAU:6.447 24.11, train_time: 83.04, VALID_time: 1.946, loss: 9.345e+03, emb_loss:9.099e-07, nce_loss:19.7, best_valid(recall@20): 0.165
valid 	 N@5: 0.1297, R@5: 0.08367, P@5: 0.1018
valid 	 N@10: 0.1314, R@10: 0.1213, P@10: 0.07448
valid 	 N@15: 0.1387, R@15: 0.1498, P@15: 0.06165
valid 	 N@20: 0.146, R@20: 0.1736, P@20: 0.05379
valid 	 N@25: 0.1525, R@25: 0.1942, P@25: 0.04828
valid 	 N@30: 0.1584, R@30: 0.2128, P@30: 0.04418
valid 	 N@40: 0.1681, R@40: 0.2437, P@40: 0.03816
valid 	 N@50: 0.1761, R@50: 0.2702, P@50: 0.03402

6.425596769544532
2024-05-29 13:24:42,404 - [INFO] - current w_0 is 9.17942388767301
