2024-04-24 09:01:28,290 - [INFO] - {'dataset': 'iFashion', 'data_path': './data/', 'name': 'iFashion_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-5_l2_1e-5_t1_1.0_t2_0.6_drop_24_04_2024_09:01:28', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 1e-05, 'mess_dropout': True, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-24 09:01:38,215 - [INFO] - load train.txt
2024-04-24 09:01:55,166 - [INFO] - building the adj mat ...
2024-04-24 09:01:56,043 - [INFO] - train set len is 1255447
2024-04-24 09:01:56,043 - [INFO] - test set len is 352366
2024-04-24 09:01:56,043 - [INFO] - loading over ...
2024-04-24 09:01:56,043 - [INFO] - users are 300000 items are 81614
Adap_tau_Loss
start to make tables
2024-04-24 09:02:08,921 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-24 09:02:08,922 - [INFO] - start training ...
8.855723661219901
2024-04-24 09:02:09,014 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:05:10,334 - [INFO] - E:0|TAU:12.65 12.65, train_time: 162.4, VALID_time: 18.95, loss: 3.774e+03, emb_loss:1.268e-08, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.0005397, R@5: 0.0007963, P@5: 0.0002165
valid 	 N@10: 0.0007226, R@10: 0.001346, P@10: 0.0001823
valid 	 N@15: 0.0008515, R@15: 0.001813, P@15: 0.0001614
valid 	 N@20: 0.0009676, R@20: 0.002284, P@20: 0.0001505
valid 	 N@25: 0.001062, R@25: 0.002701, P@25: 0.0001409
valid 	 N@30: 0.001142, R@30: 0.003062, P@30: 0.0001338
valid 	 N@40: 0.001275, R@40: 0.003715, P@40: 0.0001215
valid 	 N@50: 0.001393, R@50: 0.004338, P@50: 0.0001131

8.855723661219901
2024-04-24 09:05:10,666 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:08:32,569 - [INFO] - E:1|TAU:8.555 34.39, train_time: 183.8, VALID_time: 18.11, loss: 3.406e+03, emb_loss:1.481e-08, nce_loss:0.0, best_valid(recall@20): 0.002284
valid 	 N@5: 0.005187, R@5: 0.007367, P@5: 0.001934
valid 	 N@10: 0.006542, R@10: 0.01143, P@10: 0.001506
valid 	 N@15: 0.007346, R@15: 0.0143, P@15: 0.001262
valid 	 N@20: 0.007935, R@20: 0.01664, P@20: 0.001108
valid 	 N@25: 0.008427, R@25: 0.01875, P@25: 0.001001
valid 	 N@30: 0.008843, R@30: 0.02063, P@30: 0.0009213
valid 	 N@40: 0.009512, R@40: 0.02386, P@40: 0.000802
valid 	 N@50: 0.01003, R@50: 0.02652, P@50: 0.000716

8.855723661219901
2024-04-24 09:08:33,145 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:11:47,180 - [INFO] - E:2|TAU:8.73 34.36, train_time: 175.8, VALID_time: 18.22, loss: 2.94e+03, emb_loss:1.785e-08, nce_loss:0.0, best_valid(recall@20): 0.01664
valid 	 N@5: 0.009258, R@5: 0.01333, P@5: 0.003433
valid 	 N@10: 0.01173, R@10: 0.02076, P@10: 0.002667
valid 	 N@15: 0.01326, R@15: 0.02621, P@15: 0.002262
valid 	 N@20: 0.01442, R@20: 0.03084, P@20: 0.00201
valid 	 N@25: 0.01536, R@25: 0.03488, P@25: 0.001828
valid 	 N@30: 0.01616, R@30: 0.03853, P@30: 0.001686
valid 	 N@40: 0.01743, R@40: 0.04469, P@40: 0.001474
valid 	 N@50: 0.01847, R@50: 0.05006, P@50: 0.001325

8.855723661219901
2024-04-24 09:11:47,794 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:15:08,546 - [INFO] - E:3|TAU:8.779 34.37, train_time: 183.8, VALID_time: 16.95, loss: 2.581e+03, emb_loss:2.108e-08, nce_loss:0.0, best_valid(recall@20): 0.03084
valid 	 N@5: 0.01212, R@5: 0.01744, P@5: 0.004442
valid 	 N@10: 0.01529, R@10: 0.02696, P@10: 0.003451
valid 	 N@15: 0.01739, R@15: 0.03448, P@15: 0.002958
valid 	 N@20: 0.01896, R@20: 0.04074, P@20: 0.002635
valid 	 N@25: 0.02024, R@25: 0.04624, P@25: 0.002398
valid 	 N@30: 0.02129, R@30: 0.05105, P@30: 0.002212
valid 	 N@40: 0.02305, R@40: 0.05958, P@40: 0.001944
valid 	 N@50: 0.02442, R@50: 0.0667, P@50: 0.001749

8.855723661219901
2024-04-24 09:15:09,128 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:18:22,158 - [INFO] - E:4|TAU:8.706 34.37, train_time: 176.4, VALID_time: 16.62, loss: 2.301e+03, emb_loss:2.432e-08, nce_loss:0.0, best_valid(recall@20): 0.04074
valid 	 N@5: 0.0144, R@5: 0.0207, P@5: 0.005237
valid 	 N@10: 0.01811, R@10: 0.03183, P@10: 0.004048
valid 	 N@15: 0.02052, R@15: 0.04047, P@15: 0.003451
valid 	 N@20: 0.02236, R@20: 0.04784, P@20: 0.003073
valid 	 N@25: 0.02393, R@25: 0.05462, P@25: 0.002813
valid 	 N@30: 0.02519, R@30: 0.06036, P@30: 0.002601
valid 	 N@40: 0.02729, R@40: 0.07056, P@40: 0.002289
valid 	 N@50: 0.02895, R@50: 0.0792, P@50: 0.002062

8.855723661219901
2024-04-24 09:18:22,733 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:21:43,353 - [INFO] - E:5|TAU:8.621 34.36, train_time: 183.9, VALID_time: 16.76, loss: 2.083e+03, emb_loss:2.748e-08, nce_loss:0.0, best_valid(recall@20): 0.04784
valid 	 N@5: 0.01604, R@5: 0.02285, P@5: 0.005771
valid 	 N@10: 0.02027, R@10: 0.03552, P@10: 0.004502
valid 	 N@15: 0.02302, R@15: 0.04539, P@15: 0.003857
valid 	 N@20: 0.02511, R@20: 0.05375, P@20: 0.003439
valid 	 N@25: 0.02678, R@25: 0.06099, P@25: 0.003134
valid 	 N@30: 0.02817, R@30: 0.06732, P@30: 0.002892
valid 	 N@40: 0.03049, R@40: 0.07861, P@40: 0.002541
valid 	 N@50: 0.03228, R@50: 0.08797, P@50: 0.00228

8.855723661219901
2024-04-24 09:21:43,954 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:25:01,033 - [INFO] - E:6|TAU:8.525 34.39, train_time: 183.5, VALID_time: 13.61, loss: 1.906e+03, emb_loss:3.053e-08, nce_loss:0.0, best_valid(recall@20): 0.05375
valid 	 N@5: 0.01752, R@5: 0.0249, P@5: 0.006262
valid 	 N@10: 0.02209, R@10: 0.03862, P@10: 0.004888
valid 	 N@15: 0.02505, R@15: 0.04926, P@15: 0.004176
valid 	 N@20: 0.02728, R@20: 0.05818, P@20: 0.003713
valid 	 N@25: 0.02904, R@25: 0.06576, P@25: 0.003371
valid 	 N@30: 0.03055, R@30: 0.07265, P@30: 0.003114
valid 	 N@40: 0.03303, R@40: 0.08478, P@40: 0.002733
valid 	 N@50: 0.03496, R@50: 0.09481, P@50: 0.002452

8.855723661219901
2024-04-24 09:25:01,540 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:28:22,276 - [INFO] - E:7|TAU:8.463 34.36, train_time: 183.8, VALID_time: 16.96, loss: 1.763e+03, emb_loss:3.344e-08, nce_loss:0.0, best_valid(recall@20): 0.05818
valid 	 N@5: 0.01866, R@5: 0.02655, P@5: 0.00667
valid 	 N@10: 0.02349, R@10: 0.041, P@10: 0.005184
valid 	 N@15: 0.02663, R@15: 0.05226, P@15: 0.004429
valid 	 N@20: 0.02897, R@20: 0.06164, P@20: 0.003935
valid 	 N@25: 0.03085, R@25: 0.06976, P@25: 0.003573
valid 	 N@30: 0.0324, R@30: 0.07688, P@30: 0.003288
valid 	 N@40: 0.03501, R@40: 0.08959, P@40: 0.002882
valid 	 N@50: 0.03702, R@50: 0.1, P@50: 0.002587

8.855723661219901
2024-04-24 09:28:22,871 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:31:44,616 - [INFO] - E:8|TAU:8.392 34.36, train_time: 183.8, VALID_time: 17.98, loss: 1.645e+03, emb_loss:3.623e-08, nce_loss:0.0, best_valid(recall@20): 0.06164
valid 	 N@5: 0.01956, R@5: 0.02771, P@5: 0.006956
valid 	 N@10: 0.02472, R@10: 0.04312, P@10: 0.005443
valid 	 N@15: 0.02795, R@15: 0.05472, P@15: 0.004636
valid 	 N@20: 0.03042, R@20: 0.06461, P@20: 0.004121
valid 	 N@25: 0.03237, R@25: 0.07306, P@25: 0.003735
valid 	 N@30: 0.03398, R@30: 0.08041, P@30: 0.003436
valid 	 N@40: 0.03661, R@40: 0.09327, P@40: 0.002999
valid 	 N@50: 0.03878, R@50: 0.1045, P@50: 0.002703

8.855723661219901
2024-04-24 09:31:45,191 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:34:58,956 - [INFO] - E:9|TAU:8.353 34.35, train_time: 176.5, VALID_time: 17.29, loss: 1.548e+03, emb_loss:3.881e-08, nce_loss:0.0, best_valid(recall@20): 0.06461
valid 	 N@5: 0.02043, R@5: 0.0288, P@5: 0.007228
valid 	 N@10: 0.02578, R@10: 0.04479, P@10: 0.005652
valid 	 N@15: 0.02914, R@15: 0.05686, P@15: 0.004814
valid 	 N@20: 0.03169, R@20: 0.06706, P@20: 0.004272
valid 	 N@25: 0.03368, R@25: 0.07567, P@25: 0.003868
valid 	 N@30: 0.03534, R@30: 0.08328, P@30: 0.003553
valid 	 N@40: 0.03809, R@40: 0.09666, P@40: 0.00311
valid 	 N@50: 0.04023, R@50: 0.1078, P@50: 0.002785

8.855723661219901
2024-04-24 09:34:59,540 - [INFO] - current w_0 is 12.651033554078595
2024-04-24 09:38:19,950 - [INFO] - E:10|TAU:8.297 34.39, train_time: 183.7, VALID_time: 16.68, loss: 1.466e+03, emb_loss:4.126e-08, nce_loss:0.0, best_valid(recall@20): 0.06706
valid 	 N@5: 0.02116, R@5: 0.02981, P@5: 0.007476
valid 	 N@10: 0.02669, R@10: 0.04635, P@10: 0.005847
valid 	 N@15: 0.0301, R@15: 0.05856, P@15: 0.004958
valid 	 N@20: 0.03273, R@20: 0.0691, P@20: 0.004402
valid 	 N@25: 0.03471, R@25: 0.07766, P@25: 0.003968
valid 	 N@30: 0.03644, R@30: 0.0856, P@30: 0.003655
valid 	 N@40: 0.03921, R@40: 0.09906, P@40: 0.003187
valid 	 N@50: 0.04149, R@50: 0.111, P@50: 0.002866

8.855723661219901
2024-04-24 09:38:20,527 - [INFO] - current w_0 is 12.651033554078595
