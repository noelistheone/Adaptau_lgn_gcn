2024-04-28 12:40:20,880 - [INFO] - {'dataset': 'douban-book', 'data_path': './data/', 'name': 'douban-book_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-4_l2_1e-1_t1_1.0_t2_1.0_nodrop_28_04_2024_12:40:20', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 0.1, 'lr': 0.0001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 1.0, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-28 12:40:24,630 - [INFO] - load train.txt
2024-04-28 12:40:27,307 - [INFO] - building the adj mat ...
2024-04-28 12:40:27,613 - [INFO] - train set len is 478730
2024-04-28 12:40:27,613 - [INFO] - test set len is 119690
2024-04-28 12:40:27,613 - [INFO] - loading over ...
2024-04-28 12:40:27,613 - [INFO] - users are 13024 items are 22347
Adap_tau_Loss
start to make tables
2024-04-28 12:40:38,195 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-28 12:40:38,195 - [INFO] - start training ...
5.469515143410623
2024-04-28 12:40:38,233 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:40:47,246 - [INFO] - E:0|TAU:7.814 7.814, train_time: 8.518, VALID_time: 0.4938, loss: 1.766e+03, emb_loss:0.0008423, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.0176, R@5: 0.008375, P@5: 0.01577
valid 	 N@10: 0.01747, R@10: 0.01426, P@10: 0.01307
valid 	 N@15: 0.01798, R@15: 0.01858, P@15: 0.01141
valid 	 N@20: 0.01876, R@20: 0.0222, P@20: 0.01036
valid 	 N@25: 0.01972, R@25: 0.02578, P@25: 0.009586
valid 	 N@30: 0.02057, R@30: 0.02869, P@30: 0.008929
valid 	 N@40: 0.02232, R@40: 0.03419, P@40: 0.008052
valid 	 N@50: 0.02355, R@50: 0.03784, P@50: 0.007274

5.469515143410623
2024-04-28 12:40:47,296 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:40:56,289 - [INFO] - E:1|TAU:5.866 13.32, train_time: 8.521, VALID_time: 0.4706, loss: 1.545e+03, emb_loss:0.0009908, nce_loss:0.0, best_valid(recall@20): 0.0222
valid 	 N@5: 0.06725, R@5: 0.03359, P@5: 0.05821
valid 	 N@10: 0.0663, R@10: 0.05491, P@10: 0.04772
valid 	 N@15: 0.06841, R@15: 0.07096, P@15: 0.04184
valid 	 N@20: 0.07147, R@20: 0.08494, P@20: 0.03782
valid 	 N@25: 0.07478, R@25: 0.09704, P@25: 0.03499
valid 	 N@30: 0.07773, R@30: 0.1073, P@30: 0.03246
valid 	 N@40: 0.08325, R@40: 0.1252, P@40: 0.02872
valid 	 N@50: 0.08772, R@50: 0.1392, P@50: 0.02593

5.469515143410623
2024-04-28 12:40:56,354 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:05,343 - [INFO] - E:2|TAU:5.811 12.81, train_time: 8.522, VALID_time: 0.4662, loss: 1.442e+03, emb_loss:0.00118, nce_loss:0.0, best_valid(recall@20): 0.08494
valid 	 N@5: 0.08335, R@5: 0.04338, P@5: 0.07105
valid 	 N@10: 0.08342, R@10: 0.07033, P@10: 0.0589
valid 	 N@15: 0.08629, R@15: 0.09022, P@15: 0.05161
valid 	 N@20: 0.08993, R@20: 0.1067, P@20: 0.04654
valid 	 N@25: 0.09388, R@25: 0.1214, P@25: 0.04289
valid 	 N@30: 0.09754, R@30: 0.1338, P@30: 0.03986
valid 	 N@40: 0.1048, R@40: 0.1577, P@40: 0.03553
valid 	 N@50: 0.1105, R@50: 0.1762, P@50: 0.03201

5.469515143410623
2024-04-28 12:41:05,412 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:14,583 - [INFO] - E:3|TAU:5.74 13.08, train_time: 8.673, VALID_time: 0.4963, loss: 1.381e+03, emb_loss:0.001343, nce_loss:0.0, best_valid(recall@20): 0.1067
valid 	 N@5: 0.09404, R@5: 0.05104, P@5: 0.07993
valid 	 N@10: 0.09345, R@10: 0.07875, P@10: 0.0654
valid 	 N@15: 0.09656, R@15: 0.1007, P@15: 0.05698
valid 	 N@20: 0.1005, R@20: 0.1185, P@20: 0.05125
valid 	 N@25: 0.105, R@25: 0.1358, P@25: 0.04712
valid 	 N@30: 0.1094, R@30: 0.1507, P@30: 0.04405
valid 	 N@40: 0.1171, R@40: 0.1759, P@40: 0.0391
valid 	 N@50: 0.1236, R@50: 0.1971, P@50: 0.03537

5.469515143410623
2024-04-28 12:41:14,656 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:23,669 - [INFO] - E:4|TAU:5.701 12.75, train_time: 8.536, VALID_time: 0.4754, loss: 1.339e+03, emb_loss:0.001481, nce_loss:0.0, best_valid(recall@20): 0.1185
valid 	 N@5: 0.1016, R@5: 0.05577, P@5: 0.08603
valid 	 N@10: 0.101, R@10: 0.08559, P@10: 0.07025
valid 	 N@15: 0.1043, R@15: 0.1091, P@15: 0.06109
valid 	 N@20: 0.1084, R@20: 0.1282, P@20: 0.05464
valid 	 N@25: 0.1132, R@25: 0.1462, P@25: 0.05036
valid 	 N@30: 0.118, R@30: 0.1628, P@30: 0.04705
valid 	 N@40: 0.1258, R@40: 0.1882, P@40: 0.04157
valid 	 N@50: 0.1325, R@50: 0.2092, P@50: 0.0376

5.469515143410623
2024-04-28 12:41:23,744 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:32,953 - [INFO] - E:5|TAU:5.664 12.36, train_time: 8.73, VALID_time: 0.4779, loss: 1.308e+03, emb_loss:0.001596, nce_loss:0.0, best_valid(recall@20): 0.1282
valid 	 N@5: 0.1068, R@5: 0.05878, P@5: 0.09004
valid 	 N@10: 0.1066, R@10: 0.09029, P@10: 0.07364
valid 	 N@15: 0.1102, R@15: 0.1153, P@15: 0.06404
valid 	 N@20: 0.115, R@20: 0.1368, P@20: 0.05759
valid 	 N@25: 0.1199, R@25: 0.1552, P@25: 0.053
valid 	 N@30: 0.1246, R@30: 0.1709, P@30: 0.04931
valid 	 N@40: 0.1325, R@40: 0.1967, P@40: 0.04346
valid 	 N@50: 0.139, R@50: 0.2175, P@50: 0.03913

5.469515143410623
2024-04-28 12:41:33,026 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:42,294 - [INFO] - E:6|TAU:5.626 12.16, train_time: 8.784, VALID_time: 0.4825, loss: 1.285e+03, emb_loss:0.001691, nce_loss:0.0, best_valid(recall@20): 0.1368
valid 	 N@5: 0.112, R@5: 0.06203, P@5: 0.09423
valid 	 N@10: 0.1115, R@10: 0.09488, P@10: 0.07658
valid 	 N@15: 0.1154, R@15: 0.121, P@15: 0.06662
valid 	 N@20: 0.1201, R@20: 0.1422, P@20: 0.05984
valid 	 N@25: 0.1247, R@25: 0.1598, P@25: 0.05478
valid 	 N@30: 0.1295, R@30: 0.1762, P@30: 0.05098
valid 	 N@40: 0.1379, R@40: 0.2036, P@40: 0.04501
valid 	 N@50: 0.1446, R@50: 0.2247, P@50: 0.04051

5.469515143410623
2024-04-28 12:41:42,366 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:41:51,602 - [INFO] - E:7|TAU:5.58 12.07, train_time: 8.762, VALID_time: 0.4727, loss: 1.268e+03, emb_loss:0.00177, nce_loss:0.0, best_valid(recall@20): 0.1422
valid 	 N@5: 0.1158, R@5: 0.06427, P@5: 0.09735
valid 	 N@10: 0.1154, R@10: 0.0987, P@10: 0.07896
valid 	 N@15: 0.1192, R@15: 0.1247, P@15: 0.06858
valid 	 N@20: 0.1239, R@20: 0.1456, P@20: 0.0617
valid 	 N@25: 0.1291, R@25: 0.1653, P@25: 0.05663
valid 	 N@30: 0.1335, R@30: 0.1805, P@30: 0.0524
valid 	 N@40: 0.1421, R@40: 0.2088, P@40: 0.04627
valid 	 N@50: 0.1492, R@50: 0.2318, P@50: 0.04162

5.469515143410623
2024-04-28 12:41:51,674 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:00,933 - [INFO] - E:8|TAU:5.545 11.97, train_time: 8.79, VALID_time: 0.4676, loss: 1.254e+03, emb_loss:0.001836, nce_loss:0.0, best_valid(recall@20): 0.1456
valid 	 N@5: 0.1198, R@5: 0.06692, P@5: 0.1003
valid 	 N@10: 0.1193, R@10: 0.1019, P@10: 0.08123
valid 	 N@15: 0.1228, R@15: 0.1278, P@15: 0.07029
valid 	 N@20: 0.1278, R@20: 0.1501, P@20: 0.06328
valid 	 N@25: 0.1327, R@25: 0.1686, P@25: 0.05787
valid 	 N@30: 0.1374, R@30: 0.1846, P@30: 0.05366
valid 	 N@40: 0.1461, R@40: 0.2135, P@40: 0.04734
valid 	 N@50: 0.1532, R@50: 0.2362, P@50: 0.04252

5.469515143410623
2024-04-28 12:42:01,002 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:10,290 - [INFO] - E:9|TAU:5.52 11.8, train_time: 8.785, VALID_time: 0.5011, loss: 1.243e+03, emb_loss:0.001893, nce_loss:0.0, best_valid(recall@20): 0.1501
valid 	 N@5: 0.123, R@5: 0.06902, P@5: 0.1028
valid 	 N@10: 0.1223, R@10: 0.1043, P@10: 0.08305
valid 	 N@15: 0.1261, R@15: 0.1316, P@15: 0.07198
valid 	 N@20: 0.1311, R@20: 0.1538, P@20: 0.06465
valid 	 N@25: 0.1359, R@25: 0.1722, P@25: 0.0591
valid 	 N@30: 0.1405, R@30: 0.1877, P@30: 0.05478
valid 	 N@40: 0.1494, R@40: 0.2172, P@40: 0.04824
valid 	 N@50: 0.1564, R@50: 0.2402, P@50: 0.0432

5.469515143410623
2024-04-28 12:42:10,363 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:19,605 - [INFO] - E:10|TAU:5.497 11.62, train_time: 8.763, VALID_time: 0.4779, loss: 1.234e+03, emb_loss:0.001942, nce_loss:0.0, best_valid(recall@20): 0.1538
valid 	 N@5: 0.1256, R@5: 0.07017, P@5: 0.1049
valid 	 N@10: 0.1254, R@10: 0.1076, P@10: 0.08504
valid 	 N@15: 0.1289, R@15: 0.1344, P@15: 0.07342
valid 	 N@20: 0.1337, R@20: 0.1562, P@20: 0.06578
valid 	 N@25: 0.1385, R@25: 0.1745, P@25: 0.06002
valid 	 N@30: 0.1434, R@30: 0.1913, P@30: 0.0557
valid 	 N@40: 0.1521, R@40: 0.2202, P@40: 0.04895
valid 	 N@50: 0.1593, R@50: 0.2436, P@50: 0.04381

5.469515143410623
2024-04-28 12:42:19,675 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:28,988 - [INFO] - E:11|TAU:5.475 11.67, train_time: 8.827, VALID_time: 0.4849, loss: 1.226e+03, emb_loss:0.001985, nce_loss:0.0, best_valid(recall@20): 0.1562
valid 	 N@5: 0.1284, R@5: 0.07218, P@5: 0.1073
valid 	 N@10: 0.1274, R@10: 0.109, P@10: 0.08616
valid 	 N@15: 0.1311, R@15: 0.1362, P@15: 0.07445
valid 	 N@20: 0.136, R@20: 0.1583, P@20: 0.06681
valid 	 N@25: 0.1409, R@25: 0.1773, P@25: 0.06084
valid 	 N@30: 0.1458, R@30: 0.1941, P@30: 0.05648
valid 	 N@40: 0.1544, R@40: 0.2225, P@40: 0.04948
valid 	 N@50: 0.1617, R@50: 0.2462, P@50: 0.04434

5.469515143410623
2024-04-28 12:42:29,058 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:38,321 - [INFO] - E:12|TAU:5.456 11.48, train_time: 8.776, VALID_time: 0.4855, loss: 1.22e+03, emb_loss:0.002024, nce_loss:0.0, best_valid(recall@20): 0.1583
valid 	 N@5: 0.1309, R@5: 0.07354, P@5: 0.1091
valid 	 N@10: 0.1298, R@10: 0.1107, P@10: 0.08762
valid 	 N@15: 0.1333, R@15: 0.1379, P@15: 0.07542
valid 	 N@20: 0.1384, R@20: 0.1607, P@20: 0.06773
valid 	 N@25: 0.1432, R@25: 0.1795, P@25: 0.0617
valid 	 N@30: 0.1485, R@30: 0.1976, P@30: 0.05732
valid 	 N@40: 0.1566, R@40: 0.2246, P@40: 0.04999
valid 	 N@50: 0.164, R@50: 0.2487, P@50: 0.0448

5.469515143410623
2024-04-28 12:42:38,395 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:47,645 - [INFO] - E:13|TAU:5.443 11.53, train_time: 8.76, VALID_time: 0.488, loss: 1.215e+03, emb_loss:0.002059, nce_loss:0.0, best_valid(recall@20): 0.1607
valid 	 N@5: 0.1329, R@5: 0.07492, P@5: 0.1105
valid 	 N@10: 0.1317, R@10: 0.1121, P@10: 0.08876
valid 	 N@15: 0.1352, R@15: 0.1398, P@15: 0.07643
valid 	 N@20: 0.1401, R@20: 0.1621, P@20: 0.06842
valid 	 N@25: 0.1452, R@25: 0.182, P@25: 0.06239
valid 	 N@30: 0.1502, R@30: 0.1993, P@30: 0.05775
valid 	 N@40: 0.1586, R@40: 0.2267, P@40: 0.05052
valid 	 N@50: 0.166, R@50: 0.251, P@50: 0.04523

5.469515143410623
2024-04-28 12:42:47,716 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:42:56,716 - [INFO] - E:14|TAU:5.431 11.7, train_time: 8.627, VALID_time: 0.3714, loss: 1.211e+03, emb_loss:0.002094, nce_loss:0.0, best_valid(recall@20): 0.1621
valid 	 N@5: 0.1349, R@5: 0.07615, P@5: 0.1119
valid 	 N@10: 0.1336, R@10: 0.1136, P@10: 0.08992
valid 	 N@15: 0.137, R@15: 0.1412, P@15: 0.07733
valid 	 N@20: 0.1419, R@20: 0.1638, P@20: 0.06916
valid 	 N@25: 0.1472, R@25: 0.1841, P@25: 0.06321
valid 	 N@30: 0.152, R@30: 0.2008, P@30: 0.05823
valid 	 N@40: 0.1606, R@40: 0.2294, P@40: 0.05099
valid 	 N@50: 0.1679, R@50: 0.2532, P@50: 0.04558

5.469515143410623
2024-04-28 12:42:56,777 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:43:05,504 - [INFO] - E:15|TAU:5.423 11.7, train_time: 8.362, VALID_time: 0.3639, loss: 1.207e+03, emb_loss:0.002124, nce_loss:0.0, best_valid(recall@20): 0.1638
valid 	 N@5: 0.1362, R@5: 0.07709, P@5: 0.1132
valid 	 N@10: 0.1348, R@10: 0.1147, P@10: 0.09064
valid 	 N@15: 0.1385, R@15: 0.1429, P@15: 0.07818
valid 	 N@20: 0.1432, R@20: 0.1652, P@20: 0.06975
valid 	 N@25: 0.1486, R@25: 0.1856, P@25: 0.06366
valid 	 N@30: 0.1532, R@30: 0.2019, P@30: 0.05868
valid 	 N@40: 0.1619, R@40: 0.2309, P@40: 0.0513
valid 	 N@50: 0.1691, R@50: 0.2542, P@50: 0.04583

5.469515143410623
2024-04-28 12:43:05,562 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:43:14,293 - [INFO] - E:16|TAU:5.418 11.7, train_time: 8.374, VALID_time: 0.3571, loss: 1.204e+03, emb_loss:0.002156, nce_loss:0.0, best_valid(recall@20): 0.1652
valid 	 N@5: 0.1377, R@5: 0.07844, P@5: 0.1144
valid 	 N@10: 0.1359, R@10: 0.1156, P@10: 0.0913
valid 	 N@15: 0.1398, R@15: 0.1443, P@15: 0.07884
valid 	 N@20: 0.1446, R@20: 0.1668, P@20: 0.07033
valid 	 N@25: 0.1498, R@25: 0.1869, P@25: 0.06409
valid 	 N@30: 0.1545, R@30: 0.2035, P@30: 0.05907
valid 	 N@40: 0.1632, R@40: 0.2322, P@40: 0.0516
valid 	 N@50: 0.1704, R@50: 0.2553, P@50: 0.04613

5.469515143410623
2024-04-28 12:43:14,356 - [INFO] - current w_0 is 7.81359310586538
2024-04-28 12:43:23,093 - [INFO] - E:17|TAU:5.412 11.72, train_time: 8.374, VALID_time: 0.3615, loss: 1.202e+03, emb_loss:0.002185, nce_loss:0.0, best_valid(recall@20): 0.1668
valid 	 N@5: 0.1393, R@5: 0.07931, P@5: 0.1154
valid 	 N@10: 0.1372, R@10: 0.1163, P@10: 0.09181
valid 	 N@15: 0.1413, R@15: 0.1456, P@15: 0.07941
valid 	 N@20: 0.146, R@20: 0.168, P@20: 0.0709
valid 	 N@25: 0.1511, R@25: 0.1877, P@25: 0.06451
valid 	 N@30: 0.1559, R@30: 0.2046, P@30: 0.05946
valid 	 N@40: 0.1647, R@40: 0.2339, P@40: 0.05192
valid 	 N@50: 0.1715, R@50: 0.2555, P@50: 0.04627

5.469515143410623
2024-04-28 12:43:23,134 - [INFO] - current w_0 is 7.81359310586538
