2024-05-16 20:37:19,994 - [INFO] - {'dataset': 'yelp2018', 'data_path': './data/', 'name': 'yelp2018_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-1_t1_1.0_t2_1.5_drop_16_05_2024_20:37:19', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 0.1, 'lr': 0.001, 'mess_dropout': True, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 1.5, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-05-16 20:37:26,952 - [INFO] - load train.txt
2024-05-16 20:37:33,778 - [INFO] - building the adj mat ...
2024-05-16 20:37:36,724 - [INFO] - train set len is 1237259
2024-05-16 20:37:36,724 - [INFO] - test set len is 324147
2024-05-16 20:37:36,724 - [INFO] - loading over ...
2024-05-16 20:37:36,724 - [INFO] - users are 31668 items are 38048
Adap_tau_Loss
start to make tables
2024-05-16 20:37:53,647 - [INFO] - Evaluation Protocols is 1 @ 20
2024-05-16 20:37:53,648 - [INFO] - start training ...
6.033980853340449
2024-05-16 20:37:53,703 - [INFO] - current w_0 is 8.619972513557173
2024-05-16 20:39:34,860 - [INFO] - E:0|TAU:8.62 8.62, train_time: 99.6, VALID_time: 1.558, loss: 3.18e+03, emb_loss:0.0034, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.03994, R@5: 0.02106, P@5: 0.03791
valid 	 N@10: 0.04286, R@10: 0.03732, P@10: 0.03385
valid 	 N@15: 0.04768, R@15: 0.0513, P@15: 0.03111
valid 	 N@20: 0.0523, R@20: 0.06358, P@20: 0.02894
valid 	 N@25: 0.05665, R@25: 0.07488, P@25: 0.02734
valid 	 N@30: 0.06083, R@30: 0.08576, P@30: 0.02617
valid 	 N@40: 0.06802, R@40: 0.1052, P@40: 0.02416
valid 	 N@50: 0.07431, R@50: 0.1229, P@50: 0.02263

6.033980853340449
2024-05-16 20:39:34,923 - [INFO] - current w_0 is 8.619972513557173
2024-05-16 20:41:19,433 - [INFO] - E:1|TAU:7.155 13.01, train_time: 102.9, VALID_time: 1.635, loss: 2.962e+03, emb_loss:0.007008, nce_loss:0.0, best_valid(recall@20): 0.06358
valid 	 N@5: 0.04286, R@5: 0.02264, P@5: 0.04036
valid 	 N@10: 0.04549, R@10: 0.0394, P@10: 0.03544
valid 	 N@15: 0.05045, R@15: 0.05378, P@15: 0.03248
valid 	 N@20: 0.05546, R@20: 0.06691, P@20: 0.03044
valid 	 N@25: 0.06013, R@25: 0.0791, P@25: 0.0288
valid 	 N@30: 0.06444, R@30: 0.09041, P@30: 0.02749
valid 	 N@40: 0.07197, R@40: 0.1108, P@40: 0.02533
valid 	 N@50: 0.07858, R@50: 0.1294, P@50: 0.02372

6.033980853340449
2024-05-16 20:41:19,522 - [INFO] - current w_0 is 8.619972513557173
