2024-05-28 15:30:07,181 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_28_05_2024_15:30:07', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-05-28 15:30:09,356 - [INFO] - load train.txt
2024-05-28 15:30:13,869 - [INFO] - building the adj mat ...
2024-05-28 15:30:14,437 - [INFO] - train set len is 810128
2024-05-28 15:30:14,438 - [INFO] - test set len is 217242
2024-05-28 15:30:14,438 - [INFO] - loading over ...
2024-05-28 15:30:14,438 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-05-28 15:30:27,926 - [INFO] - Evaluation Protocols is 1 @ 20
2024-05-28 15:30:27,927 - [INFO] - start training ...
6.425596769544532
2024-05-28 15:30:27,962 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:31:25,330 - [INFO] - E:0|TAU:9.179 9.179, train_time: 56.08, VALID_time: 1.282, loss: 1.812e+03, emb_loss:2.86e-07, nce_loss:0.002786, best_valid(recall@20): -inf
valid 	 N@5: 0.1217, R@5: 0.07885, P@5: 0.09563
valid 	 N@10: 0.1235, R@10: 0.1143, P@10: 0.07003
valid 	 N@15: 0.1309, R@15: 0.1421, P@15: 0.0581
valid 	 N@20: 0.1383, R@20: 0.1656, P@20: 0.05097
valid 	 N@25: 0.1449, R@25: 0.1863, P@25: 0.04595
valid 	 N@30: 0.1508, R@30: 0.2047, P@30: 0.04211
valid 	 N@40: 0.1606, R@40: 0.2364, P@40: 0.03656
valid 	 N@50: 0.1684, R@50: 0.262, P@50: 0.03259

6.425596769544532
2024-05-28 15:31:25,383 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:32:22,397 - [INFO] - E:1|TAU:6.228 24.95, train_time: 55.73, VALID_time: 1.287, loss: 1.735e+03, emb_loss:5.76e-07, nce_loss:0.0002058, best_valid(recall@20): 0.1656
valid 	 N@5: 0.1232, R@5: 0.07845, P@5: 0.09671
valid 	 N@10: 0.1243, R@10: 0.114, P@10: 0.07089
valid 	 N@15: 0.1313, R@15: 0.1415, P@15: 0.05882
valid 	 N@20: 0.1382, R@20: 0.164, P@20: 0.05129
valid 	 N@25: 0.1441, R@25: 0.1828, P@25: 0.04594
valid 	 N@30: 0.1494, R@30: 0.1997, P@30: 0.04185
valid 	 N@40: 0.1581, R@40: 0.2277, P@40: 0.03601
valid 	 N@50: 0.1655, R@50: 0.252, P@50: 0.03204

6.425596769544532
2024-05-28 15:32:22,427 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:33:19,997 - [INFO] - E:2|TAU:6.529 23.71, train_time: 56.32, VALID_time: 1.244, loss: 1.53e+03, emb_loss:8.695e-07, nce_loss:0.0002211, best_valid(recall@20): 0.1656
valid 	 N@5: 0.13, R@5: 0.0836, P@5: 0.1022
valid 	 N@10: 0.1314, R@10: 0.1208, P@10: 0.07454
valid 	 N@15: 0.1391, R@15: 0.1503, P@15: 0.06209
valid 	 N@20: 0.1466, R@20: 0.1744, P@20: 0.05426
valid 	 N@25: 0.1532, R@25: 0.1954, P@25: 0.04874
valid 	 N@30: 0.1591, R@30: 0.2139, P@30: 0.04457
valid 	 N@40: 0.1689, R@40: 0.245, P@40: 0.03848
valid 	 N@50: 0.1768, R@50: 0.2715, P@50: 0.03424

6.425596769544532
2024-05-28 15:33:20,061 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:34:17,599 - [INFO] - E:3|TAU:6.511 24.89, train_time: 56.24, VALID_time: 1.292, loss: 1.507e+03, emb_loss:1.12e-06, nce_loss:0.0002316, best_valid(recall@20): 0.1744
valid 	 N@5: 0.1319, R@5: 0.08497, P@5: 0.1037
valid 	 N@10: 0.1337, R@10: 0.1238, P@10: 0.07618
valid 	 N@15: 0.1417, R@15: 0.1538, P@15: 0.0633
valid 	 N@20: 0.1495, R@20: 0.1793, P@20: 0.05538
valid 	 N@25: 0.1565, R@25: 0.2011, P@25: 0.04986
valid 	 N@30: 0.1624, R@30: 0.2196, P@30: 0.04548
valid 	 N@40: 0.1723, R@40: 0.2515, P@40: 0.03929
valid 	 N@50: 0.1803, R@50: 0.2774, P@50: 0.03492

6.425596769544532
2024-05-28 15:34:17,672 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:35:15,474 - [INFO] - E:4|TAU:6.5 22.13, train_time: 56.56, VALID_time: 1.24, loss: 1.484e+03, emb_loss:1.375e-06, nce_loss:0.0002418, best_valid(recall@20): 0.1793
valid 	 N@5: 0.1349, R@5: 0.087, P@5: 0.1056
valid 	 N@10: 0.137, R@10: 0.1266, P@10: 0.07766
valid 	 N@15: 0.145, R@15: 0.157, P@15: 0.06442
valid 	 N@20: 0.1528, R@20: 0.1824, P@20: 0.05628
valid 	 N@25: 0.1595, R@25: 0.2036, P@25: 0.05039
valid 	 N@30: 0.1655, R@30: 0.2224, P@30: 0.04603
valid 	 N@40: 0.1756, R@40: 0.2546, P@40: 0.03975
valid 	 N@50: 0.1838, R@50: 0.2818, P@50: 0.03533

6.425596769544532
2024-05-28 15:35:15,544 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:36:12,592 - [INFO] - E:5|TAU:6.515 20.56, train_time: 55.8, VALID_time: 1.248, loss: 1.471e+03, emb_loss:1.641e-06, nce_loss:0.0002519, best_valid(recall@20): 0.1824
valid 	 N@5: 0.1355, R@5: 0.08757, P@5: 0.1065
valid 	 N@10: 0.1373, R@10: 0.1272, P@10: 0.0778
valid 	 N@15: 0.1452, R@15: 0.1571, P@15: 0.06451
valid 	 N@20: 0.1533, R@20: 0.1831, P@20: 0.05656
valid 	 N@25: 0.1601, R@25: 0.2048, P@25: 0.05073
valid 	 N@30: 0.1663, R@30: 0.2242, P@30: 0.04636
valid 	 N@40: 0.1765, R@40: 0.2569, P@40: 0.04003
valid 	 N@50: 0.1847, R@50: 0.2841, P@50: 0.03558

6.425596769544532
2024-05-28 15:36:12,654 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:37:10,680 - [INFO] - E:6|TAU:6.513 19.46, train_time: 56.72, VALID_time: 1.304, loss: 1.46e+03, emb_loss:1.923e-06, nce_loss:0.000262, best_valid(recall@20): 0.1831
valid 	 N@5: 0.1359, R@5: 0.08809, P@5: 0.1066
valid 	 N@10: 0.1379, R@10: 0.1276, P@10: 0.07815
valid 	 N@15: 0.1458, R@15: 0.1578, P@15: 0.06472
valid 	 N@20: 0.1537, R@20: 0.1834, P@20: 0.05661
valid 	 N@25: 0.1607, R@25: 0.2055, P@25: 0.05084
valid 	 N@30: 0.1667, R@30: 0.2244, P@30: 0.04639
valid 	 N@40: 0.177, R@40: 0.2573, P@40: 0.0401
valid 	 N@50: 0.1851, R@50: 0.2841, P@50: 0.03562

6.425596769544532
2024-05-28 15:37:10,756 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:38:08,144 - [INFO] - E:7|TAU:6.527 19.61, train_time: 56.15, VALID_time: 1.238, loss: 1.455e+03, emb_loss:2.217e-06, nce_loss:0.0002721, best_valid(recall@20): 0.1834
valid 	 N@5: 0.1365, R@5: 0.08835, P@5: 0.1071
valid 	 N@10: 0.1385, R@10: 0.1283, P@10: 0.07848
valid 	 N@15: 0.1466, R@15: 0.1588, P@15: 0.06515
valid 	 N@20: 0.1543, R@20: 0.1839, P@20: 0.05683
valid 	 N@25: 0.1615, R@25: 0.2067, P@25: 0.05106
valid 	 N@30: 0.1675, R@30: 0.2256, P@30: 0.04668
valid 	 N@40: 0.1779, R@40: 0.2589, P@40: 0.04037
valid 	 N@50: 0.1861, R@50: 0.2857, P@50: 0.03582

6.425596769544532
2024-05-28 15:38:08,217 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:39:06,038 - [INFO] - E:8|TAU:6.518 19.2, train_time: 56.52, VALID_time: 1.302, loss: 1.449e+03, emb_loss:2.526e-06, nce_loss:0.0002823, best_valid(recall@20): 0.1839
valid 	 N@5: 0.1369, R@5: 0.08901, P@5: 0.1076
valid 	 N@10: 0.1388, R@10: 0.1286, P@10: 0.07885
valid 	 N@15: 0.147, R@15: 0.1594, P@15: 0.06544
valid 	 N@20: 0.155, R@20: 0.1856, P@20: 0.05722
valid 	 N@25: 0.1621, R@25: 0.2077, P@25: 0.05136
valid 	 N@30: 0.168, R@30: 0.2264, P@30: 0.04686
valid 	 N@40: 0.1783, R@40: 0.2591, P@40: 0.0405
valid 	 N@50: 0.1866, R@50: 0.2865, P@50: 0.03599

6.425596769544532
2024-05-28 15:39:06,109 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:40:03,508 - [INFO] - E:9|TAU:6.519 18.93, train_time: 56.12, VALID_time: 1.274, loss: 1.444e+03, emb_loss:2.85e-06, nce_loss:0.0002926, best_valid(recall@20): 0.1856
valid 	 N@5: 0.1372, R@5: 0.08912, P@5: 0.1079
valid 	 N@10: 0.1391, R@10: 0.1289, P@10: 0.07883
valid 	 N@15: 0.1473, R@15: 0.1598, P@15: 0.06543
valid 	 N@20: 0.1554, R@20: 0.1859, P@20: 0.05727
valid 	 N@25: 0.1623, R@25: 0.2079, P@25: 0.05138
valid 	 N@30: 0.1684, R@30: 0.227, P@30: 0.04694
valid 	 N@40: 0.1787, R@40: 0.2597, P@40: 0.04055
valid 	 N@50: 0.1871, R@50: 0.2875, P@50: 0.03606

6.425596769544532
2024-05-28 15:40:03,582 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:41:01,976 - [INFO] - E:10|TAU:6.512 18.89, train_time: 57.09, VALID_time: 1.298, loss: 1.44e+03, emb_loss:3.188e-06, nce_loss:0.000303, best_valid(recall@20): 0.1859
valid 	 N@5: 0.1377, R@5: 0.08965, P@5: 0.1084
valid 	 N@10: 0.1396, R@10: 0.1297, P@10: 0.07922
valid 	 N@15: 0.1478, R@15: 0.1606, P@15: 0.06573
valid 	 N@20: 0.1558, R@20: 0.1865, P@20: 0.05741
valid 	 N@25: 0.1627, R@25: 0.2084, P@25: 0.05151
valid 	 N@30: 0.1688, R@30: 0.2273, P@30: 0.04701
valid 	 N@40: 0.1791, R@40: 0.2602, P@40: 0.04063
valid 	 N@50: 0.1875, R@50: 0.288, P@50: 0.03613

6.425596769544532
2024-05-28 15:41:02,048 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:42:01,618 - [INFO] - E:11|TAU:6.518 18.52, train_time: 58.0, VALID_time: 1.563, loss: 1.436e+03, emb_loss:3.539e-06, nce_loss:0.0003136, best_valid(recall@20): 0.1865
valid 	 N@5: 0.1377, R@5: 0.08946, P@5: 0.1083
valid 	 N@10: 0.1399, R@10: 0.1299, P@10: 0.07926
valid 	 N@15: 0.1482, R@15: 0.161, P@15: 0.06584
valid 	 N@20: 0.1562, R@20: 0.1868, P@20: 0.05752
valid 	 N@25: 0.1631, R@25: 0.2086, P@25: 0.0516
valid 	 N@30: 0.1692, R@30: 0.2276, P@30: 0.04715
valid 	 N@40: 0.1796, R@40: 0.2608, P@40: 0.04075
valid 	 N@50: 0.1878, R@50: 0.2879, P@50: 0.03616

6.425596769544532
2024-05-28 15:42:01,688 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:43:41,837 - [INFO] - E:12|TAU:6.523 18.8, train_time: 98.46, VALID_time: 1.688, loss: 1.433e+03, emb_loss:3.903e-06, nce_loss:0.0003242, best_valid(recall@20): 0.1868
valid 	 N@5: 0.1378, R@5: 0.08937, P@5: 0.1084
valid 	 N@10: 0.1399, R@10: 0.1299, P@10: 0.07941
valid 	 N@15: 0.148, R@15: 0.1607, P@15: 0.06582
valid 	 N@20: 0.1562, R@20: 0.1871, P@20: 0.05765
valid 	 N@25: 0.1631, R@25: 0.2088, P@25: 0.05163
valid 	 N@30: 0.1693, R@30: 0.2281, P@30: 0.04722
valid 	 N@40: 0.1794, R@40: 0.2604, P@40: 0.04072
valid 	 N@50: 0.1879, R@50: 0.2887, P@50: 0.03624

6.425596769544532
2024-05-28 15:43:41,911 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:45:21,613 - [INFO] - E:13|TAU:6.515 18.85, train_time: 98.03, VALID_time: 1.663, loss: 1.43e+03, emb_loss:4.28e-06, nce_loss:0.0003349, best_valid(recall@20): 0.1871
valid 	 N@5: 0.1376, R@5: 0.08941, P@5: 0.1084
valid 	 N@10: 0.14, R@10: 0.1303, P@10: 0.07959
valid 	 N@15: 0.1481, R@15: 0.1611, P@15: 0.06601
valid 	 N@20: 0.1562, R@20: 0.1872, P@20: 0.05768
valid 	 N@25: 0.1632, R@25: 0.2091, P@25: 0.05178
valid 	 N@30: 0.1692, R@30: 0.2282, P@30: 0.04726
valid 	 N@40: 0.1795, R@40: 0.2612, P@40: 0.04081
valid 	 N@50: 0.1879, R@50: 0.2888, P@50: 0.03628

6.425596769544532
2024-05-28 15:45:21,686 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:47:01,746 - [INFO] - E:14|TAU:6.526 18.49, train_time: 98.34, VALID_time: 1.72, loss: 1.428e+03, emb_loss:4.668e-06, nce_loss:0.0003459, best_valid(recall@20): 0.1872
valid 	 N@5: 0.1379, R@5: 0.08975, P@5: 0.1085
valid 	 N@10: 0.1401, R@10: 0.1301, P@10: 0.07964
valid 	 N@15: 0.1483, R@15: 0.1613, P@15: 0.06599
valid 	 N@20: 0.1565, R@20: 0.1876, P@20: 0.05783
valid 	 N@25: 0.1635, R@25: 0.2096, P@25: 0.05189
valid 	 N@30: 0.1696, R@30: 0.2287, P@30: 0.04737
valid 	 N@40: 0.1799, R@40: 0.2616, P@40: 0.04088
valid 	 N@50: 0.1882, R@50: 0.289, P@50: 0.03632

6.425596769544532
2024-05-28 15:47:01,817 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:48:41,498 - [INFO] - E:15|TAU:6.52 18.39, train_time: 97.91, VALID_time: 1.771, loss: 1.425e+03, emb_loss:5.067e-06, nce_loss:0.0003567, best_valid(recall@20): 0.1876
valid 	 N@5: 0.138, R@5: 0.08964, P@5: 0.1087
valid 	 N@10: 0.1402, R@10: 0.1304, P@10: 0.07959
valid 	 N@15: 0.1486, R@15: 0.1619, P@15: 0.06621
valid 	 N@20: 0.1567, R@20: 0.188, P@20: 0.05795
valid 	 N@25: 0.1637, R@25: 0.2099, P@25: 0.05197
valid 	 N@30: 0.1698, R@30: 0.229, P@30: 0.04741
valid 	 N@40: 0.1801, R@40: 0.2621, P@40: 0.04097
valid 	 N@50: 0.1883, R@50: 0.2892, P@50: 0.03632

6.425596769544532
2024-05-28 15:48:41,574 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:50:21,381 - [INFO] - E:16|TAU:6.533 18.5, train_time: 98.22, VALID_time: 1.581, loss: 1.423e+03, emb_loss:5.474e-06, nce_loss:0.0003677, best_valid(recall@20): 0.188
valid 	 N@5: 0.1387, R@5: 0.09009, P@5: 0.109
valid 	 N@10: 0.1407, R@10: 0.1306, P@10: 0.0797
valid 	 N@15: 0.1492, R@15: 0.1623, P@15: 0.06632
valid 	 N@20: 0.1571, R@20: 0.1879, P@20: 0.05797
valid 	 N@25: 0.1642, R@25: 0.2101, P@25: 0.05202
valid 	 N@30: 0.1703, R@30: 0.2293, P@30: 0.04754
valid 	 N@40: 0.1806, R@40: 0.2624, P@40: 0.04098
valid 	 N@50: 0.1887, R@50: 0.2889, P@50: 0.03631

6.425596769544532
2024-05-28 15:50:21,412 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:52:01,157 - [INFO] - E:17|TAU:6.524 18.83, train_time: 98.17, VALID_time: 1.576, loss: 1.421e+03, emb_loss:5.891e-06, nce_loss:0.0003787, best_valid(recall@20): 0.188
valid 	 N@5: 0.139, R@5: 0.09029, P@5: 0.1093
valid 	 N@10: 0.1411, R@10: 0.131, P@10: 0.07996
valid 	 N@15: 0.1494, R@15: 0.1625, P@15: 0.0663
valid 	 N@20: 0.1574, R@20: 0.1882, P@20: 0.058
valid 	 N@25: 0.1644, R@25: 0.2102, P@25: 0.05202
valid 	 N@30: 0.1706, R@30: 0.2295, P@30: 0.04756
valid 	 N@40: 0.1807, R@40: 0.2618, P@40: 0.04094
valid 	 N@50: 0.1891, R@50: 0.2898, P@50: 0.03642

6.425596769544532
2024-05-28 15:52:01,231 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:53:41,103 - [INFO] - E:18|TAU:6.517 17.7, train_time: 98.29, VALID_time: 1.581, loss: 1.418e+03, emb_loss:6.316e-06, nce_loss:0.0003896, best_valid(recall@20): 0.1882
valid 	 N@5: 0.1388, R@5: 0.09027, P@5: 0.1092
valid 	 N@10: 0.1411, R@10: 0.1314, P@10: 0.0801
valid 	 N@15: 0.1493, R@15: 0.1624, P@15: 0.06636
valid 	 N@20: 0.1573, R@20: 0.1882, P@20: 0.05798
valid 	 N@25: 0.1644, R@25: 0.2104, P@25: 0.05207
valid 	 N@30: 0.1705, R@30: 0.2295, P@30: 0.04754
valid 	 N@40: 0.1807, R@40: 0.2622, P@40: 0.04101
valid 	 N@50: 0.1892, R@50: 0.2904, P@50: 0.03645

6.425596769544532
2024-05-28 15:53:41,133 - [INFO] - current w_0 is 9.17942388767301
2024-05-28 15:55:21,760 - [INFO] - E:19|TAU:6.53 18.17, train_time: 98.88, VALID_time: 1.746, loss: 1.416e+03, emb_loss:6.748e-06, nce_loss:0.0004006, best_valid(recall@20): 0.1882
valid 	 N@5: 0.1388, R@5: 0.09035, P@5: 0.1093
valid 	 N@10: 0.1412, R@10: 0.1315, P@10: 0.08018
valid 	 N@15: 0.1495, R@15: 0.1626, P@15: 0.06651
valid 	 N@20: 0.1578, R@20: 0.1892, P@20: 0.05827
valid 	 N@25: 0.1647, R@25: 0.211, P@25: 0.05218
valid 	 N@30: 0.1707, R@30: 0.2299, P@30: 0.04765
valid 	 N@40: 0.1811, R@40: 0.2631, P@40: 0.04109
valid 	 N@50: 0.1893, R@50: 0.29, P@50: 0.03644

6.425596769544532
2024-05-28 15:55:21,831 - [INFO] - current w_0 is 9.17942388767301
