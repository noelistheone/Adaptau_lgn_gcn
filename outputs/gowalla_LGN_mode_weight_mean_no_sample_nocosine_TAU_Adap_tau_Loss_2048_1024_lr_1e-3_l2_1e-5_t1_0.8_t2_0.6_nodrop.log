2024-06-08 14:10:39,874 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_08_06_2024_14:10:39', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-08 14:10:42,042 - [INFO] - load train.txt
2024-06-08 14:10:46,167 - [INFO] - building the adj mat ...
2024-06-08 14:10:46,724 - [INFO] - train set len is 810128
2024-06-08 14:10:46,724 - [INFO] - test set len is 217242
2024-06-08 14:10:46,724 - [INFO] - loading over ...
2024-06-08 14:10:46,724 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-08 14:10:58,373 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-08 14:10:58,374 - [INFO] - start training ...
6.425596769544532
2024-06-08 14:10:58,405 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 1116, 16295],
        [ 7695, 31457],
        [25830, 16994],
        ...,
        [16942, 14293],
        [12492, 15317],
        [24764,  4875]], device='cuda:0')
2024-06-08 14:11:37,042 - [INFO] - E:0|TAU:9.179 9.179, train_time: 37.52, VALID_time: 1.113, loss: 7.689e+03, emb_loss:5.815e-07, nce_loss:15.05, best_valid(recall@20): -inf
valid 	 N@5: 0.1293, R@5: 0.08386, P@5: 0.101
valid 	 N@10: 0.1318, R@10: 0.1224, P@10: 0.07441
valid 	 N@15: 0.1397, R@15: 0.1518, P@15: 0.06176
valid 	 N@20: 0.1474, R@20: 0.1764, P@20: 0.05408
valid 	 N@25: 0.154, R@25: 0.197, P@25: 0.04848
valid 	 N@30: 0.1598, R@30: 0.2151, P@30: 0.04431
valid 	 N@40: 0.1697, R@40: 0.2469, P@40: 0.03834
valid 	 N@50: 0.1778, R@50: 0.2734, P@50: 0.03409

6.425596769544532
2024-06-08 14:11:37,093 - [INFO] - current w_0 is 9.17942388767301
tensor([[27343,  9851],
        [ 3929, 34989],
        [ 6335, 12133],
        ...,
        [ 7103, 11522],
        [ 3704, 27253],
        [26896,  2363]], device='cuda:0')
2024-06-08 14:12:16,035 - [INFO] - E:1|TAU:6.19 24.95, train_time: 37.76, VALID_time: 1.156, loss: 7.627e+03, emb_loss:1.005e-06, nce_loss:15.03, best_valid(recall@20): 0.1764
valid 	 N@5: 0.1286, R@5: 0.0819, P@5: 0.1004
valid 	 N@10: 0.1305, R@10: 0.1201, P@10: 0.07403
valid 	 N@15: 0.1375, R@15: 0.1475, P@15: 0.06106
valid 	 N@20: 0.1444, R@20: 0.1703, P@20: 0.0531
valid 	 N@25: 0.1506, R@25: 0.1899, P@25: 0.0476
valid 	 N@30: 0.1561, R@30: 0.2075, P@30: 0.04346
valid 	 N@40: 0.1652, R@40: 0.2365, P@40: 0.03738
valid 	 N@50: 0.1727, R@50: 0.2614, P@50: 0.03322

6.425596769544532
2024-06-08 14:12:16,063 - [INFO] - current w_0 is 9.17942388767301
tensor([[  218, 10307],
        [ 5865,   791],
        [25090, 16681],
        ...,
        [ 8249,   257],
        [20061, 24121],
        [29622, 15718]], device='cuda:0')
2024-06-08 14:12:55,580 - [INFO] - E:2|TAU:6.494 23.68, train_time: 38.33, VALID_time: 1.162, loss: 7.469e+03, emb_loss:1.406e-06, nce_loss:15.03, best_valid(recall@20): 0.1764
valid 	 N@5: 0.1367, R@5: 0.08784, P@5: 0.1068
valid 	 N@10: 0.1387, R@10: 0.1278, P@10: 0.07847
valid 	 N@15: 0.1464, R@15: 0.1574, P@15: 0.06485
valid 	 N@20: 0.1541, R@20: 0.1825, P@20: 0.05664
valid 	 N@25: 0.1606, R@25: 0.2031, P@25: 0.05064
valid 	 N@30: 0.1665, R@30: 0.2215, P@30: 0.04624
valid 	 N@40: 0.1767, R@40: 0.2542, P@40: 0.03995
valid 	 N@50: 0.1849, R@50: 0.2814, P@50: 0.03551

6.425596769544532
2024-06-08 14:12:55,669 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 8576, 23516],
        [19755, 15693],
        [27884, 27257],
        ...,
        [19385,  5401],
        [10129, 34610],
        [12303,  2207]], device='cuda:0')
2024-06-08 14:13:35,317 - [INFO] - E:3|TAU:6.491 24.95, train_time: 38.47, VALID_time: 1.157, loss: 7.454e+03, emb_loss:1.758e-06, nce_loss:15.03, best_valid(recall@20): 0.1825
valid 	 N@5: 0.1364, R@5: 0.08766, P@5: 0.1066
valid 	 N@10: 0.139, R@10: 0.1289, P@10: 0.07882
valid 	 N@15: 0.1469, R@15: 0.1588, P@15: 0.06533
valid 	 N@20: 0.1546, R@20: 0.1838, P@20: 0.05702
valid 	 N@25: 0.1614, R@25: 0.2053, P@25: 0.05102
valid 	 N@30: 0.1674, R@30: 0.224, P@30: 0.0466
valid 	 N@40: 0.1776, R@40: 0.2567, P@40: 0.04023
valid 	 N@50: 0.1856, R@50: 0.2833, P@50: 0.03569

6.425596769544532
2024-06-08 14:13:35,394 - [INFO] - current w_0 is 9.17942388767301
tensor([[20111, 36281],
        [ 8640, 22972],
        [ 3334,  2859],
        ...,
        [ 2786,  6695],
        [17258,  6423],
        [ 1250,  1991]], device='cuda:0')
2024-06-08 14:14:14,738 - [INFO] - E:4|TAU:6.5 21.24, train_time: 38.28, VALID_time: 1.043, loss: 7.424e+03, emb_loss:2.111e-06, nce_loss:15.03, best_valid(recall@20): 0.1838
valid 	 N@5: 0.1394, R@5: 0.08988, P@5: 0.1083
valid 	 N@10: 0.1421, R@10: 0.1314, P@10: 0.07997
valid 	 N@15: 0.1502, R@15: 0.1622, P@15: 0.06631
valid 	 N@20: 0.1579, R@20: 0.1873, P@20: 0.05774
valid 	 N@25: 0.1647, R@25: 0.2086, P@25: 0.05166
valid 	 N@30: 0.1707, R@30: 0.2274, P@30: 0.04714
valid 	 N@40: 0.1809, R@40: 0.2602, P@40: 0.04069
valid 	 N@50: 0.1895, R@50: 0.2883, P@50: 0.03625

6.425596769544532
2024-06-08 14:14:14,822 - [INFO] - current w_0 is 9.17942388767301
tensor([[23220, 19017],
        [14655,  6399],
        [13649, 36715],
        ...,
        [ 9942, 27566],
        [10514, 27212],
        [ 6945,  2438]], device='cuda:0')
2024-06-08 14:14:54,004 - [INFO] - E:5|TAU:6.51 21.66, train_time: 38.03, VALID_time: 1.125, loss: 7.416e+03, emb_loss:2.462e-06, nce_loss:15.03, best_valid(recall@20): 0.1873
valid 	 N@5: 0.1389, R@5: 0.08971, P@5: 0.1086
valid 	 N@10: 0.1417, R@10: 0.1315, P@10: 0.08014
valid 	 N@15: 0.1495, R@15: 0.1617, P@15: 0.06626
valid 	 N@20: 0.1573, R@20: 0.187, P@20: 0.05767
valid 	 N@25: 0.1645, R@25: 0.2096, P@25: 0.05188
valid 	 N@30: 0.1705, R@30: 0.2286, P@30: 0.0473
valid 	 N@40: 0.1809, R@40: 0.2617, P@40: 0.04088
valid 	 N@50: 0.1891, R@50: 0.2888, P@50: 0.03628

6.425596769544532
2024-06-08 14:14:54,036 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 4116,  3936],
        [25253, 27292],
        [ 2912, 20656],
        ...,
        [21262, 29441],
        [ 1621, 11653],
        [ 4877, 22432]], device='cuda:0')
2024-06-08 14:15:33,727 - [INFO] - E:6|TAU:6.516 19.25, train_time: 38.46, VALID_time: 1.207, loss: 7.403e+03, emb_loss:2.828e-06, nce_loss:15.03, best_valid(recall@20): 0.1873
valid 	 N@5: 0.1401, R@5: 0.09067, P@5: 0.1093
valid 	 N@10: 0.1426, R@10: 0.1318, P@10: 0.08044
valid 	 N@15: 0.1505, R@15: 0.1623, P@15: 0.06635
valid 	 N@20: 0.1583, R@20: 0.1876, P@20: 0.05787
valid 	 N@25: 0.1654, R@25: 0.2098, P@25: 0.05198
valid 	 N@30: 0.1715, R@30: 0.2291, P@30: 0.0474
valid 	 N@40: 0.1818, R@40: 0.2621, P@40: 0.04089
valid 	 N@50: 0.1902, R@50: 0.2898, P@50: 0.03638

6.425596769544532
2024-06-08 14:15:33,805 - [INFO] - current w_0 is 9.17942388767301
tensor([[26234,  2231],
        [16053, 14792],
        [ 7679,  7122],
        ...,
        [ 9841, 30328],
        [ 9428, 13682],
        [15949, 25531]], device='cuda:0')
2024-06-08 14:16:13,208 - [INFO] - E:7|TAU:6.526 19.48, train_time: 38.22, VALID_time: 1.158, loss: 7.399e+03, emb_loss:3.198e-06, nce_loss:15.03, best_valid(recall@20): 0.1876
valid 	 N@5: 0.1402, R@5: 0.09099, P@5: 0.1096
valid 	 N@10: 0.1423, R@10: 0.1315, P@10: 0.08019
valid 	 N@15: 0.1504, R@15: 0.1624, P@15: 0.06647
valid 	 N@20: 0.1584, R@20: 0.188, P@20: 0.05807
valid 	 N@25: 0.1655, R@25: 0.2104, P@25: 0.05214
valid 	 N@30: 0.1716, R@30: 0.2296, P@30: 0.04754
valid 	 N@40: 0.1818, R@40: 0.2623, P@40: 0.04094
valid 	 N@50: 0.1903, R@50: 0.2905, P@50: 0.03647

6.425596769544532
2024-06-08 14:16:13,289 - [INFO] - current w_0 is 9.17942388767301
tensor([[13280, 17406],
        [   63,  4865],
        [ 8671, 36994],
        ...,
        [ 6112, 16040],
        [ 4325, 35598],
        [12237, 40144]], device='cuda:0')
2024-06-08 14:16:52,943 - [INFO] - E:8|TAU:6.52 19.08, train_time: 38.47, VALID_time: 1.153, loss: 7.392e+03, emb_loss:3.58e-06, nce_loss:15.03, best_valid(recall@20): 0.188
valid 	 N@5: 0.1407, R@5: 0.09147, P@5: 0.1102
valid 	 N@10: 0.1428, R@10: 0.1321, P@10: 0.08062
valid 	 N@15: 0.151, R@15: 0.1631, P@15: 0.06687
valid 	 N@20: 0.1589, R@20: 0.1888, P@20: 0.05824
valid 	 N@25: 0.1659, R@25: 0.2106, P@25: 0.05225
valid 	 N@30: 0.1719, R@30: 0.2298, P@30: 0.04762
valid 	 N@40: 0.1824, R@40: 0.2632, P@40: 0.04112
valid 	 N@50: 0.1907, R@50: 0.2905, P@50: 0.03651

6.425596769544532
2024-06-08 14:16:53,030 - [INFO] - current w_0 is 9.17942388767301
tensor([[  408,  5782],
        [24813, 20692],
        [ 4189, 12519],
        ...,
        [19021, 34296],
        [ 1268,  1844],
        [23961, 25847]], device='cuda:0')
2024-06-08 14:17:32,663 - [INFO] - E:9|TAU:6.522 18.86, train_time: 38.45, VALID_time: 1.157, loss: 7.388e+03, emb_loss:3.972e-06, nce_loss:15.03, best_valid(recall@20): 0.1888
valid 	 N@5: 0.1402, R@5: 0.09092, P@5: 0.1096
valid 	 N@10: 0.1431, R@10: 0.1329, P@10: 0.08085
valid 	 N@15: 0.151, R@15: 0.1633, P@15: 0.06678
valid 	 N@20: 0.1589, R@20: 0.189, P@20: 0.05826
valid 	 N@25: 0.1659, R@25: 0.2109, P@25: 0.05223
valid 	 N@30: 0.1721, R@30: 0.2304, P@30: 0.04768
valid 	 N@40: 0.1826, R@40: 0.2638, P@40: 0.04121
valid 	 N@50: 0.1908, R@50: 0.2909, P@50: 0.03656

6.425596769544532
2024-06-08 14:17:32,733 - [INFO] - current w_0 is 9.17942388767301
tensor([[   10,  1305],
        [ 1509, 23504],
        [20982, 11637],
        ...,
        [21958,  2305],
        [24808, 37376],
        [21100,  5515]], device='cuda:0')
2024-06-08 14:18:11,977 - [INFO] - E:10|TAU:6.515 18.77, train_time: 38.1, VALID_time: 1.126, loss: 7.384e+03, emb_loss:4.374e-06, nce_loss:15.03, best_valid(recall@20): 0.189
valid 	 N@5: 0.1407, R@5: 0.09128, P@5: 0.11
valid 	 N@10: 0.1433, R@10: 0.1329, P@10: 0.08095
valid 	 N@15: 0.1513, R@15: 0.1634, P@15: 0.06693
valid 	 N@20: 0.1594, R@20: 0.1893, P@20: 0.05843
valid 	 N@25: 0.1662, R@25: 0.2108, P@25: 0.05231
valid 	 N@30: 0.1723, R@30: 0.2302, P@30: 0.04771
valid 	 N@40: 0.1827, R@40: 0.2634, P@40: 0.04118
valid 	 N@50: 0.1911, R@50: 0.2911, P@50: 0.03661

6.425596769544532
2024-06-08 14:18:12,054 - [INFO] - current w_0 is 9.17942388767301
tensor([[  102,  6180],
        [  866, 15426],
        [ 3142,   133],
        ...,
        [24350, 13899],
        [ 7211, 31767],
        [19942,  3105]], device='cuda:0')
2024-06-08 14:18:51,596 - [INFO] - E:11|TAU:6.523 18.6, train_time: 38.47, VALID_time: 1.05, loss: 7.381e+03, emb_loss:4.784e-06, nce_loss:15.03, best_valid(recall@20): 0.1893
valid 	 N@5: 0.1404, R@5: 0.09117, P@5: 0.11
valid 	 N@10: 0.1431, R@10: 0.1329, P@10: 0.08089
valid 	 N@15: 0.1513, R@15: 0.1639, P@15: 0.06704
valid 	 N@20: 0.159, R@20: 0.189, P@20: 0.05828
valid 	 N@25: 0.166, R@25: 0.211, P@25: 0.05226
valid 	 N@30: 0.1722, R@30: 0.2303, P@30: 0.04772
valid 	 N@40: 0.1825, R@40: 0.2631, P@40: 0.04118
valid 	 N@50: 0.1909, R@50: 0.2911, P@50: 0.0366

6.425596769544532
2024-06-08 14:18:51,622 - [INFO] - current w_0 is 9.17942388767301
tensor([[19359, 38345],
        [15419, 35489],
        [  299, 12346],
        ...,
        [ 3150, 12759],
        [17272,  2692],
        [ 7384, 19723]], device='cuda:0')
2024-06-08 14:19:30,958 - [INFO] - E:12|TAU:6.528 18.79, train_time: 38.19, VALID_time: 1.123, loss: 7.378e+03, emb_loss:5.204e-06, nce_loss:15.03, best_valid(recall@20): 0.1893
valid 	 N@5: 0.1406, R@5: 0.09117, P@5: 0.11
valid 	 N@10: 0.1433, R@10: 0.1331, P@10: 0.081
valid 	 N@15: 0.1512, R@15: 0.1635, P@15: 0.06692
valid 	 N@20: 0.1592, R@20: 0.1893, P@20: 0.05842
valid 	 N@25: 0.1662, R@25: 0.2112, P@25: 0.05235
valid 	 N@30: 0.1722, R@30: 0.2303, P@30: 0.04774
valid 	 N@40: 0.1827, R@40: 0.2638, P@40: 0.04123
valid 	 N@50: 0.191, R@50: 0.2908, P@50: 0.03658

6.425596769544532
2024-06-08 14:19:31,045 - [INFO] - current w_0 is 9.17942388767301
tensor([[24924,   141],
        [28186, 23396],
        [10804,   551],
        ...,
        [19934, 29049],
        [15315,  8369],
        [ 9899, 25713]], device='cuda:0')
2024-06-08 14:20:10,515 - [INFO] - E:13|TAU:6.522 18.89, train_time: 38.38, VALID_time: 1.066, loss: 7.376e+03, emb_loss:5.633e-06, nce_loss:15.03, best_valid(recall@20): 0.1893
valid 	 N@5: 0.1406, R@5: 0.09127, P@5: 0.1101
valid 	 N@10: 0.1432, R@10: 0.133, P@10: 0.081
valid 	 N@15: 0.1512, R@15: 0.1635, P@15: 0.06697
valid 	 N@20: 0.1592, R@20: 0.1894, P@20: 0.05846
valid 	 N@25: 0.1661, R@25: 0.2109, P@25: 0.05235
valid 	 N@30: 0.1723, R@30: 0.2304, P@30: 0.04777
valid 	 N@40: 0.1826, R@40: 0.2635, P@40: 0.04119
valid 	 N@50: 0.1911, R@50: 0.2915, P@50: 0.03666

6.425596769544532
2024-06-08 14:20:10,591 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 5941, 29036],
        [  687,  3469],
        [   77,  3948],
        ...,
        [17497,  2114],
        [ 4722,  5502],
        [16143,  9726]], device='cuda:0')
2024-06-08 14:20:50,017 - [INFO] - E:14|TAU:6.533 18.49, train_time: 38.34, VALID_time: 1.062, loss: 7.373e+03, emb_loss:6.07e-06, nce_loss:15.03, best_valid(recall@20): 0.1894
valid 	 N@5: 0.1413, R@5: 0.09181, P@5: 0.1106
valid 	 N@10: 0.1436, R@10: 0.1332, P@10: 0.08113
valid 	 N@15: 0.1514, R@15: 0.1633, P@15: 0.06689
valid 	 N@20: 0.1595, R@20: 0.1894, P@20: 0.05849
valid 	 N@25: 0.1664, R@25: 0.2109, P@25: 0.05234
valid 	 N@30: 0.1726, R@30: 0.2306, P@30: 0.04779
valid 	 N@40: 0.1831, R@40: 0.2642, P@40: 0.04126
valid 	 N@50: 0.1914, R@50: 0.2913, P@50: 0.03665

6.425596769544532
2024-06-08 14:20:50,093 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 5101,  2651],
        [ 1684, 24977],
        [ 8061, 22753],
        ...,
        [ 6955, 23539],
        [ 4208,  2403],
        [ 6897, 17799]], device='cuda:0')
2024-06-08 14:21:29,550 - [INFO] - E:15|TAU:6.526 18.41, train_time: 38.36, VALID_time: 1.066, loss: 7.371e+03, emb_loss:6.514e-06, nce_loss:15.03, best_valid(recall@20): 0.1894
valid 	 N@5: 0.1407, R@5: 0.09129, P@5: 0.1101
valid 	 N@10: 0.1434, R@10: 0.1332, P@10: 0.08108
valid 	 N@15: 0.1514, R@15: 0.1636, P@15: 0.06701
valid 	 N@20: 0.1595, R@20: 0.1898, P@20: 0.05856
valid 	 N@25: 0.1664, R@25: 0.2117, P@25: 0.05246
valid 	 N@30: 0.1724, R@30: 0.2305, P@30: 0.04776
valid 	 N@40: 0.1828, R@40: 0.2636, P@40: 0.04125
valid 	 N@50: 0.1913, R@50: 0.2919, P@50: 0.03668

6.425596769544532
2024-06-08 14:21:29,621 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 4619, 34845],
        [25073, 23109],
        [ 7127,  5047],
        ...,
        [ 1259, 23920],
        [ 3837,  2525],
        [  923,  9832]], device='cuda:0')
2024-06-08 14:22:08,762 - [INFO] - E:16|TAU:6.538 18.4, train_time: 38.1, VALID_time: 1.019, loss: 7.369e+03, emb_loss:6.963e-06, nce_loss:15.03, best_valid(recall@20): 0.1898
valid 	 N@5: 0.141, R@5: 0.0914, P@5: 0.1104
valid 	 N@10: 0.1435, R@10: 0.133, P@10: 0.08103
valid 	 N@15: 0.1516, R@15: 0.1639, P@15: 0.06712
valid 	 N@20: 0.1597, R@20: 0.1901, P@20: 0.05857
valid 	 N@25: 0.1667, R@25: 0.212, P@25: 0.05254
valid 	 N@30: 0.1726, R@30: 0.2307, P@30: 0.04781
valid 	 N@40: 0.183, R@40: 0.2637, P@40: 0.04125
valid 	 N@50: 0.1914, R@50: 0.2913, P@50: 0.03665

6.425596769544532
2024-06-08 14:22:08,817 - [INFO] - current w_0 is 9.17942388767301
tensor([[28125, 40599],
        [ 6057, 25062],
        [ 9192, 21936],
        ...,
        [23366, 29774],
        [ 5531,  3072],
        [11553, 35329]], device='cuda:0')
2024-06-08 14:22:48,222 - [INFO] - E:17|TAU:6.53 18.73, train_time: 38.32, VALID_time: 1.059, loss: 7.367e+03, emb_loss:7.42e-06, nce_loss:15.03, best_valid(recall@20): 0.1901
valid 	 N@5: 0.1414, R@5: 0.09198, P@5: 0.1106
valid 	 N@10: 0.1438, R@10: 0.1334, P@10: 0.08113
valid 	 N@15: 0.1518, R@15: 0.1638, P@15: 0.06705
valid 	 N@20: 0.16, R@20: 0.1902, P@20: 0.05867
valid 	 N@25: 0.1667, R@25: 0.2114, P@25: 0.05244
valid 	 N@30: 0.1728, R@30: 0.2305, P@30: 0.04782
valid 	 N@40: 0.1834, R@40: 0.2646, P@40: 0.04132
valid 	 N@50: 0.1916, R@50: 0.2913, P@50: 0.03661

6.425596769544532
2024-06-08 14:22:48,294 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 8378, 10689],
        [ 5817,  4685],
        [ 3474,  5126],
        ...,
        [10462, 27697],
        [23391,    51],
        [16512, 16110]], device='cuda:0')
2024-06-08 14:23:27,680 - [INFO] - E:18|TAU:6.523 17.65, train_time: 38.29, VALID_time: 1.074, loss: 7.365e+03, emb_loss:7.883e-06, nce_loss:15.03, best_valid(recall@20): 0.1902
valid 	 N@5: 0.141, R@5: 0.09155, P@5: 0.1104
valid 	 N@10: 0.1435, R@10: 0.1333, P@10: 0.08109
valid 	 N@15: 0.1515, R@15: 0.1636, P@15: 0.06701
valid 	 N@20: 0.1597, R@20: 0.19, P@20: 0.05861
valid 	 N@25: 0.1666, R@25: 0.2118, P@25: 0.05252
valid 	 N@30: 0.1727, R@30: 0.2312, P@30: 0.0479
valid 	 N@40: 0.1831, R@40: 0.2644, P@40: 0.0413
valid 	 N@50: 0.1914, R@50: 0.2916, P@50: 0.03667

6.425596769544532
2024-06-08 14:23:27,707 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 8808,   760],
        [  216, 10054],
        [14035, 27654],
        ...,
        [11879,  8974],
        [ 3557,  6366],
        [26252,  3194]], device='cuda:0')
2024-06-08 14:24:07,096 - [INFO] - E:19|TAU:6.537 18.16, train_time: 38.32, VALID_time: 1.042, loss: 7.363e+03, emb_loss:8.35e-06, nce_loss:15.03, best_valid(recall@20): 0.1902
valid 	 N@5: 0.1412, R@5: 0.0919, P@5: 0.1108
valid 	 N@10: 0.1435, R@10: 0.1331, P@10: 0.08109
valid 	 N@15: 0.1518, R@15: 0.1644, P@15: 0.06728
valid 	 N@20: 0.16, R@20: 0.1908, P@20: 0.05883
valid 	 N@25: 0.1668, R@25: 0.2121, P@25: 0.05258
valid 	 N@30: 0.1731, R@30: 0.2319, P@30: 0.04801
valid 	 N@40: 0.1833, R@40: 0.2645, P@40: 0.04135
valid 	 N@50: 0.1916, R@50: 0.2917, P@50: 0.03669

6.425596769544532
2024-06-08 14:24:07,170 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 4246,  9734],
        [17338, 36176],
        [13571,  1571],
        ...,
        [11188, 39369],
        [ 5257, 35553],
        [14916,  2591]], device='cuda:0')
2024-06-08 14:24:46,443 - [INFO] - E:20|TAU:6.546 18.07, train_time: 38.2, VALID_time: 1.047, loss: 7.362e+03, emb_loss:8.822e-06, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1414, R@5: 0.09189, P@5: 0.1108
valid 	 N@10: 0.1437, R@10: 0.1332, P@10: 0.08121
valid 	 N@15: 0.152, R@15: 0.1644, P@15: 0.06728
valid 	 N@20: 0.1601, R@20: 0.1906, P@20: 0.0588
valid 	 N@25: 0.1669, R@25: 0.212, P@25: 0.05258
valid 	 N@30: 0.1731, R@30: 0.2314, P@30: 0.04796
valid 	 N@40: 0.1834, R@40: 0.2643, P@40: 0.04135
valid 	 N@50: 0.1917, R@50: 0.2916, P@50: 0.03666

6.425596769544532
2024-06-08 14:24:46,469 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 1024, 12745],
        [11612,  1571],
        [29810, 18547],
        ...,
        [16695, 29958],
        [  959, 14433],
        [  415,  2534]], device='cuda:0')
2024-06-08 14:25:25,989 - [INFO] - E:21|TAU:6.532 18.05, train_time: 38.43, VALID_time: 1.064, loss: 7.36e+03, emb_loss:9.296e-06, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1413, R@5: 0.09192, P@5: 0.1106
valid 	 N@10: 0.1438, R@10: 0.1336, P@10: 0.08128
valid 	 N@15: 0.1519, R@15: 0.1644, P@15: 0.06732
valid 	 N@20: 0.16, R@20: 0.1905, P@20: 0.05873
valid 	 N@25: 0.1668, R@25: 0.2119, P@25: 0.05251
valid 	 N@30: 0.1729, R@30: 0.2309, P@30: 0.0479
valid 	 N@40: 0.1833, R@40: 0.2643, P@40: 0.04129
valid 	 N@50: 0.1915, R@50: 0.2914, P@50: 0.03664

6.425596769544532
2024-06-08 14:25:26,015 - [INFO] - current w_0 is 9.17942388767301
tensor([[23903, 19752],
        [ 5252, 15681],
        [  412,  3941],
        ...,
        [23226, 10957],
        [24867,  1500],
        [22321,  8266]], device='cuda:0')
2024-06-08 14:26:06,196 - [INFO] - E:22|TAU:6.525 18.23, train_time: 38.95, VALID_time: 1.2, loss: 7.358e+03, emb_loss:9.776e-06, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1414, R@5: 0.09198, P@5: 0.1109
valid 	 N@10: 0.1438, R@10: 0.1336, P@10: 0.08138
valid 	 N@15: 0.1519, R@15: 0.1642, P@15: 0.06729
valid 	 N@20: 0.1599, R@20: 0.1901, P@20: 0.05869
valid 	 N@25: 0.1668, R@25: 0.212, P@25: 0.0526
valid 	 N@30: 0.173, R@30: 0.2312, P@30: 0.048
valid 	 N@40: 0.1834, R@40: 0.2648, P@40: 0.04141
valid 	 N@50: 0.1917, R@50: 0.292, P@50: 0.03673

6.425596769544532
2024-06-08 14:26:06,224 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 5545, 19792],
        [21517, 24493],
        [ 4719, 24403],
        ...,
        [12839,  2235],
        [  537, 10049],
        [ 4501,  4210]], device='cuda:0')
2024-06-08 14:26:45,876 - [INFO] - E:23|TAU:6.54 17.94, train_time: 38.54, VALID_time: 1.086, loss: 7.357e+03, emb_loss:1.026e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1409, R@5: 0.09148, P@5: 0.1104
valid 	 N@10: 0.1436, R@10: 0.1334, P@10: 0.0813
valid 	 N@15: 0.1516, R@15: 0.1639, P@15: 0.0671
valid 	 N@20: 0.1595, R@20: 0.1897, P@20: 0.05847
valid 	 N@25: 0.1668, R@25: 0.2123, P@25: 0.05262
valid 	 N@30: 0.173, R@30: 0.2317, P@30: 0.04804
valid 	 N@40: 0.1832, R@40: 0.2645, P@40: 0.04133
valid 	 N@50: 0.1914, R@50: 0.2916, P@50: 0.03668

6.425596769544532
2024-06-08 14:26:45,902 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 8000,  6626],
        [19929, 25116],
        [  164,   478],
        ...,
        [ 1745, 21706],
        [20397,  5292],
        [ 8636, 34418]], device='cuda:0')
2024-06-08 14:27:25,608 - [INFO] - E:24|TAU:6.536 18.81, train_time: 38.62, VALID_time: 1.062, loss: 7.356e+03, emb_loss:1.074e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.141, R@5: 0.09168, P@5: 0.1105
valid 	 N@10: 0.1436, R@10: 0.1332, P@10: 0.08129
valid 	 N@15: 0.1514, R@15: 0.1636, P@15: 0.06703
valid 	 N@20: 0.1595, R@20: 0.1897, P@20: 0.05852
valid 	 N@25: 0.1667, R@25: 0.2122, P@25: 0.05257
valid 	 N@30: 0.1727, R@30: 0.2311, P@30: 0.04793
valid 	 N@40: 0.1831, R@40: 0.2643, P@40: 0.04132
valid 	 N@50: 0.1915, R@50: 0.292, P@50: 0.03671

6.425596769544532
2024-06-08 14:27:25,634 - [INFO] - current w_0 is 9.17942388767301
tensor([[24942, 10835],
        [12018,  3475],
        [16727,  7088],
        ...,
        [24709, 25650],
        [ 3359, 26626],
        [  502, 15595]], device='cuda:0')
2024-06-08 14:28:05,157 - [INFO] - E:25|TAU:6.546 17.87, train_time: 38.3, VALID_time: 1.199, loss: 7.354e+03, emb_loss:1.123e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1414, R@5: 0.09189, P@5: 0.1108
valid 	 N@10: 0.144, R@10: 0.1338, P@10: 0.08144
valid 	 N@15: 0.1519, R@15: 0.164, P@15: 0.06725
valid 	 N@20: 0.1601, R@20: 0.1905, P@20: 0.0587
valid 	 N@25: 0.167, R@25: 0.212, P@25: 0.05257
valid 	 N@30: 0.1731, R@30: 0.2312, P@30: 0.04796
valid 	 N@40: 0.1835, R@40: 0.2644, P@40: 0.04135
valid 	 N@50: 0.1919, R@50: 0.2922, P@50: 0.03673

6.425596769544532
2024-06-08 14:28:05,183 - [INFO] - current w_0 is 9.17942388767301
tensor([[  859,  4033],
        [23580, 34986],
        [17925, 27194],
        ...,
        [26967, 12158],
        [11030, 10824],
        [ 3892,  7129]], device='cuda:0')
2024-06-08 14:28:45,021 - [INFO] - E:26|TAU:6.528 17.83, train_time: 38.71, VALID_time: 1.098, loss: 7.353e+03, emb_loss:1.173e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1412, R@5: 0.0919, P@5: 0.1106
valid 	 N@10: 0.1438, R@10: 0.1337, P@10: 0.08131
valid 	 N@15: 0.1518, R@15: 0.164, P@15: 0.06713
valid 	 N@20: 0.1599, R@20: 0.1902, P@20: 0.05862
valid 	 N@25: 0.167, R@25: 0.2125, P@25: 0.05263
valid 	 N@30: 0.1731, R@30: 0.2315, P@30: 0.04799
valid 	 N@40: 0.1834, R@40: 0.2645, P@40: 0.04137
valid 	 N@50: 0.1917, R@50: 0.292, P@50: 0.03673

6.425596769544532
2024-06-08 14:28:45,047 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 2624, 24454],
        [28624, 35474],
        [24465, 21862],
        ...,
        [16361,    54],
        [28456, 11364],
        [20782,  1120]], device='cuda:0')
2024-06-08 14:29:25,264 - [INFO] - E:27|TAU:6.532 17.95, train_time: 39.05, VALID_time: 1.144, loss: 7.352e+03, emb_loss:1.222e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1411, R@5: 0.09205, P@5: 0.1108
valid 	 N@10: 0.1437, R@10: 0.1336, P@10: 0.08133
valid 	 N@15: 0.1514, R@15: 0.1635, P@15: 0.06697
valid 	 N@20: 0.1595, R@20: 0.1897, P@20: 0.0585
valid 	 N@25: 0.1666, R@25: 0.212, P@25: 0.05256
valid 	 N@30: 0.1729, R@30: 0.2316, P@30: 0.04797
valid 	 N@40: 0.1831, R@40: 0.2645, P@40: 0.04132
valid 	 N@50: 0.1915, R@50: 0.2918, P@50: 0.03668

6.425596769544532
2024-06-08 14:29:25,291 - [INFO] - current w_0 is 9.17942388767301
tensor([[ 4630,  8266],
        [10150,   559],
        [ 2322,   410],
        ...,
        [ 1770, 15733],
        [ 9849,   323],
        [29052, 19345]], device='cuda:0')
2024-06-08 14:30:05,252 - [INFO] - E:28|TAU:6.544 18.0, train_time: 38.73, VALID_time: 1.208, loss: 7.351e+03, emb_loss:1.271e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1412, R@5: 0.09208, P@5: 0.1109
valid 	 N@10: 0.1436, R@10: 0.1335, P@10: 0.08129
valid 	 N@15: 0.1514, R@15: 0.1635, P@15: 0.06706
valid 	 N@20: 0.1597, R@20: 0.1901, P@20: 0.05866
valid 	 N@25: 0.1668, R@25: 0.2123, P@25: 0.05268
valid 	 N@30: 0.173, R@30: 0.2319, P@30: 0.04808
valid 	 N@40: 0.1832, R@40: 0.2645, P@40: 0.04137
valid 	 N@50: 0.1916, R@50: 0.2923, P@50: 0.03674

6.425596769544532
2024-06-08 14:30:05,284 - [INFO] - current w_0 is 9.17942388767301
tensor([[  870,  6341],
        [10262, 34719],
        [  193,  6738],
        ...,
        [11623,  9319],
        [18659,  9022],
        [11754,  3419]], device='cuda:0')
2024-06-08 14:30:44,858 - [INFO] - E:29|TAU:6.536 17.85, train_time: 38.5, VALID_time: 1.046, loss: 7.35e+03, emb_loss:1.321e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1409, R@5: 0.09162, P@5: 0.1106
valid 	 N@10: 0.1434, R@10: 0.1333, P@10: 0.08117
valid 	 N@15: 0.1512, R@15: 0.1634, P@15: 0.06705
valid 	 N@20: 0.1594, R@20: 0.1898, P@20: 0.05867
valid 	 N@25: 0.1665, R@25: 0.212, P@25: 0.05258
valid 	 N@30: 0.1726, R@30: 0.2313, P@30: 0.04796
valid 	 N@40: 0.1831, R@40: 0.2649, P@40: 0.04137
valid 	 N@50: 0.1914, R@50: 0.2921, P@50: 0.03672

6.425596769544532
2024-06-08 14:30:44,883 - [INFO] - current w_0 is 9.17942388767301
tensor([[13498,   205],
        [19471, 16575],
        [26840,  1473],
        ...,
        [26628, 14304],
        [14884, 35738],
        [ 7910,  3070]], device='cuda:0')
2024-06-08 14:31:24,434 - [INFO] - E:30|TAU:6.53 17.54, train_time: 38.43, VALID_time: 1.096, loss: 7.349e+03, emb_loss:1.371e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1412, R@5: 0.09187, P@5: 0.1109
valid 	 N@10: 0.1436, R@10: 0.1334, P@10: 0.08124
valid 	 N@15: 0.1515, R@15: 0.1638, P@15: 0.06707
valid 	 N@20: 0.1595, R@20: 0.1896, P@20: 0.05854
valid 	 N@25: 0.1667, R@25: 0.2122, P@25: 0.05264
valid 	 N@30: 0.1728, R@30: 0.2314, P@30: 0.04797
valid 	 N@40: 0.1832, R@40: 0.2647, P@40: 0.04137
valid 	 N@50: 0.1915, R@50: 0.2922, P@50: 0.03671

6.425596769544532
2024-06-08 14:31:24,461 - [INFO] - current w_0 is 9.17942388767301
tensor([[18818,  6624],
        [10397, 33380],
        [ 4038,  8299],
        ...,
        [ 7920, 18127],
        [11343, 12340],
        [ 2960, 25798]], device='cuda:0')
2024-06-08 14:32:04,092 - [INFO] - E:31|TAU:6.549 17.93, train_time: 38.56, VALID_time: 1.045, loss: 7.348e+03, emb_loss:1.422e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1411, R@5: 0.09157, P@5: 0.1106
valid 	 N@10: 0.1437, R@10: 0.1337, P@10: 0.08127
valid 	 N@15: 0.1517, R@15: 0.1643, P@15: 0.06721
valid 	 N@20: 0.1597, R@20: 0.1899, P@20: 0.0586
valid 	 N@25: 0.1668, R@25: 0.2123, P@25: 0.05261
valid 	 N@30: 0.1729, R@30: 0.2315, P@30: 0.04798
valid 	 N@40: 0.1832, R@40: 0.2645, P@40: 0.04135
valid 	 N@50: 0.1916, R@50: 0.2921, P@50: 0.03672

6.425596769544532
2024-06-08 14:32:04,121 - [INFO] - current w_0 is 9.17942388767301
tensor([[  578,  8093],
        [21024, 23205],
        [10419,   559],
        ...,
        [ 9169, 24369],
        [19862,  1973],
        [  220,  2405]], device='cuda:0')
2024-06-08 14:32:43,367 - [INFO] - E:32|TAU:6.532 17.39, train_time: 38.17, VALID_time: 1.052, loss: 7.347e+03, emb_loss:1.472e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1414, R@5: 0.09187, P@5: 0.1108
valid 	 N@10: 0.144, R@10: 0.1336, P@10: 0.08141
valid 	 N@15: 0.1519, R@15: 0.1643, P@15: 0.06717
valid 	 N@20: 0.1599, R@20: 0.19, P@20: 0.05862
valid 	 N@25: 0.1669, R@25: 0.2119, P@25: 0.05257
valid 	 N@30: 0.1731, R@30: 0.2314, P@30: 0.04798
valid 	 N@40: 0.1835, R@40: 0.2646, P@40: 0.04138
valid 	 N@50: 0.1918, R@50: 0.2921, P@50: 0.03672

6.425596769544532
2024-06-08 14:32:43,393 - [INFO] - current w_0 is 9.17942388767301
tensor([[12119, 22366],
        [10166, 12839],
        [ 3797,  1477],
        ...,
        [ 6818,  4661],
        [17047, 29168],
        [ 4254, 22990]], device='cuda:0')
2024-06-08 14:33:22,564 - [INFO] - E:33|TAU:6.531 17.66, train_time: 38.09, VALID_time: 1.056, loss: 7.347e+03, emb_loss:1.522e-05, nce_loss:15.03, best_valid(recall@20): 0.1908
valid 	 N@5: 0.1413, R@5: 0.09172, P@5: 0.1107
valid 	 N@10: 0.1437, R@10: 0.1335, P@10: 0.08121
valid 	 N@15: 0.1518, R@15: 0.1643, P@15: 0.06727
valid 	 N@20: 0.1597, R@20: 0.19, P@20: 0.05859
valid 	 N@25: 0.1667, R@25: 0.2118, P@25: 0.05252
valid 	 N@30: 0.173, R@30: 0.2317, P@30: 0.04801
valid 	 N@40: 0.1833, R@40: 0.2645, P@40: 0.04135
valid 	 N@50: 0.1917, R@50: 0.2922, P@50: 0.03674

6.425596769544532
2024-06-08 14:33:22,592 - [INFO] - current w_0 is 9.17942388767301
