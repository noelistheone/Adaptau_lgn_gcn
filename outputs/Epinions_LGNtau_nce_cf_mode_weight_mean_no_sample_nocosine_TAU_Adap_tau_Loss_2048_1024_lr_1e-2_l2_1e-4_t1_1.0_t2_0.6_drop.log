2024-04-25 16:51:24,491 - [INFO] - {'dataset': 'Epinions', 'data_path': './data/', 'name': 'Epinions_LGNtau_nce_cf_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-2_l2_1e-4_t1_1.0_t2_0.6_drop_25_04_2024_16:51:24', 'train_ratio': 0.8, 'gnn': 'lgntaucf', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 0.0001, 'lr': 0.01, 'mess_dropout': True, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-25 16:51:27,286 - [INFO] - load train.txt
2024-04-25 16:51:30,867 - [INFO] - building the adj mat ...
2024-04-25 16:51:31,113 - [INFO] - train set len is 356185
2024-04-25 16:51:31,113 - [INFO] - test set len is 152652
2024-04-25 16:51:31,113 - [INFO] - loading over ...
2024-04-25 16:51:31,113 - [INFO] - users are 75888 items are 75882
Adap_tau_Loss
start to make tables
2024-04-25 16:51:47,723 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-25 16:51:47,723 - [INFO] - start training ...
8.59217033394023
2024-04-25 16:51:47,753 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:52:38,129 - [INFO] - E:0|TAU:12.27 12.27, train_time: 48.43, VALID_time: 1.941, loss: 756.7, emb_loss:0.0001462, nce_loss:-0.1236, best_valid(recall@20): -inf
valid 	 N@5: 0.04297, R@5: 0.0405, P@5: 0.02796
valid 	 N@10: 0.04838, R@10: 0.05945, P@10: 0.02302
valid 	 N@15: 0.05194, R@15: 0.07185, P@15: 0.02007
valid 	 N@20: 0.05471, R@20: 0.08164, P@20: 0.01796
valid 	 N@25: 0.05688, R@25: 0.08925, P@25: 0.01634
valid 	 N@30: 0.05881, R@30: 0.09586, P@30: 0.01514
valid 	 N@40: 0.06214, R@40: 0.1076, P@40: 0.01335
valid 	 N@50: 0.06459, R@50: 0.1159, P@50: 0.01202

8.59217033394023
2024-04-25 16:52:38,252 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:53:27,995 - [INFO] - E:1|TAU:3.295 4.093, train_time: 47.92, VALID_time: 1.821, loss: -53.15, emb_loss:0.0006274, nce_loss:-0.09873, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03804, R@5: 0.03149, P@5: 0.02479
valid 	 N@10: 0.04031, R@10: 0.04557, P@10: 0.01921
valid 	 N@15: 0.04317, R@15: 0.05744, P@15: 0.01681
valid 	 N@20: 0.04535, R@20: 0.06624, P@20: 0.01503
valid 	 N@25: 0.04722, R@25: 0.07347, P@25: 0.01374
valid 	 N@30: 0.04902, R@30: 0.08048, P@30: 0.01275
valid 	 N@40: 0.05219, R@40: 0.0928, P@40: 0.01131
valid 	 N@50: 0.05491, R@50: 0.1032, P@50: 0.01035

8.59217033394023
2024-04-25 16:53:28,013 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:54:18,286 - [INFO] - E:2|TAU:3.331 4.621, train_time: 48.43, VALID_time: 1.837, loss: -503.3, emb_loss:0.001043, nce_loss:-1.901, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03584, R@5: 0.02864, P@5: 0.02386
valid 	 N@10: 0.03776, R@10: 0.04221, P@10: 0.0183
valid 	 N@15: 0.04037, R@15: 0.05326, P@15: 0.01605
valid 	 N@20: 0.04238, R@20: 0.06155, P@20: 0.01434
valid 	 N@25: 0.044, R@25: 0.06809, P@25: 0.01302
valid 	 N@30: 0.04567, R@30: 0.07461, P@30: 0.01209
valid 	 N@40: 0.04852, R@40: 0.08565, P@40: 0.01069
valid 	 N@50: 0.0511, R@50: 0.09569, P@50: 0.009773

8.59217033394023
2024-04-25 16:54:18,304 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:55:08,457 - [INFO] - E:3|TAU:3.376 4.901, train_time: 48.34, VALID_time: 1.809, loss: -584.6, emb_loss:0.001235, nce_loss:-2.25, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03462, R@5: 0.02757, P@5: 0.02259
valid 	 N@10: 0.03652, R@10: 0.04057, P@10: 0.01745
valid 	 N@15: 0.03913, R@15: 0.0515, P@15: 0.01539
valid 	 N@20: 0.04098, R@20: 0.05918, P@20: 0.01373
valid 	 N@25: 0.04264, R@25: 0.06581, P@25: 0.01249
valid 	 N@30: 0.04415, R@30: 0.07165, P@30: 0.01158
valid 	 N@40: 0.04713, R@40: 0.08331, P@40: 0.01033
valid 	 N@50: 0.04972, R@50: 0.09328, P@50: 0.009495

8.59217033394023
2024-04-25 16:55:08,475 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:55:58,194 - [INFO] - E:4|TAU:3.386 4.956, train_time: 47.82, VALID_time: 1.9, loss: -601.6, emb_loss:0.001414, nce_loss:-2.303, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03443, R@5: 0.02713, P@5: 0.02242
valid 	 N@10: 0.0364, R@10: 0.04025, P@10: 0.01736
valid 	 N@15: 0.03897, R@15: 0.0511, P@15: 0.01527
valid 	 N@20: 0.04069, R@20: 0.05839, P@20: 0.01352
valid 	 N@25: 0.04229, R@25: 0.06488, P@25: 0.01228
valid 	 N@30: 0.04386, R@30: 0.07082, P@30: 0.01145
valid 	 N@40: 0.04674, R@40: 0.08194, P@40: 0.01022
valid 	 N@50: 0.04934, R@50: 0.09207, P@50: 0.009394

8.59217033394023
2024-04-25 16:55:58,214 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:56:48,352 - [INFO] - E:5|TAU:3.385 4.956, train_time: 48.24, VALID_time: 1.891, loss: -606.6, emb_loss:0.001563, nce_loss:-2.312, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03441, R@5: 0.02735, P@5: 0.02244
valid 	 N@10: 0.03643, R@10: 0.0406, P@10: 0.01739
valid 	 N@15: 0.03874, R@15: 0.05065, P@15: 0.01515
valid 	 N@20: 0.04044, R@20: 0.05782, P@20: 0.01344
valid 	 N@25: 0.04206, R@25: 0.06434, P@25: 0.01224
valid 	 N@30: 0.04369, R@30: 0.07074, P@30: 0.01138
valid 	 N@40: 0.04657, R@40: 0.08171, P@40: 0.01019
valid 	 N@50: 0.04906, R@50: 0.09137, P@50: 0.00934

8.59217033394023
2024-04-25 16:56:48,370 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:57:38,525 - [INFO] - E:6|TAU:3.382 4.951, train_time: 48.35, VALID_time: 1.802, loss: -608.1, emb_loss:0.001704, nce_loss:-2.312, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03424, R@5: 0.02701, P@5: 0.02232
valid 	 N@10: 0.03625, R@10: 0.0402, P@10: 0.01734
valid 	 N@15: 0.03854, R@15: 0.05032, P@15: 0.01504
valid 	 N@20: 0.04036, R@20: 0.05783, P@20: 0.01342
valid 	 N@25: 0.04195, R@25: 0.06421, P@25: 0.0122
valid 	 N@30: 0.04349, R@30: 0.07022, P@30: 0.01133
valid 	 N@40: 0.04649, R@40: 0.08168, P@40: 0.01019
valid 	 N@50: 0.04897, R@50: 0.09138, P@50: 0.009329

8.59217033394023
2024-04-25 16:57:38,544 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:58:28,209 - [INFO] - E:7|TAU:3.385 4.945, train_time: 47.89, VALID_time: 1.77, loss: -608.0, emb_loss:0.001852, nce_loss:-2.306, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03443, R@5: 0.02734, P@5: 0.02242
valid 	 N@10: 0.03628, R@10: 0.04024, P@10: 0.01728
valid 	 N@15: 0.03859, R@15: 0.05035, P@15: 0.01503
valid 	 N@20: 0.04041, R@20: 0.05783, P@20: 0.01341
valid 	 N@25: 0.04204, R@25: 0.06444, P@25: 0.0122
valid 	 N@30: 0.04347, R@30: 0.06992, P@30: 0.01131
valid 	 N@40: 0.04648, R@40: 0.08141, P@40: 0.01018
valid 	 N@50: 0.04898, R@50: 0.09122, P@50: 0.009331

8.59217033394023
2024-04-25 16:58:28,227 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:59:18,510 - [INFO] - E:8|TAU:3.382 4.945, train_time: 48.42, VALID_time: 1.862, loss: -609.7, emb_loss:0.002009, nce_loss:-2.314, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03468, R@5: 0.0275, P@5: 0.02254
valid 	 N@10: 0.03649, R@10: 0.04032, P@10: 0.01735
valid 	 N@15: 0.03875, R@15: 0.05032, P@15: 0.01503
valid 	 N@20: 0.04054, R@20: 0.05765, P@20: 0.01342
valid 	 N@25: 0.04217, R@25: 0.06427, P@25: 0.01221
valid 	 N@30: 0.04369, R@30: 0.07017, P@30: 0.01132
valid 	 N@40: 0.04669, R@40: 0.0816, P@40: 0.01021
valid 	 N@50: 0.04906, R@50: 0.09079, P@50: 0.009323

8.59217033394023
2024-04-25 16:59:18,528 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 17:00:08,997 - [INFO] - E:9|TAU:3.382 4.942, train_time: 48.46, VALID_time: 2.006, loss: -609.7, emb_loss:0.00218, nce_loss:-2.311, best_valid(recall@20): 0.08164
valid 	 N@5: 0.03464, R@5: 0.02735, P@5: 0.0225
valid 	 N@10: 0.03654, R@10: 0.04034, P@10: 0.01738
valid 	 N@15: 0.03877, R@15: 0.05032, P@15: 0.01504
valid 	 N@20: 0.04056, R@20: 0.0577, P@20: 0.01341
valid 	 N@25: 0.04205, R@25: 0.06372, P@25: 0.01217
valid 	 N@30: 0.04358, R@30: 0.06964, P@30: 0.0113
valid 	 N@40: 0.04666, R@40: 0.08141, P@40: 0.01021
valid 	 N@50: 0.04905, R@50: 0.09067, P@50: 0.00933

8.59217033394023
2024-04-25 17:00:09,014 - [INFO] - current w_0 is 12.274529170852588
