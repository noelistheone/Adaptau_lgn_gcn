2024-04-28 11:14:04,002 - [INFO] - {'dataset': 'ml-1M', 'data_path': './data/', 'name': 'ml-1M_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-4_l2_1e-5_t1_1.0_t2_0.6_nodrop_28_04_2024_11:14:03', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.0001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-28 11:14:07,644 - [INFO] - load train.txt
2024-04-28 11:14:10,021 - [INFO] - building the adj mat ...
2024-04-28 11:14:10,267 - [INFO] - train set len is 460359
2024-04-28 11:14:10,267 - [INFO] - test set len is 114922
2024-04-28 11:14:10,267 - [INFO] - loading over ...
2024-04-28 11:14:10,267 - [INFO] - users are 6040 items are 3952
Adap_tau_Loss
start to make tables
2024-04-28 11:14:28,133 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-28 11:14:28,133 - [INFO] - start training ...
3.057064449281574
2024-04-28 11:14:28,171 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:14:47,966 - [INFO] - E:0|TAU:4.367 4.367, train_time: 19.37, VALID_time: 0.4203, loss: 1.731e+03, emb_loss:2.689e-07, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.0124, R@5: 0.003801, P@5: 0.01206
valid 	 N@10: 0.01231, R@10: 0.006285, P@10: 0.01122
valid 	 N@15: 0.01233, R@15: 0.008494, P@15: 0.01033
valid 	 N@20: 0.01284, R@20: 0.01084, P@20: 0.009993
valid 	 N@25: 0.01345, R@25: 0.01331, P@25: 0.009658
valid 	 N@30: 0.01407, R@30: 0.01552, P@30: 0.009401
valid 	 N@40: 0.0157, R@40: 0.02029, P@40: 0.009242
valid 	 N@50: 0.01749, R@50: 0.0252, P@50: 0.00918

3.057064449281574
2024-04-28 11:14:47,998 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:15:07,879 - [INFO] - E:1|TAU:3.88 5.576, train_time: 19.49, VALID_time: 0.3838, loss: 1.69e+03, emb_loss:2.774e-07, nce_loss:0.0, best_valid(recall@20): 0.01084
valid 	 N@5: 0.05178, R@5: 0.01616, P@5: 0.04812
valid 	 N@10: 0.04985, R@10: 0.0272, P@10: 0.04295
valid 	 N@15: 0.0502, R@15: 0.037, P@15: 0.03952
valid 	 N@20: 0.05136, R@20: 0.04522, P@20: 0.0368
valid 	 N@25: 0.05335, R@25: 0.05321, P@25: 0.0351
valid 	 N@30: 0.05525, R@30: 0.06016, P@30: 0.03347
valid 	 N@40: 0.05916, R@40: 0.07247, P@40: 0.03083
valid 	 N@50: 0.06319, R@50: 0.08388, P@50: 0.02891

3.057064449281574
2024-04-28 11:15:07,916 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:15:27,411 - [INFO] - E:2|TAU:3.792 8.201, train_time: 19.16, VALID_time: 0.3292, loss: 1.653e+03, emb_loss:2.915e-07, nce_loss:0.0, best_valid(recall@20): 0.04522
valid 	 N@5: 0.1035, R@5: 0.03411, P@5: 0.09558
valid 	 N@10: 0.09734, R@10: 0.05663, P@10: 0.08081
valid 	 N@15: 0.09754, R@15: 0.07556, P@15: 0.07284
valid 	 N@20: 0.09973, R@20: 0.09137, P@20: 0.06684
valid 	 N@25: 0.1027, R@25: 0.1048, P@25: 0.06232
valid 	 N@30: 0.1064, R@30: 0.1177, P@30: 0.05914
valid 	 N@40: 0.114, R@40: 0.1412, P@40: 0.05392
valid 	 N@50: 0.1212, R@50: 0.1616, P@50: 0.05005

3.057064449281574
2024-04-28 11:15:27,442 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:15:47,310 - [INFO] - E:3|TAU:3.649 11.47, train_time: 19.49, VALID_time: 0.3783, loss: 1.628e+03, emb_loss:3.064e-07, nce_loss:0.0, best_valid(recall@20): 0.09137
valid 	 N@5: 0.1446, R@5: 0.05018, P@5: 0.1337
valid 	 N@10: 0.1361, R@10: 0.08152, P@10: 0.1122
valid 	 N@15: 0.1362, R@15: 0.1071, P@15: 0.1005
valid 	 N@20: 0.1396, R@20: 0.1296, P@20: 0.09237
valid 	 N@25: 0.1436, R@25: 0.1485, P@25: 0.08564
valid 	 N@30: 0.148, R@30: 0.1654, P@30: 0.0802
valid 	 N@40: 0.1571, R@40: 0.1943, P@40: 0.07209
valid 	 N@50: 0.1665, R@50: 0.2214, P@50: 0.06645

3.057064449281574
2024-04-28 11:15:47,339 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:16:07,063 - [INFO] - E:4|TAU:3.532 11.72, train_time: 19.26, VALID_time: 0.462, loss: 1.608e+03, emb_loss:3.201e-07, nce_loss:0.0, best_valid(recall@20): 0.1296
valid 	 N@5: 0.1718, R@5: 0.05985, P@5: 0.1584
valid 	 N@10: 0.1628, R@10: 0.09801, P@10: 0.1345
valid 	 N@15: 0.1624, R@15: 0.1288, P@15: 0.1191
valid 	 N@20: 0.1658, R@20: 0.1541, P@20: 0.1089
valid 	 N@25: 0.1702, R@25: 0.1754, P@25: 0.1009
valid 	 N@30: 0.1756, R@30: 0.1958, P@30: 0.09483
valid 	 N@40: 0.1861, R@40: 0.2304, P@40: 0.08497
valid 	 N@50: 0.1965, R@50: 0.2612, P@50: 0.07778

3.057064449281574
2024-04-28 11:16:07,099 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:16:27,062 - [INFO] - E:5|TAU:3.46 11.85, train_time: 19.52, VALID_time: 0.4373, loss: 1.593e+03, emb_loss:3.323e-07, nce_loss:0.0, best_valid(recall@20): 0.1541
valid 	 N@5: 0.1903, R@5: 0.067, P@5: 0.1762
valid 	 N@10: 0.1804, R@10: 0.1094, P@10: 0.1489
valid 	 N@15: 0.18, R@15: 0.1423, P@15: 0.132
valid 	 N@20: 0.1834, R@20: 0.1703, P@20: 0.12
valid 	 N@25: 0.1885, R@25: 0.1944, P@25: 0.1113
valid 	 N@30: 0.1941, R@30: 0.2163, P@30: 0.1043
valid 	 N@40: 0.2053, R@40: 0.2538, P@40: 0.09328
valid 	 N@50: 0.2165, R@50: 0.2865, P@50: 0.08542

3.057064449281574
2024-04-28 11:16:27,128 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:16:46,992 - [INFO] - E:6|TAU:3.406 11.69, train_time: 19.43, VALID_time: 0.4353, loss: 1.58e+03, emb_loss:3.431e-07, nce_loss:0.0, best_valid(recall@20): 0.1703
valid 	 N@5: 0.203, R@5: 0.07151, P@5: 0.1871
valid 	 N@10: 0.1931, R@10: 0.1174, P@10: 0.1587
valid 	 N@15: 0.1922, R@15: 0.1516, P@15: 0.14
valid 	 N@20: 0.1964, R@20: 0.1824, P@20: 0.1281
valid 	 N@25: 0.2018, R@25: 0.2083, P@25: 0.1188
valid 	 N@30: 0.2073, R@30: 0.2303, P@30: 0.1109
valid 	 N@40: 0.2192, R@40: 0.2694, P@40: 0.0995
valid 	 N@50: 0.2306, R@50: 0.3036, P@50: 0.09071

3.057064449281574
2024-04-28 11:16:47,028 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:17:06,619 - [INFO] - E:7|TAU:3.372 11.17, train_time: 19.14, VALID_time: 0.4467, loss: 1.571e+03, emb_loss:3.53e-07, nce_loss:0.0, best_valid(recall@20): 0.1824
valid 	 N@5: 0.2123, R@5: 0.07503, P@5: 0.1948
valid 	 N@10: 0.2017, R@10: 0.1221, P@10: 0.1648
valid 	 N@15: 0.2011, R@15: 0.1583, P@15: 0.1459
valid 	 N@20: 0.2054, R@20: 0.1897, P@20: 0.1336
valid 	 N@25: 0.2108, R@25: 0.2166, P@25: 0.1238
valid 	 N@30: 0.2167, R@30: 0.2398, P@30: 0.1159
valid 	 N@40: 0.2291, R@40: 0.2811, P@40: 0.1037
valid 	 N@50: 0.2407, R@50: 0.3163, P@50: 0.0945

3.057064449281574
2024-04-28 11:17:06,656 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:17:26,567 - [INFO] - E:8|TAU:3.347 10.81, train_time: 19.5, VALID_time: 0.4116, loss: 1.563e+03, emb_loss:3.619e-07, nce_loss:0.0, best_valid(recall@20): 0.1897
valid 	 N@5: 0.2202, R@5: 0.07803, P@5: 0.2019
valid 	 N@10: 0.2082, R@10: 0.1252, P@10: 0.17
valid 	 N@15: 0.208, R@15: 0.1636, P@15: 0.1508
valid 	 N@20: 0.2122, R@20: 0.1957, P@20: 0.1378
valid 	 N@25: 0.2185, R@25: 0.2246, P@25: 0.1284
valid 	 N@30: 0.2243, R@30: 0.2483, P@30: 0.1198
valid 	 N@40: 0.2369, R@40: 0.2904, P@40: 0.1073
valid 	 N@50: 0.2487, R@50: 0.3266, P@50: 0.09763

3.057064449281574
2024-04-28 11:17:26,601 - [INFO] - current w_0 is 4.36723435193187
2024-04-28 11:17:44,696 - [INFO] - E:9|TAU:3.33 10.31, train_time: 17.75, VALID_time: 0.3378, loss: 1.556e+03, emb_loss:3.701e-07, nce_loss:0.0, best_valid(recall@20): 0.1957
valid 	 N@5: 0.2257, R@5: 0.08019, P@5: 0.2067
valid 	 N@10: 0.2139, R@10: 0.1295, P@10: 0.1746
valid 	 N@15: 0.2131, R@15: 0.1672, P@15: 0.1543
valid 	 N@20: 0.2175, R@20: 0.2002, P@20: 0.1412
valid 	 N@25: 0.2232, R@25: 0.2288, P@25: 0.1308
valid 	 N@30: 0.2297, R@30: 0.2541, P@30: 0.1227
valid 	 N@40: 0.2423, R@40: 0.2966, P@40: 0.1096
valid 	 N@50: 0.2544, R@50: 0.3332, P@50: 0.1

3.057064449281574
2024-04-28 11:17:44,729 - [INFO] - current w_0 is 4.36723435193187
