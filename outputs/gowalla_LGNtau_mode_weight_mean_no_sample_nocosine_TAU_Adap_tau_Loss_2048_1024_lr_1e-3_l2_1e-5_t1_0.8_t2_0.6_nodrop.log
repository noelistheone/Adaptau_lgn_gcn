2024-06-01 00:09:28,734 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_01_06_2024_00:09:28', 'train_ratio': 0.8, 'gnn': 'lgntau', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-01 00:09:30,855 - [INFO] - load train.txt
2024-06-01 00:09:35,085 - [INFO] - building the adj mat ...
2024-06-01 00:09:35,700 - [INFO] - train set len is 810128
2024-06-01 00:09:35,700 - [INFO] - test set len is 217242
2024-06-01 00:09:35,700 - [INFO] - loading over ...
2024-06-01 00:09:35,701 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-01 00:09:57,625 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-01 00:09:57,625 - [INFO] - start training ...
6.425596769544532
2024-06-01 00:09:57,665 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:11:05,175 - [INFO] - E:0|TAU:9.179 9.179, train_time: 65.84, VALID_time: 1.67, loss: 1.145e+04, emb_loss:2.941e-07, nce_loss:24.33, best_valid(recall@20): -inf
valid 	 N@5: 0.1222, R@5: 0.07956, P@5: 0.09626
valid 	 N@10: 0.1242, R@10: 0.1155, P@10: 0.07061
valid 	 N@15: 0.1316, R@15: 0.1432, P@15: 0.05853
valid 	 N@20: 0.1386, R@20: 0.1661, P@20: 0.05102
valid 	 N@25: 0.145, R@25: 0.186, P@25: 0.04584
valid 	 N@30: 0.1506, R@30: 0.2037, P@30: 0.04194
valid 	 N@40: 0.1601, R@40: 0.2343, P@40: 0.03634
valid 	 N@50: 0.1681, R@50: 0.2606, P@50: 0.03246

6.425596769544532
2024-06-01 00:11:05,226 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:12:13,258 - [INFO] - E:1|TAU:6.2 24.95, train_time: 66.44, VALID_time: 1.586, loss: 1.138e+04, emb_loss:5.892e-07, nce_loss:24.33, best_valid(recall@20): 0.1661
valid 	 N@5: 0.1232, R@5: 0.07891, P@5: 0.09652
valid 	 N@10: 0.1249, R@10: 0.1149, P@10: 0.07102
valid 	 N@15: 0.1323, R@15: 0.1432, P@15: 0.05907
valid 	 N@20: 0.139, R@20: 0.1653, P@20: 0.05141
valid 	 N@25: 0.145, R@25: 0.1844, P@25: 0.04601
valid 	 N@30: 0.1502, R@30: 0.2009, P@30: 0.04196
valid 	 N@40: 0.159, R@40: 0.2291, P@40: 0.03614
valid 	 N@50: 0.1664, R@50: 0.2534, P@50: 0.03215

6.425596769544532
2024-06-01 00:12:13,287 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:13:21,364 - [INFO] - E:2|TAU:6.504 23.73, train_time: 66.44, VALID_time: 1.627, loss: 1.117e+04, emb_loss:8.901e-07, nce_loss:24.32, best_valid(recall@20): 0.1661
valid 	 N@5: 0.1304, R@5: 0.0843, P@5: 0.1024
valid 	 N@10: 0.132, R@10: 0.1218, P@10: 0.07484
valid 	 N@15: 0.1395, R@15: 0.1507, P@15: 0.06212
valid 	 N@20: 0.1468, R@20: 0.1746, P@20: 0.05413
valid 	 N@25: 0.1534, R@25: 0.1955, P@25: 0.04861
valid 	 N@30: 0.1591, R@30: 0.2131, P@30: 0.04437
valid 	 N@40: 0.1688, R@40: 0.2444, P@40: 0.03836
valid 	 N@50: 0.177, R@50: 0.2712, P@50: 0.03421

6.425596769544532
2024-06-01 00:13:21,434 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:14:29,495 - [INFO] - E:3|TAU:6.483 24.7, train_time: 66.46, VALID_time: 1.599, loss: 1.114e+04, emb_loss:1.149e-06, nce_loss:24.32, best_valid(recall@20): 0.1746
valid 	 N@5: 0.1322, R@5: 0.08536, P@5: 0.104
valid 	 N@10: 0.1344, R@10: 0.1249, P@10: 0.07636
valid 	 N@15: 0.1423, R@15: 0.1549, P@15: 0.06342
valid 	 N@20: 0.1499, R@20: 0.1794, P@20: 0.05536
valid 	 N@25: 0.1566, R@25: 0.2006, P@25: 0.04969
valid 	 N@30: 0.1627, R@30: 0.2199, P@30: 0.04548
valid 	 N@40: 0.1726, R@40: 0.2515, P@40: 0.03922
valid 	 N@50: 0.1807, R@50: 0.2783, P@50: 0.03489

6.425596769544532
2024-06-01 00:14:29,569 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:15:37,925 - [INFO] - E:4|TAU:6.471 22.57, train_time: 66.71, VALID_time: 1.643, loss: 1.112e+04, emb_loss:1.409e-06, nce_loss:24.32, best_valid(recall@20): 0.1794
valid 	 N@5: 0.1344, R@5: 0.0868, P@5: 0.1053
valid 	 N@10: 0.1368, R@10: 0.1268, P@10: 0.07742
valid 	 N@15: 0.1446, R@15: 0.1568, P@15: 0.06415
valid 	 N@20: 0.1524, R@20: 0.1819, P@20: 0.0561
valid 	 N@25: 0.1593, R@25: 0.2036, P@25: 0.05036
valid 	 N@30: 0.1654, R@30: 0.2227, P@30: 0.04603
valid 	 N@40: 0.1753, R@40: 0.2545, P@40: 0.03963
valid 	 N@50: 0.1835, R@50: 0.2816, P@50: 0.03526

6.425596769544532
2024-06-01 00:15:37,997 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:16:46,685 - [INFO] - E:5|TAU:6.492 20.11, train_time: 66.92, VALID_time: 1.765, loss: 1.11e+04, emb_loss:1.682e-06, nce_loss:24.32, best_valid(recall@20): 0.1819
valid 	 N@5: 0.1354, R@5: 0.08767, P@5: 0.1064
valid 	 N@10: 0.1377, R@10: 0.1281, P@10: 0.07813
valid 	 N@15: 0.1454, R@15: 0.1576, P@15: 0.06449
valid 	 N@20: 0.1531, R@20: 0.1827, P@20: 0.05633
valid 	 N@25: 0.1602, R@25: 0.205, P@25: 0.05055
valid 	 N@30: 0.1663, R@30: 0.2242, P@30: 0.04625
valid 	 N@40: 0.1764, R@40: 0.2563, P@40: 0.03994
valid 	 N@50: 0.1846, R@50: 0.2836, P@50: 0.03548

6.425596769544532
2024-06-01 00:16:46,760 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:17:55,102 - [INFO] - E:6|TAU:6.491 19.17, train_time: 66.72, VALID_time: 1.618, loss: 1.109e+04, emb_loss:1.971e-06, nce_loss:24.31, best_valid(recall@20): 0.1827
valid 	 N@5: 0.1361, R@5: 0.08838, P@5: 0.1068
valid 	 N@10: 0.1382, R@10: 0.1283, P@10: 0.07819
valid 	 N@15: 0.1459, R@15: 0.158, P@15: 0.06461
valid 	 N@20: 0.154, R@20: 0.1838, P@20: 0.05659
valid 	 N@25: 0.1607, R@25: 0.205, P@25: 0.05062
valid 	 N@30: 0.1669, R@30: 0.2247, P@30: 0.04637
valid 	 N@40: 0.1771, R@40: 0.2571, P@40: 0.04002
valid 	 N@50: 0.1852, R@50: 0.2839, P@50: 0.03555

6.425596769544532
2024-06-01 00:17:55,174 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:19:03,629 - [INFO] - E:7|TAU:6.504 20.04, train_time: 66.78, VALID_time: 1.671, loss: 1.109e+04, emb_loss:2.272e-06, nce_loss:24.31, best_valid(recall@20): 0.1838
valid 	 N@5: 0.1362, R@5: 0.08817, P@5: 0.1067
valid 	 N@10: 0.1387, R@10: 0.1289, P@10: 0.07854
valid 	 N@15: 0.1466, R@15: 0.159, P@15: 0.06502
valid 	 N@20: 0.1544, R@20: 0.1841, P@20: 0.05675
valid 	 N@25: 0.1613, R@25: 0.206, P@25: 0.05096
valid 	 N@30: 0.1675, R@30: 0.2254, P@30: 0.04655
valid 	 N@40: 0.1777, R@40: 0.2581, P@40: 0.04019
valid 	 N@50: 0.186, R@50: 0.2854, P@50: 0.03574

6.425596769544532
2024-06-01 00:19:03,703 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:20:12,346 - [INFO] - E:8|TAU:6.495 18.94, train_time: 66.9, VALID_time: 1.741, loss: 1.108e+04, emb_loss:2.587e-06, nce_loss:24.31, best_valid(recall@20): 0.1841
valid 	 N@5: 0.1366, R@5: 0.08849, P@5: 0.1072
valid 	 N@10: 0.1391, R@10: 0.1293, P@10: 0.07883
valid 	 N@15: 0.1471, R@15: 0.1599, P@15: 0.06533
valid 	 N@20: 0.1549, R@20: 0.1853, P@20: 0.05694
valid 	 N@25: 0.1618, R@25: 0.2069, P@25: 0.05117
valid 	 N@30: 0.1681, R@30: 0.2266, P@30: 0.04678
valid 	 N@40: 0.1781, R@40: 0.2587, P@40: 0.04034
valid 	 N@50: 0.1864, R@50: 0.2859, P@50: 0.03586

6.425596769544532
2024-06-01 00:20:12,414 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:21:21,010 - [INFO] - E:9|TAU:6.5 18.55, train_time: 66.88, VALID_time: 1.707, loss: 1.107e+04, emb_loss:2.919e-06, nce_loss:24.31, best_valid(recall@20): 0.1853
valid 	 N@5: 0.1369, R@5: 0.08884, P@5: 0.1075
valid 	 N@10: 0.1392, R@10: 0.1292, P@10: 0.0788
valid 	 N@15: 0.1474, R@15: 0.16, P@15: 0.06539
valid 	 N@20: 0.1555, R@20: 0.1859, P@20: 0.05722
valid 	 N@25: 0.1624, R@25: 0.2078, P@25: 0.05128
valid 	 N@30: 0.1685, R@30: 0.227, P@30: 0.04686
valid 	 N@40: 0.1786, R@40: 0.2592, P@40: 0.04038
valid 	 N@50: 0.1869, R@50: 0.2865, P@50: 0.03591

6.425596769544532
2024-06-01 00:21:21,082 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:22:29,935 - [INFO] - E:10|TAU:6.494 18.9, train_time: 66.98, VALID_time: 1.865, loss: 1.107e+04, emb_loss:3.263e-06, nce_loss:24.31, best_valid(recall@20): 0.1859
valid 	 N@5: 0.1375, R@5: 0.08917, P@5: 0.1079
valid 	 N@10: 0.14, R@10: 0.1302, P@10: 0.07925
valid 	 N@15: 0.1481, R@15: 0.1608, P@15: 0.06576
valid 	 N@20: 0.1558, R@20: 0.186, P@20: 0.05728
valid 	 N@25: 0.1628, R@25: 0.2079, P@25: 0.05137
valid 	 N@30: 0.1689, R@30: 0.2271, P@30: 0.04688
valid 	 N@40: 0.1793, R@40: 0.2606, P@40: 0.04058
valid 	 N@50: 0.1875, R@50: 0.2874, P@50: 0.03606

6.425596769544532
2024-06-01 00:22:30,007 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:23:38,498 - [INFO] - E:11|TAU:6.501 18.32, train_time: 66.78, VALID_time: 1.707, loss: 1.107e+04, emb_loss:3.621e-06, nce_loss:24.31, best_valid(recall@20): 0.186
valid 	 N@5: 0.1375, R@5: 0.08946, P@5: 0.108
valid 	 N@10: 0.14, R@10: 0.1304, P@10: 0.07936
valid 	 N@15: 0.1482, R@15: 0.161, P@15: 0.06581
valid 	 N@20: 0.156, R@20: 0.1863, P@20: 0.05742
valid 	 N@25: 0.1629, R@25: 0.2081, P@25: 0.05144
valid 	 N@30: 0.1691, R@30: 0.2275, P@30: 0.04698
valid 	 N@40: 0.1794, R@40: 0.2605, P@40: 0.04058
valid 	 N@50: 0.1877, R@50: 0.2878, P@50: 0.0361

6.425596769544532
2024-06-01 00:23:38,561 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:24:47,003 - [INFO] - E:12|TAU:6.503 18.53, train_time: 66.84, VALID_time: 1.597, loss: 1.106e+04, emb_loss:3.992e-06, nce_loss:24.31, best_valid(recall@20): 0.1863
valid 	 N@5: 0.1378, R@5: 0.08939, P@5: 0.1082
valid 	 N@10: 0.1403, R@10: 0.1303, P@10: 0.07949
valid 	 N@15: 0.1485, R@15: 0.1612, P@15: 0.06592
valid 	 N@20: 0.1562, R@20: 0.1863, P@20: 0.0574
valid 	 N@25: 0.1634, R@25: 0.2089, P@25: 0.05159
valid 	 N@30: 0.1693, R@30: 0.2275, P@30: 0.04703
valid 	 N@40: 0.1797, R@40: 0.261, P@40: 0.04064
valid 	 N@50: 0.188, R@50: 0.2879, P@50: 0.03612

6.425596769544532
2024-06-01 00:24:47,034 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:25:55,675 - [INFO] - E:13|TAU:6.497 18.64, train_time: 66.89, VALID_time: 1.745, loss: 1.106e+04, emb_loss:4.377e-06, nce_loss:24.31, best_valid(recall@20): 0.1863
valid 	 N@5: 0.1378, R@5: 0.08966, P@5: 0.1084
valid 	 N@10: 0.1404, R@10: 0.1307, P@10: 0.07972
valid 	 N@15: 0.1484, R@15: 0.1614, P@15: 0.06595
valid 	 N@20: 0.1564, R@20: 0.1871, P@20: 0.05769
valid 	 N@25: 0.1633, R@25: 0.2089, P@25: 0.0517
valid 	 N@30: 0.1693, R@30: 0.2279, P@30: 0.0471
valid 	 N@40: 0.1797, R@40: 0.2609, P@40: 0.04072
valid 	 N@50: 0.188, R@50: 0.2883, P@50: 0.03617

6.425596769544532
2024-06-01 00:25:55,755 - [INFO] - current w_0 is 9.17942388767301
2024-06-01 00:27:04,458 - [INFO] - E:14|TAU:6.509 18.3, train_time: 66.91, VALID_time: 1.786, loss: 1.106e+04, emb_loss:4.772e-06, nce_loss:24.31, best_valid(recall@20): 0.1871
valid 	 N@5: 0.1377, R@5: 0.08961, P@5: 0.1082
valid 	 N@10: 0.1405, R@10: 0.1309, P@10: 0.07979
valid 	 N@15: 0.1487, R@15: 0.1619, P@15: 0.0662
valid 	 N@20: 0.1566, R@20: 0.1875, P@20: 0.05772
valid 	 N@25: 0.1636, R@25: 0.2094, P@25: 0.05175
valid 	 N@30: 0.1695, R@30: 0.2281, P@30: 0.04714
valid 	 N@40: 0.18, R@40: 0.2615, P@40: 0.04078
valid 	 N@50: 0.1882, R@50: 0.2883, P@50: 0.03622

6.425596769544532
2024-06-01 00:27:04,517 - [INFO] - current w_0 is 9.17942388767301
