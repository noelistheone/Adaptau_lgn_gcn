2024-06-06 17:22:44,261 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_06_06_2024_17:22:44', 'train_ratio': 0.8, 'gnn': 'lgntau', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-06 17:22:46,492 - [INFO] - load train.txt
2024-06-06 17:22:50,809 - [INFO] - building the adj mat ...
2024-06-06 17:22:51,451 - [INFO] - train set len is 810128
2024-06-06 17:22:51,451 - [INFO] - test set len is 217242
2024-06-06 17:22:51,451 - [INFO] - loading over ...
2024-06-06 17:22:51,451 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-06 17:23:09,048 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-06 17:23:09,048 - [INFO] - start training ...
6.425596769544532
2024-06-06 17:23:09,085 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:24:20,276 - [INFO] - E:0|TAU:9.179 9.179, train_time: 69.8, VALID_time: 1.388, loss: 6.13e+03, emb_loss:2.846e-07, nce_loss:10.91, best_valid(recall@20): -inf
valid 	 N@5: 0.1246, R@5: 0.08068, P@5: 0.09792
valid 	 N@10: 0.1265, R@10: 0.1172, P@10: 0.07183
valid 	 N@15: 0.1339, R@15: 0.1453, P@15: 0.05955
valid 	 N@20: 0.1409, R@20: 0.1682, P@20: 0.05181
valid 	 N@25: 0.1474, R@25: 0.1887, P@25: 0.04657
valid 	 N@30: 0.1531, R@30: 0.2066, P@30: 0.04262
valid 	 N@40: 0.1626, R@40: 0.2373, P@40: 0.03686
valid 	 N@50: 0.1707, R@50: 0.2641, P@50: 0.03294

6.425596769544532
2024-06-06 17:24:20,328 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:25:31,709 - [INFO] - E:1|TAU:6.246 24.95, train_time: 70.05, VALID_time: 1.329, loss: 6.053e+03, emb_loss:5.765e-07, nce_loss:10.9, best_valid(recall@20): 0.1682
valid 	 N@5: 0.1238, R@5: 0.07892, P@5: 0.09688
valid 	 N@10: 0.1257, R@10: 0.1156, P@10: 0.07157
valid 	 N@15: 0.1324, R@15: 0.1425, P@15: 0.05912
valid 	 N@20: 0.1394, R@20: 0.1654, P@20: 0.05165
valid 	 N@25: 0.1454, R@25: 0.1846, P@25: 0.04621
valid 	 N@30: 0.1508, R@30: 0.2014, P@30: 0.04223
valid 	 N@40: 0.1595, R@40: 0.2295, P@40: 0.03634
valid 	 N@50: 0.1669, R@50: 0.2536, P@50: 0.03231

6.425596769544532
2024-06-06 17:25:31,736 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:26:43,489 - [INFO] - E:2|TAU:6.542 23.55, train_time: 70.06, VALID_time: 1.693, loss: 5.845e+03, emb_loss:8.758e-07, nce_loss:10.9, best_valid(recall@20): 0.1682
valid 	 N@5: 0.1324, R@5: 0.08533, P@5: 0.1038
valid 	 N@10: 0.1341, R@10: 0.1236, P@10: 0.07607
valid 	 N@15: 0.1415, R@15: 0.1522, P@15: 0.06296
valid 	 N@20: 0.1489, R@20: 0.1766, P@20: 0.05493
valid 	 N@25: 0.1554, R@25: 0.1971, P@25: 0.04926
valid 	 N@30: 0.1612, R@30: 0.2154, P@30: 0.04499
valid 	 N@40: 0.1712, R@40: 0.2473, P@40: 0.03895
valid 	 N@50: 0.1794, R@50: 0.2744, P@50: 0.03469

6.425596769544532
2024-06-06 17:26:43,567 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:27:54,449 - [INFO] - E:3|TAU:6.512 24.84, train_time: 69.52, VALID_time: 1.362, loss: 5.822e+03, emb_loss:1.134e-06, nce_loss:10.9, best_valid(recall@20): 0.1766
valid 	 N@5: 0.1342, R@5: 0.08655, P@5: 0.1053
valid 	 N@10: 0.1363, R@10: 0.1263, P@10: 0.07732
valid 	 N@15: 0.1443, R@15: 0.1566, P@15: 0.06425
valid 	 N@20: 0.1518, R@20: 0.1809, P@20: 0.056
valid 	 N@25: 0.1586, R@25: 0.2024, P@25: 0.05027
valid 	 N@30: 0.1645, R@30: 0.221, P@30: 0.04591
valid 	 N@40: 0.1746, R@40: 0.2537, P@40: 0.03965
valid 	 N@50: 0.1829, R@50: 0.2808, P@50: 0.03528

6.425596769544532
2024-06-06 17:27:54,517 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:29:06,109 - [INFO] - E:4|TAU:6.5 22.61, train_time: 70.25, VALID_time: 1.343, loss: 5.799e+03, emb_loss:1.399e-06, nce_loss:10.9, best_valid(recall@20): 0.1809
valid 	 N@5: 0.1359, R@5: 0.08782, P@5: 0.1064
valid 	 N@10: 0.1383, R@10: 0.1281, P@10: 0.07818
valid 	 N@15: 0.1464, R@15: 0.1586, P@15: 0.06501
valid 	 N@20: 0.1541, R@20: 0.1837, P@20: 0.05677
valid 	 N@25: 0.1609, R@25: 0.2051, P@25: 0.05087
valid 	 N@30: 0.1668, R@30: 0.224, P@30: 0.04638
valid 	 N@40: 0.1772, R@40: 0.2571, P@40: 0.04016
valid 	 N@50: 0.1854, R@50: 0.2845, P@50: 0.03569

6.425596769544532
2024-06-06 17:29:06,182 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:30:17,673 - [INFO] - E:5|TAU:6.519 20.4, train_time: 70.08, VALID_time: 1.408, loss: 5.786e+03, emb_loss:1.677e-06, nce_loss:10.9, best_valid(recall@20): 0.1837
valid 	 N@5: 0.1366, R@5: 0.08861, P@5: 0.1072
valid 	 N@10: 0.1391, R@10: 0.1294, P@10: 0.07888
valid 	 N@15: 0.1469, R@15: 0.1593, P@15: 0.06523
valid 	 N@20: 0.1547, R@20: 0.1848, P@20: 0.05699
valid 	 N@25: 0.1616, R@25: 0.2065, P@25: 0.05118
valid 	 N@30: 0.1677, R@30: 0.2256, P@30: 0.0467
valid 	 N@40: 0.178, R@40: 0.2586, P@40: 0.04037
valid 	 N@50: 0.1863, R@50: 0.286, P@50: 0.0359

6.425596769544532
2024-06-06 17:30:17,743 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:31:29,286 - [INFO] - E:6|TAU:6.518 19.69, train_time: 70.19, VALID_time: 1.352, loss: 5.775e+03, emb_loss:1.974e-06, nce_loss:10.89, best_valid(recall@20): 0.1848
valid 	 N@5: 0.1374, R@5: 0.08923, P@5: 0.1075
valid 	 N@10: 0.1397, R@10: 0.1296, P@10: 0.07892
valid 	 N@15: 0.1475, R@15: 0.1597, P@15: 0.06531
valid 	 N@20: 0.1554, R@20: 0.185, P@20: 0.05705
valid 	 N@25: 0.1624, R@25: 0.207, P@25: 0.05128
valid 	 N@30: 0.1685, R@30: 0.2263, P@30: 0.04679
valid 	 N@40: 0.1787, R@40: 0.2589, P@40: 0.0404
valid 	 N@50: 0.187, R@50: 0.2863, P@50: 0.03595

6.425596769544532
2024-06-06 17:31:29,350 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:32:41,261 - [INFO] - E:7|TAU:6.528 20.09, train_time: 70.34, VALID_time: 1.571, loss: 5.769e+03, emb_loss:2.284e-06, nce_loss:10.89, best_valid(recall@20): 0.185
valid 	 N@5: 0.1371, R@5: 0.08912, P@5: 0.1074
valid 	 N@10: 0.1396, R@10: 0.1296, P@10: 0.07901
valid 	 N@15: 0.1477, R@15: 0.1604, P@15: 0.06559
valid 	 N@20: 0.1554, R@20: 0.1854, P@20: 0.05716
valid 	 N@25: 0.1627, R@25: 0.208, P@25: 0.05149
valid 	 N@30: 0.1689, R@30: 0.2278, P@30: 0.04709
valid 	 N@40: 0.179, R@40: 0.2601, P@40: 0.04058
valid 	 N@50: 0.1876, R@50: 0.2884, P@50: 0.0362

6.425596769544532
2024-06-06 17:32:41,337 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:33:53,085 - [INFO] - E:8|TAU:6.52 19.21, train_time: 70.49, VALID_time: 1.256, loss: 5.763e+03, emb_loss:2.611e-06, nce_loss:10.89, best_valid(recall@20): 0.1854
valid 	 N@5: 0.1374, R@5: 0.08918, P@5: 0.1077
valid 	 N@10: 0.1401, R@10: 0.1303, P@10: 0.07939
valid 	 N@15: 0.148, R@15: 0.1607, P@15: 0.06573
valid 	 N@20: 0.156, R@20: 0.1863, P@20: 0.05741
valid 	 N@25: 0.1631, R@25: 0.2088, P@25: 0.05161
valid 	 N@30: 0.1694, R@30: 0.2283, P@30: 0.04723
valid 	 N@40: 0.1795, R@40: 0.2607, P@40: 0.04072
valid 	 N@50: 0.1879, R@50: 0.2883, P@50: 0.03623

6.425596769544532
2024-06-06 17:33:53,163 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:35:09,763 - [INFO] - E:9|TAU:6.524 18.95, train_time: 75.16, VALID_time: 1.442, loss: 5.759e+03, emb_loss:2.956e-06, nce_loss:10.89, best_valid(recall@20): 0.1863
valid 	 N@5: 0.1379, R@5: 0.08969, P@5: 0.1082
valid 	 N@10: 0.1403, R@10: 0.1304, P@10: 0.07933
valid 	 N@15: 0.1484, R@15: 0.1612, P@15: 0.06582
valid 	 N@20: 0.1566, R@20: 0.1875, P@20: 0.05767
valid 	 N@25: 0.1636, R@25: 0.2093, P@25: 0.0518
valid 	 N@30: 0.1697, R@30: 0.2286, P@30: 0.04722
valid 	 N@40: 0.1799, R@40: 0.2613, P@40: 0.0408
valid 	 N@50: 0.1884, R@50: 0.2893, P@50: 0.03633

6.425596769544532
2024-06-06 17:35:09,830 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:35:49,252 - [INFO] - E:10|TAU:6.517 19.13, train_time: 38.3, VALID_time: 1.116, loss: 5.755e+03, emb_loss:3.317e-06, nce_loss:10.89, best_valid(recall@20): 0.1875
valid 	 N@5: 0.1382, R@5: 0.09008, P@5: 0.1084
valid 	 N@10: 0.1406, R@10: 0.1306, P@10: 0.07966
valid 	 N@15: 0.1489, R@15: 0.162, P@15: 0.0661
valid 	 N@20: 0.1567, R@20: 0.1871, P@20: 0.05763
valid 	 N@25: 0.1636, R@25: 0.209, P@25: 0.05172
valid 	 N@30: 0.1699, R@30: 0.2288, P@30: 0.04731
valid 	 N@40: 0.1803, R@40: 0.2619, P@40: 0.04088
valid 	 N@50: 0.1889, R@50: 0.2902, P@50: 0.03642

6.425596769544532
2024-06-06 17:35:49,288 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:36:28,310 - [INFO] - E:11|TAU:6.524 18.67, train_time: 37.89, VALID_time: 1.128, loss: 5.751e+03, emb_loss:3.693e-06, nce_loss:10.89, best_valid(recall@20): 0.1875
valid 	 N@5: 0.1379, R@5: 0.08963, P@5: 0.1081
valid 	 N@10: 0.1405, R@10: 0.1306, P@10: 0.07948
valid 	 N@15: 0.1489, R@15: 0.1619, P@15: 0.06616
valid 	 N@20: 0.1567, R@20: 0.1873, P@20: 0.05769
valid 	 N@25: 0.1638, R@25: 0.2096, P@25: 0.05183
valid 	 N@30: 0.17, R@30: 0.2289, P@30: 0.04738
valid 	 N@40: 0.1801, R@40: 0.2614, P@40: 0.04084
valid 	 N@50: 0.1889, R@50: 0.2903, P@50: 0.03643

6.425596769544532
2024-06-06 17:36:28,341 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:37:06,713 - [INFO] - E:12|TAU:6.527 18.67, train_time: 37.24, VALID_time: 1.129, loss: 5.748e+03, emb_loss:4.084e-06, nce_loss:10.89, best_valid(recall@20): 0.1875
valid 	 N@5: 0.1382, R@5: 0.0894, P@5: 0.1083
valid 	 N@10: 0.1406, R@10: 0.1303, P@10: 0.07947
valid 	 N@15: 0.1493, R@15: 0.1624, P@15: 0.06633
valid 	 N@20: 0.157, R@20: 0.1875, P@20: 0.05773
valid 	 N@25: 0.1642, R@25: 0.21, P@25: 0.05194
valid 	 N@30: 0.1704, R@30: 0.2294, P@30: 0.04745
valid 	 N@40: 0.1807, R@40: 0.2625, P@40: 0.04096
valid 	 N@50: 0.189, R@50: 0.29, P@50: 0.03642

6.425596769544532
2024-06-06 17:37:06,795 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:37:45,739 - [INFO] - E:13|TAU:6.521 18.98, train_time: 37.86, VALID_time: 1.084, loss: 5.745e+03, emb_loss:4.49e-06, nce_loss:10.89, best_valid(recall@20): 0.1875
valid 	 N@5: 0.1383, R@5: 0.08999, P@5: 0.1086
valid 	 N@10: 0.1408, R@10: 0.1309, P@10: 0.07964
valid 	 N@15: 0.149, R@15: 0.162, P@15: 0.06613
valid 	 N@20: 0.157, R@20: 0.1876, P@20: 0.05785
valid 	 N@25: 0.1642, R@25: 0.2101, P@25: 0.05204
valid 	 N@30: 0.1703, R@30: 0.2294, P@30: 0.04749
valid 	 N@40: 0.1806, R@40: 0.2625, P@40: 0.04098
valid 	 N@50: 0.1892, R@50: 0.2906, P@50: 0.03652

6.425596769544532
2024-06-06 17:37:45,807 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:38:23,811 - [INFO] - E:14|TAU:6.531 18.77, train_time: 36.8, VALID_time: 1.203, loss: 5.742e+03, emb_loss:4.909e-06, nce_loss:10.89, best_valid(recall@20): 0.1876
valid 	 N@5: 0.1383, R@5: 0.09003, P@5: 0.1085
valid 	 N@10: 0.1408, R@10: 0.1309, P@10: 0.07966
valid 	 N@15: 0.1491, R@15: 0.162, P@15: 0.06622
valid 	 N@20: 0.1569, R@20: 0.1872, P@20: 0.05779
valid 	 N@25: 0.1642, R@25: 0.21, P@25: 0.05198
valid 	 N@30: 0.1704, R@30: 0.2297, P@30: 0.04751
valid 	 N@40: 0.1807, R@40: 0.2625, P@40: 0.04099
valid 	 N@50: 0.1892, R@50: 0.2906, P@50: 0.03653

6.425596769544532
2024-06-06 17:38:23,849 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:39:01,377 - [INFO] - E:15|TAU:6.525 18.49, train_time: 36.49, VALID_time: 1.041, loss: 5.739e+03, emb_loss:5.341e-06, nce_loss:10.89, best_valid(recall@20): 0.1876
valid 	 N@5: 0.1385, R@5: 0.09018, P@5: 0.1086
valid 	 N@10: 0.141, R@10: 0.1311, P@10: 0.07972
valid 	 N@15: 0.1492, R@15: 0.1619, P@15: 0.06617
valid 	 N@20: 0.1573, R@20: 0.1881, P@20: 0.05795
valid 	 N@25: 0.1643, R@25: 0.21, P@25: 0.05204
valid 	 N@30: 0.1706, R@30: 0.2297, P@30: 0.04755
valid 	 N@40: 0.1809, R@40: 0.2627, P@40: 0.04103
valid 	 N@50: 0.1894, R@50: 0.2908, P@50: 0.03653

6.425596769544532
2024-06-06 17:39:01,445 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:39:39,263 - [INFO] - E:16|TAU:6.537 18.39, train_time: 36.71, VALID_time: 1.11, loss: 5.737e+03, emb_loss:5.783e-06, nce_loss:10.89, best_valid(recall@20): 0.1881
valid 	 N@5: 0.1386, R@5: 0.08997, P@5: 0.1084
valid 	 N@10: 0.141, R@10: 0.1307, P@10: 0.07956
valid 	 N@15: 0.1495, R@15: 0.1623, P@15: 0.06627
valid 	 N@20: 0.1574, R@20: 0.1879, P@20: 0.05794
valid 	 N@25: 0.1647, R@25: 0.2106, P@25: 0.05213
valid 	 N@30: 0.1709, R@30: 0.2301, P@30: 0.04762
valid 	 N@40: 0.1811, R@40: 0.2629, P@40: 0.04105
valid 	 N@50: 0.1897, R@50: 0.2911, P@50: 0.03655

6.425596769544532
2024-06-06 17:39:39,299 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:40:17,188 - [INFO] - E:17|TAU:6.528 18.77, train_time: 36.76, VALID_time: 1.128, loss: 5.735e+03, emb_loss:6.237e-06, nce_loss:10.89, best_valid(recall@20): 0.1881
valid 	 N@5: 0.1386, R@5: 0.09015, P@5: 0.1085
valid 	 N@10: 0.1412, R@10: 0.1311, P@10: 0.07981
valid 	 N@15: 0.1494, R@15: 0.1622, P@15: 0.06619
valid 	 N@20: 0.1577, R@20: 0.1886, P@20: 0.05803
valid 	 N@25: 0.1646, R@25: 0.2104, P@25: 0.05206
valid 	 N@30: 0.1709, R@30: 0.23, P@30: 0.04761
valid 	 N@40: 0.1812, R@40: 0.2629, P@40: 0.04106
valid 	 N@50: 0.1896, R@50: 0.2907, P@50: 0.03655

6.425596769544532
2024-06-06 17:40:17,268 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 17:40:56,579 - [INFO] - E:18|TAU:6.522 17.8, train_time: 38.2, VALID_time: 1.114, loss: 5.733e+03, emb_loss:6.701e-06, nce_loss:10.89, best_valid(recall@20): 0.1886
valid 	 N@5: 0.1385, R@5: 0.09002, P@5: 0.1085
valid 	 N@10: 0.141, R@10: 0.1309, P@10: 0.07982
valid 	 N@15: 0.1493, R@15: 0.1621, P@15: 0.06619
valid 	 N@20: 0.1576, R@20: 0.1887, P@20: 0.05806
valid 	 N@25: 0.1646, R@25: 0.2108, P@25: 0.05216
valid 	 N@30: 0.1709, R@30: 0.2305, P@30: 0.04768
valid 	 N@40: 0.1811, R@40: 0.2632, P@40: 0.04109
valid 	 N@50: 0.1896, R@50: 0.2912, P@50: 0.03658

6.425596769544532
2024-06-06 17:40:56,652 - [INFO] - current w_0 is 9.17942388767301
