2024-06-11 00:52:49,144 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_11_06_2024_00:52:49', 'train_ratio': 0.8, 'gnn': 'lgntau', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-11 00:52:51,511 - [INFO] - load train.txt
2024-06-11 00:52:55,768 - [INFO] - building the adj mat ...
2024-06-11 00:52:56,372 - [INFO] - train set len is 810128
2024-06-11 00:52:56,372 - [INFO] - test set len is 217242
2024-06-11 00:52:56,372 - [INFO] - loading over ...
2024-06-11 00:52:56,372 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-11 00:53:13,384 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-11 00:53:13,385 - [INFO] - start training ...
6.425596769544532
2024-06-11 00:53:13,423 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:54:15,719 - [INFO] - E:0|TAU:9.179 9.179, train_time: 60.65, VALID_time: 1.628, loss: 1.889e+03, emb_loss:5.319e-07, nce_loss:15.05, best_valid(recall@20): -inf
valid 	 N@5: 0.119, R@5: 0.07964, P@5: 0.09363
valid 	 N@10: 0.1224, R@10: 0.1163, P@10: 0.06904
valid 	 N@15: 0.1307, R@15: 0.1448, P@15: 0.05771
valid 	 N@20: 0.1379, R@20: 0.1672, P@20: 0.05029
valid 	 N@25: 0.1446, R@25: 0.1877, P@25: 0.04532
valid 	 N@30: 0.1504, R@30: 0.2056, P@30: 0.04146
valid 	 N@40: 0.16, R@40: 0.2359, P@40: 0.03586
valid 	 N@50: 0.1677, R@50: 0.2614, P@50: 0.03195

6.425596769544532
2024-06-11 00:54:15,778 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:55:18,286 - [INFO] - E:1|TAU:6.173 24.95, train_time: 61.03, VALID_time: 1.464, loss: 1.674e+03, emb_loss:9.567e-07, nce_loss:15.05, best_valid(recall@20): 0.1672
valid 	 N@5: 0.1203, R@5: 0.07697, P@5: 0.09494
valid 	 N@10: 0.1217, R@10: 0.1123, P@10: 0.06976
valid 	 N@15: 0.1283, R@15: 0.1385, P@15: 0.05766
valid 	 N@20: 0.1349, R@20: 0.16, P@20: 0.05033
valid 	 N@25: 0.1405, R@25: 0.1775, P@25: 0.04498
valid 	 N@30: 0.1455, R@30: 0.1935, P@30: 0.04096
valid 	 N@40: 0.1541, R@40: 0.2209, P@40: 0.03534
valid 	 N@50: 0.1612, R@50: 0.244, P@50: 0.0314

6.425596769544532
2024-06-11 00:55:18,317 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:56:20,818 - [INFO] - E:2|TAU:6.475 23.46, train_time: 60.86, VALID_time: 1.626, loss: 1.513e+03, emb_loss:1.345e-06, nce_loss:15.04, best_valid(recall@20): 0.1672
valid 	 N@5: 0.1305, R@5: 0.08507, P@5: 0.1027
valid 	 N@10: 0.1326, R@10: 0.1233, P@10: 0.07533
valid 	 N@15: 0.1403, R@15: 0.1522, P@15: 0.06251
valid 	 N@20: 0.1478, R@20: 0.1763, P@20: 0.05457
valid 	 N@25: 0.1543, R@25: 0.1967, P@25: 0.04893
valid 	 N@30: 0.1601, R@30: 0.2147, P@30: 0.04461
valid 	 N@40: 0.1697, R@40: 0.2457, P@40: 0.03849
valid 	 N@50: 0.1776, R@50: 0.2714, P@50: 0.03425

6.425596769544532
2024-06-11 00:56:20,900 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:57:23,305 - [INFO] - E:3|TAU:6.474 24.81, train_time: 60.77, VALID_time: 1.616, loss: 1.496e+03, emb_loss:1.683e-06, nce_loss:15.04, best_valid(recall@20): 0.1763
valid 	 N@5: 0.1319, R@5: 0.08536, P@5: 0.1037
valid 	 N@10: 0.1342, R@10: 0.1249, P@10: 0.07643
valid 	 N@15: 0.1423, R@15: 0.1551, P@15: 0.06364
valid 	 N@20: 0.1502, R@20: 0.1802, P@20: 0.05566
valid 	 N@25: 0.1569, R@25: 0.2012, P@25: 0.04989
valid 	 N@30: 0.1628, R@30: 0.2198, P@30: 0.04554
valid 	 N@40: 0.1725, R@40: 0.2509, P@40: 0.03927
valid 	 N@50: 0.1805, R@50: 0.277, P@50: 0.03491

6.425596769544532
2024-06-11 00:57:23,393 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:58:26,059 - [INFO] - E:4|TAU:6.48 21.27, train_time: 61.15, VALID_time: 1.498, loss: 1.471e+03, emb_loss:2.018e-06, nce_loss:15.04, best_valid(recall@20): 0.1802
valid 	 N@5: 0.1353, R@5: 0.08793, P@5: 0.1061
valid 	 N@10: 0.138, R@10: 0.1288, P@10: 0.07813
valid 	 N@15: 0.146, R@15: 0.1587, P@15: 0.06475
valid 	 N@20: 0.1539, R@20: 0.184, P@20: 0.05656
valid 	 N@25: 0.1606, R@25: 0.205, P@25: 0.05066
valid 	 N@30: 0.1667, R@30: 0.2242, P@30: 0.04626
valid 	 N@40: 0.1767, R@40: 0.256, P@40: 0.03999
valid 	 N@50: 0.1849, R@50: 0.2828, P@50: 0.03556

6.425596769544532
2024-06-11 00:58:26,145 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 00:59:28,772 - [INFO] - E:5|TAU:6.498 20.55, train_time: 61.0, VALID_time: 1.61, loss: 1.461e+03, emb_loss:2.355e-06, nce_loss:15.04, best_valid(recall@20): 0.184
valid 	 N@5: 0.1356, R@5: 0.08856, P@5: 0.1065
valid 	 N@10: 0.138, R@10: 0.1286, P@10: 0.07829
valid 	 N@15: 0.1462, R@15: 0.1591, P@15: 0.06501
valid 	 N@20: 0.1542, R@20: 0.1848, P@20: 0.05683
valid 	 N@25: 0.1611, R@25: 0.2064, P@25: 0.05099
valid 	 N@30: 0.1672, R@30: 0.2253, P@30: 0.04657
valid 	 N@40: 0.1772, R@40: 0.2573, P@40: 0.0402
valid 	 N@50: 0.1855, R@50: 0.2846, P@50: 0.03577

6.425596769544532
2024-06-11 00:59:28,863 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:00:31,284 - [INFO] - E:6|TAU:6.503 19.3, train_time: 60.78, VALID_time: 1.63, loss: 1.451e+03, emb_loss:2.705e-06, nce_loss:15.04, best_valid(recall@20): 0.1848
valid 	 N@5: 0.1365, R@5: 0.08906, P@5: 0.107
valid 	 N@10: 0.1393, R@10: 0.1297, P@10: 0.07896
valid 	 N@15: 0.1472, R@15: 0.1598, P@15: 0.06535
valid 	 N@20: 0.1549, R@20: 0.1847, P@20: 0.05684
valid 	 N@25: 0.162, R@25: 0.2067, P@25: 0.0511
valid 	 N@30: 0.168, R@30: 0.2257, P@30: 0.04667
valid 	 N@40: 0.1783, R@40: 0.2583, P@40: 0.04034
valid 	 N@50: 0.1866, R@50: 0.2855, P@50: 0.03589

6.425596769544532
2024-06-11 01:00:31,315 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:01:33,970 - [INFO] - E:7|TAU:6.516 19.13, train_time: 61.17, VALID_time: 1.474, loss: 1.446e+03, emb_loss:3.061e-06, nce_loss:15.04, best_valid(recall@20): 0.1848
valid 	 N@5: 0.1371, R@5: 0.08933, P@5: 0.1075
valid 	 N@10: 0.1399, R@10: 0.1305, P@10: 0.0792
valid 	 N@15: 0.1479, R@15: 0.1604, P@15: 0.06559
valid 	 N@20: 0.1559, R@20: 0.1861, P@20: 0.0573
valid 	 N@25: 0.1628, R@25: 0.2078, P@25: 0.05135
valid 	 N@30: 0.1689, R@30: 0.227, P@30: 0.0469
valid 	 N@40: 0.1791, R@40: 0.2594, P@40: 0.04053
valid 	 N@50: 0.1874, R@50: 0.2866, P@50: 0.03598

6.425596769544532
2024-06-11 01:01:34,058 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:02:36,319 - [INFO] - E:8|TAU:6.509 19.17, train_time: 60.79, VALID_time: 1.453, loss: 1.44e+03, emb_loss:3.428e-06, nce_loss:15.04, best_valid(recall@20): 0.1861
valid 	 N@5: 0.1374, R@5: 0.08972, P@5: 0.1078
valid 	 N@10: 0.1404, R@10: 0.1312, P@10: 0.07966
valid 	 N@15: 0.1483, R@15: 0.1612, P@15: 0.06584
valid 	 N@20: 0.1562, R@20: 0.1865, P@20: 0.05742
valid 	 N@25: 0.1632, R@25: 0.2085, P@25: 0.05158
valid 	 N@30: 0.1694, R@30: 0.2279, P@30: 0.04709
valid 	 N@40: 0.1795, R@40: 0.2599, P@40: 0.04062
valid 	 N@50: 0.1878, R@50: 0.2871, P@50: 0.0361

6.425596769544532
2024-06-11 01:02:36,401 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:03:38,910 - [INFO] - E:9|TAU:6.514 18.78, train_time: 60.98, VALID_time: 1.51, loss: 1.436e+03, emb_loss:3.806e-06, nce_loss:15.04, best_valid(recall@20): 0.1865
valid 	 N@5: 0.1373, R@5: 0.08964, P@5: 0.1078
valid 	 N@10: 0.1404, R@10: 0.1313, P@10: 0.07975
valid 	 N@15: 0.1486, R@15: 0.1619, P@15: 0.06607
valid 	 N@20: 0.1564, R@20: 0.1871, P@20: 0.05757
valid 	 N@25: 0.1634, R@25: 0.209, P@25: 0.05165
valid 	 N@30: 0.1695, R@30: 0.2281, P@30: 0.04714
valid 	 N@40: 0.1798, R@40: 0.261, P@40: 0.04075
valid 	 N@50: 0.1881, R@50: 0.2883, P@50: 0.03621

6.425596769544532
2024-06-11 01:03:38,989 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:04:41,377 - [INFO] - E:10|TAU:6.508 19.06, train_time: 60.85, VALID_time: 1.524, loss: 1.433e+03, emb_loss:4.194e-06, nce_loss:15.04, best_valid(recall@20): 0.1871
valid 	 N@5: 0.1375, R@5: 0.08978, P@5: 0.108
valid 	 N@10: 0.1406, R@10: 0.1313, P@10: 0.07978
valid 	 N@15: 0.1488, R@15: 0.1619, P@15: 0.06614
valid 	 N@20: 0.1567, R@20: 0.1875, P@20: 0.05773
valid 	 N@25: 0.1637, R@25: 0.2093, P@25: 0.05172
valid 	 N@30: 0.1698, R@30: 0.2285, P@30: 0.04719
valid 	 N@40: 0.1802, R@40: 0.2615, P@40: 0.04086
valid 	 N@50: 0.1885, R@50: 0.289, P@50: 0.0363

6.425596769544532
2024-06-11 01:04:41,451 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:05:44,262 - [INFO] - E:11|TAU:6.515 18.26, train_time: 61.3, VALID_time: 1.498, loss: 1.429e+03, emb_loss:4.591e-06, nce_loss:15.04, best_valid(recall@20): 0.1875
valid 	 N@5: 0.1379, R@5: 0.09013, P@5: 0.1082
valid 	 N@10: 0.1407, R@10: 0.131, P@10: 0.07977
valid 	 N@15: 0.1491, R@15: 0.162, P@15: 0.0662
valid 	 N@20: 0.157, R@20: 0.1875, P@20: 0.0577
valid 	 N@25: 0.1641, R@25: 0.2096, P@25: 0.05183
valid 	 N@30: 0.1702, R@30: 0.2289, P@30: 0.0473
valid 	 N@40: 0.1806, R@40: 0.2619, P@40: 0.04087
valid 	 N@50: 0.1889, R@50: 0.2892, P@50: 0.03632

6.425596769544532
2024-06-11 01:05:44,300 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:06:46,781 - [INFO] - E:12|TAU:6.521 18.56, train_time: 61.01, VALID_time: 1.461, loss: 1.426e+03, emb_loss:4.997e-06, nce_loss:15.04, best_valid(recall@20): 0.1875
valid 	 N@5: 0.138, R@5: 0.09022, P@5: 0.1085
valid 	 N@10: 0.1407, R@10: 0.1313, P@10: 0.07992
valid 	 N@15: 0.149, R@15: 0.1621, P@15: 0.06625
valid 	 N@20: 0.1569, R@20: 0.1879, P@20: 0.05781
valid 	 N@25: 0.1639, R@25: 0.2096, P@25: 0.05183
valid 	 N@30: 0.1701, R@30: 0.2291, P@30: 0.04736
valid 	 N@40: 0.1805, R@40: 0.2622, P@40: 0.04095
valid 	 N@50: 0.1887, R@50: 0.2892, P@50: 0.03633

6.425596769544532
2024-06-11 01:06:46,864 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:07:48,932 - [INFO] - E:13|TAU:6.514 18.83, train_time: 60.6, VALID_time: 1.457, loss: 1.424e+03, emb_loss:5.413e-06, nce_loss:15.04, best_valid(recall@20): 0.1879
valid 	 N@5: 0.1378, R@5: 0.09032, P@5: 0.1083
valid 	 N@10: 0.1407, R@10: 0.1315, P@10: 0.08
valid 	 N@15: 0.1489, R@15: 0.1624, P@15: 0.0663
valid 	 N@20: 0.1569, R@20: 0.1881, P@20: 0.0579
valid 	 N@25: 0.1639, R@25: 0.2102, P@25: 0.05189
valid 	 N@30: 0.1701, R@30: 0.2293, P@30: 0.0474
valid 	 N@40: 0.1804, R@40: 0.2623, P@40: 0.04095
valid 	 N@50: 0.1887, R@50: 0.2896, P@50: 0.03637

6.425596769544532
2024-06-11 01:07:49,007 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:08:51,652 - [INFO] - E:14|TAU:6.527 18.35, train_time: 61.09, VALID_time: 1.539, loss: 1.421e+03, emb_loss:5.837e-06, nce_loss:15.04, best_valid(recall@20): 0.1881
valid 	 N@5: 0.1381, R@5: 0.0903, P@5: 0.1084
valid 	 N@10: 0.141, R@10: 0.1317, P@10: 0.08005
valid 	 N@15: 0.1493, R@15: 0.1626, P@15: 0.06639
valid 	 N@20: 0.1573, R@20: 0.1885, P@20: 0.05794
valid 	 N@25: 0.1642, R@25: 0.21, P@25: 0.05194
valid 	 N@30: 0.1703, R@30: 0.2291, P@30: 0.04739
valid 	 N@40: 0.1809, R@40: 0.2627, P@40: 0.04101
valid 	 N@50: 0.1891, R@50: 0.2899, P@50: 0.0364

6.425596769544532
2024-06-11 01:08:51,736 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:09:54,037 - [INFO] - E:15|TAU:6.518 18.34, train_time: 60.7, VALID_time: 1.582, loss: 1.419e+03, emb_loss:6.268e-06, nce_loss:15.04, best_valid(recall@20): 0.1885
valid 	 N@5: 0.1381, R@5: 0.09011, P@5: 0.1083
valid 	 N@10: 0.1413, R@10: 0.132, P@10: 0.08027
valid 	 N@15: 0.1494, R@15: 0.1626, P@15: 0.06647
valid 	 N@20: 0.1574, R@20: 0.1885, P@20: 0.05796
valid 	 N@25: 0.1645, R@25: 0.2105, P@25: 0.05202
valid 	 N@30: 0.1706, R@30: 0.2298, P@30: 0.04755
valid 	 N@40: 0.1809, R@40: 0.2627, P@40: 0.04098
valid 	 N@50: 0.1894, R@50: 0.2905, P@50: 0.03647

6.425596769544532
2024-06-11 01:09:54,069 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:10:56,326 - [INFO] - E:16|TAU:6.533 18.38, train_time: 60.64, VALID_time: 1.605, loss: 1.417e+03, emb_loss:6.705e-06, nce_loss:15.04, best_valid(recall@20): 0.1885
valid 	 N@5: 0.1388, R@5: 0.09061, P@5: 0.1088
valid 	 N@10: 0.1416, R@10: 0.1319, P@10: 0.08027
valid 	 N@15: 0.1499, R@15: 0.1628, P@15: 0.06655
valid 	 N@20: 0.1579, R@20: 0.1888, P@20: 0.05811
valid 	 N@25: 0.1651, R@25: 0.2112, P@25: 0.05212
valid 	 N@30: 0.1711, R@30: 0.2299, P@30: 0.04754
valid 	 N@40: 0.1814, R@40: 0.2628, P@40: 0.04105
valid 	 N@50: 0.1897, R@50: 0.29, P@50: 0.03645

6.425596769544532
2024-06-11 01:10:56,413 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:11:58,878 - [INFO] - E:17|TAU:6.523 18.75, train_time: 61.02, VALID_time: 1.431, loss: 1.415e+03, emb_loss:7.149e-06, nce_loss:15.04, best_valid(recall@20): 0.1888
valid 	 N@5: 0.1389, R@5: 0.09087, P@5: 0.109
valid 	 N@10: 0.1418, R@10: 0.1323, P@10: 0.08034
valid 	 N@15: 0.1502, R@15: 0.1636, P@15: 0.06675
valid 	 N@20: 0.1581, R@20: 0.189, P@20: 0.0581
valid 	 N@25: 0.1652, R@25: 0.2112, P@25: 0.05211
valid 	 N@30: 0.1713, R@30: 0.2304, P@30: 0.04757
valid 	 N@40: 0.1817, R@40: 0.2633, P@40: 0.04113
valid 	 N@50: 0.19, R@50: 0.2909, P@50: 0.03651

6.425596769544532
2024-06-11 01:11:58,964 - [INFO] - current w_0 is 9.17942388767301
2024-06-11 01:13:01,329 - [INFO] - E:18|TAU:6.517 17.67, train_time: 61.18, VALID_time: 1.171, loss: 1.413e+03, emb_loss:7.6e-06, nce_loss:15.04, best_valid(recall@20): 0.189
valid 	 N@5: 0.1386, R@5: 0.09059, P@5: 0.1087
valid 	 N@10: 0.1417, R@10: 0.1323, P@10: 0.08046
valid 	 N@15: 0.1499, R@15: 0.1632, P@15: 0.06664
valid 	 N@20: 0.1579, R@20: 0.1889, P@20: 0.05813
valid 	 N@25: 0.1651, R@25: 0.2115, P@25: 0.0522
valid 	 N@30: 0.1712, R@30: 0.2306, P@30: 0.04765
valid 	 N@40: 0.1815, R@40: 0.2633, P@40: 0.04109
valid 	 N@50: 0.1898, R@50: 0.2907, P@50: 0.03651

6.425596769544532
2024-06-11 01:13:01,359 - [INFO] - current w_0 is 9.17942388767301
