2024-06-03 13:12:43,155 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_03_06_2024_13:12:43', 'train_ratio': 0.8, 'gnn': 'lgntau', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-03 13:12:45,345 - [INFO] - load train.txt
2024-06-03 13:12:49,465 - [INFO] - building the adj mat ...
2024-06-03 13:12:50,023 - [INFO] - train set len is 810128
2024-06-03 13:12:50,023 - [INFO] - test set len is 217242
2024-06-03 13:12:50,023 - [INFO] - loading over ...
2024-06-03 13:12:50,023 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-03 13:13:00,468 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-03 13:13:00,469 - [INFO] - start training ...
6.425596769544532
2024-06-03 13:13:00,500 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:13:35,180 - [INFO] - E:0|TAU:9.179 9.179, train_time: 33.68, VALID_time: 0.9984, loss: 1.83e+03, emb_loss:2.861e-07, nce_loss:0.04987, best_valid(recall@20): -inf
valid 	 N@5: 0.1215, R@5: 0.07932, P@5: 0.09567
valid 	 N@10: 0.124, R@10: 0.1159, P@10: 0.07058
valid 	 N@15: 0.1314, R@15: 0.1435, P@15: 0.05855
valid 	 N@20: 0.1383, R@20: 0.1659, P@20: 0.05097
valid 	 N@25: 0.145, R@25: 0.1867, P@25: 0.04593
valid 	 N@30: 0.1504, R@30: 0.2039, P@30: 0.04189
valid 	 N@40: 0.16, R@40: 0.2346, P@40: 0.03631
valid 	 N@50: 0.1681, R@50: 0.2613, P@50: 0.03248

6.425596769544532
2024-06-03 13:13:35,242 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:14:09,988 - [INFO] - E:1|TAU:6.244 24.95, train_time: 33.78, VALID_time: 0.9648, loss: 1.755e+03, emb_loss:5.766e-07, nce_loss:0.04944, best_valid(recall@20): 0.1659
valid 	 N@5: 0.1231, R@5: 0.07873, P@5: 0.09648
valid 	 N@10: 0.1245, R@10: 0.1144, P@10: 0.0708
valid 	 N@15: 0.1318, R@15: 0.1424, P@15: 0.05892
valid 	 N@20: 0.1385, R@20: 0.1645, P@20: 0.05124
valid 	 N@25: 0.1447, R@25: 0.184, P@25: 0.04601
valid 	 N@30: 0.1498, R@30: 0.2004, P@30: 0.04187
valid 	 N@40: 0.1585, R@40: 0.2281, P@40: 0.03607
valid 	 N@50: 0.1658, R@50: 0.2522, P@50: 0.03208

6.425596769544532
2024-06-03 13:14:10,014 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:14:45,023 - [INFO] - E:2|TAU:6.534 23.52, train_time: 33.81, VALID_time: 1.193, loss: 1.549e+03, emb_loss:8.71e-07, nce_loss:0.04928, best_valid(recall@20): 0.1659
valid 	 N@5: 0.1302, R@5: 0.08399, P@5: 0.1021
valid 	 N@10: 0.1317, R@10: 0.1214, P@10: 0.0746
valid 	 N@15: 0.1395, R@15: 0.1506, P@15: 0.06209
valid 	 N@20: 0.1468, R@20: 0.1744, P@20: 0.05417
valid 	 N@25: 0.1532, R@25: 0.1948, P@25: 0.04855
valid 	 N@30: 0.1589, R@30: 0.2126, P@30: 0.04432
valid 	 N@40: 0.1688, R@40: 0.2442, P@40: 0.03838
valid 	 N@50: 0.177, R@50: 0.2714, P@50: 0.03424

6.425596769544532
2024-06-03 13:14:45,118 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:15:19,961 - [INFO] - E:3|TAU:6.506 24.85, train_time: 33.81, VALID_time: 1.027, loss: 1.526e+03, emb_loss:1.122e-06, nce_loss:0.04922, best_valid(recall@20): 0.1744
valid 	 N@5: 0.1323, R@5: 0.08533, P@5: 0.1041
valid 	 N@10: 0.1342, R@10: 0.1246, P@10: 0.0762
valid 	 N@15: 0.1423, R@15: 0.1547, P@15: 0.06348
valid 	 N@20: 0.1497, R@20: 0.1788, P@20: 0.05532
valid 	 N@25: 0.1566, R@25: 0.2004, P@25: 0.04969
valid 	 N@30: 0.1627, R@30: 0.2195, P@30: 0.04551
valid 	 N@40: 0.1725, R@40: 0.2513, P@40: 0.03921
valid 	 N@50: 0.1806, R@50: 0.2778, P@50: 0.03488

6.425596769544532
2024-06-03 13:15:20,046 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:15:54,990 - [INFO] - E:4|TAU:6.496 22.4, train_time: 33.89, VALID_time: 1.049, loss: 1.503e+03, emb_loss:1.377e-06, nce_loss:0.04918, best_valid(recall@20): 0.1788
valid 	 N@5: 0.1347, R@5: 0.08711, P@5: 0.1056
valid 	 N@10: 0.137, R@10: 0.1273, P@10: 0.07757
valid 	 N@15: 0.1446, R@15: 0.1566, P@15: 0.06411
valid 	 N@20: 0.1525, R@20: 0.1819, P@20: 0.05613
valid 	 N@25: 0.1593, R@25: 0.2033, P@25: 0.05039
valid 	 N@30: 0.1653, R@30: 0.2224, P@30: 0.046
valid 	 N@40: 0.1755, R@40: 0.2548, P@40: 0.03972
valid 	 N@50: 0.1836, R@50: 0.2817, P@50: 0.03529

6.425596769544532
2024-06-03 13:15:55,092 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:16:30,668 - [INFO] - E:5|TAU:6.514 20.42, train_time: 34.41, VALID_time: 1.164, loss: 1.49e+03, emb_loss:1.645e-06, nce_loss:0.04916, best_valid(recall@20): 0.1819
valid 	 N@5: 0.1352, R@5: 0.08757, P@5: 0.1063
valid 	 N@10: 0.1376, R@10: 0.128, P@10: 0.07811
valid 	 N@15: 0.1453, R@15: 0.1575, P@15: 0.0646
valid 	 N@20: 0.153, R@20: 0.1827, P@20: 0.05637
valid 	 N@25: 0.16, R@25: 0.2045, P@25: 0.05054
valid 	 N@30: 0.1662, R@30: 0.2242, P@30: 0.04625
valid 	 N@40: 0.1763, R@40: 0.2565, P@40: 0.03997
valid 	 N@50: 0.1846, R@50: 0.2836, P@50: 0.03554

6.425596769544532
2024-06-03 13:16:30,774 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:17:06,390 - [INFO] - E:6|TAU:6.514 19.52, train_time: 34.51, VALID_time: 1.106, loss: 1.479e+03, emb_loss:1.928e-06, nce_loss:0.04914, best_valid(recall@20): 0.1827
valid 	 N@5: 0.1361, R@5: 0.08847, P@5: 0.1069
valid 	 N@10: 0.1382, R@10: 0.1284, P@10: 0.07822
valid 	 N@15: 0.1459, R@15: 0.1578, P@15: 0.0647
valid 	 N@20: 0.1538, R@20: 0.1836, P@20: 0.0566
valid 	 N@25: 0.1607, R@25: 0.2051, P@25: 0.05073
valid 	 N@30: 0.1669, R@30: 0.2246, P@30: 0.0464
valid 	 N@40: 0.177, R@40: 0.2571, P@40: 0.04007
valid 	 N@50: 0.1851, R@50: 0.2838, P@50: 0.03557

6.425596769544532
2024-06-03 13:17:06,487 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:17:41,690 - [INFO] - E:7|TAU:6.524 19.95, train_time: 34.22, VALID_time: 0.9788, loss: 1.474e+03, emb_loss:2.223e-06, nce_loss:0.04913, best_valid(recall@20): 0.1836
valid 	 N@5: 0.1363, R@5: 0.08829, P@5: 0.1069
valid 	 N@10: 0.1389, R@10: 0.1292, P@10: 0.07879
valid 	 N@15: 0.1466, R@15: 0.1588, P@15: 0.06501
valid 	 N@20: 0.1545, R@20: 0.1842, P@20: 0.05685
valid 	 N@25: 0.1614, R@25: 0.2062, P@25: 0.05102
valid 	 N@30: 0.1676, R@30: 0.2257, P@30: 0.04663
valid 	 N@40: 0.1778, R@40: 0.2583, P@40: 0.04029
valid 	 N@50: 0.1861, R@50: 0.2855, P@50: 0.03581

6.425596769544532
2024-06-03 13:17:41,787 - [INFO] - current w_0 is 9.17942388767301
2024-06-03 13:18:17,023 - [INFO] - E:8|TAU:6.516 19.11, train_time: 34.26, VALID_time: 0.9728, loss: 1.468e+03, emb_loss:2.533e-06, nce_loss:0.04912, best_valid(recall@20): 0.1842
valid 	 N@5: 0.1369, R@5: 0.0888, P@5: 0.1077
valid 	 N@10: 0.1392, R@10: 0.1293, P@10: 0.07892
valid 	 N@15: 0.1471, R@15: 0.1597, P@15: 0.06536
valid 	 N@20: 0.1551, R@20: 0.1856, P@20: 0.05713
valid 	 N@25: 0.1619, R@25: 0.2068, P@25: 0.05123
valid 	 N@30: 0.1682, R@30: 0.2267, P@30: 0.04689
valid 	 N@40: 0.1784, R@40: 0.2592, P@40: 0.04045
valid 	 N@50: 0.1866, R@50: 0.2862, P@50: 0.03595

6.425596769544532
2024-06-03 13:18:17,122 - [INFO] - current w_0 is 9.17942388767301
