2024-06-06 20:35:12,064 - [INFO] - {'dataset': 'gowalla', 'data_path': './data/', 'name': 'gowalla_LGNtau_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-5_t1_0.8_t2_0.6_nodrop_06_06_2024_20:35:12', 'train_ratio': 0.8, 'gnn': 'lgntau', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 0.8, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-06-06 20:35:14,326 - [INFO] - load train.txt
2024-06-06 20:35:18,790 - [INFO] - building the adj mat ...
2024-06-06 20:35:19,420 - [INFO] - train set len is 810128
2024-06-06 20:35:19,420 - [INFO] - test set len is 217242
2024-06-06 20:35:19,420 - [INFO] - loading over ...
2024-06-06 20:35:19,420 - [INFO] - users are 29858 items are 40981
Adap_tau_Loss
start to make tables
2024-06-06 20:35:37,122 - [INFO] - Evaluation Protocols is 1 @ 20
2024-06-06 20:35:37,123 - [INFO] - start training ...
6.425596769544532
2024-06-06 20:35:37,183 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:36:48,454 - [INFO] - E:0|TAU:9.179 9.179, train_time: 69.61, VALID_time: 1.655, loss: 2.243e+03, emb_loss:2.86e-07, nce_loss:1.092, best_valid(recall@20): -inf
valid 	 N@5: 0.1217, R@5: 0.07944, P@5: 0.09581
valid 	 N@10: 0.1242, R@10: 0.116, P@10: 0.07065
valid 	 N@15: 0.1315, R@15: 0.1436, P@15: 0.05861
valid 	 N@20: 0.1385, R@20: 0.1662, P@20: 0.05103
valid 	 N@25: 0.1451, R@25: 0.1868, P@25: 0.04596
valid 	 N@30: 0.1506, R@30: 0.204, P@30: 0.04193
valid 	 N@40: 0.1602, R@40: 0.2348, P@40: 0.03635
valid 	 N@50: 0.1683, R@50: 0.2615, P@50: 0.03251

6.425596769544532
2024-06-06 20:36:48,514 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:37:59,505 - [INFO] - E:1|TAU:6.238 24.95, train_time: 69.66, VALID_time: 1.309, loss: 2.168e+03, emb_loss:5.766e-07, nce_loss:1.091, best_valid(recall@20): 0.1662
valid 	 N@5: 0.1233, R@5: 0.07889, P@5: 0.09666
valid 	 N@10: 0.1246, R@10: 0.1144, P@10: 0.07088
valid 	 N@15: 0.1318, R@15: 0.1421, P@15: 0.05885
valid 	 N@20: 0.1387, R@20: 0.1648, P@20: 0.05131
valid 	 N@25: 0.1447, R@25: 0.1839, P@25: 0.046
valid 	 N@30: 0.1499, R@30: 0.2005, P@30: 0.04189
valid 	 N@40: 0.1585, R@40: 0.2279, P@40: 0.03607
valid 	 N@50: 0.1659, R@50: 0.2521, P@50: 0.03208

6.425596769544532
2024-06-06 20:37:59,532 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:39:11,357 - [INFO] - E:2|TAU:6.542 24.35, train_time: 70.1, VALID_time: 1.709, loss: 1.963e+03, emb_loss:8.711e-07, nce_loss:1.09, best_valid(recall@20): 0.1662
valid 	 N@5: 0.1303, R@5: 0.08398, P@5: 0.1022
valid 	 N@10: 0.1319, R@10: 0.1215, P@10: 0.07468
valid 	 N@15: 0.1395, R@15: 0.1504, P@15: 0.06211
valid 	 N@20: 0.1468, R@20: 0.1744, P@20: 0.05417
valid 	 N@25: 0.1534, R@25: 0.1949, P@25: 0.04859
valid 	 N@30: 0.159, R@30: 0.2125, P@30: 0.04434
valid 	 N@40: 0.1689, R@40: 0.2442, P@40: 0.0384
valid 	 N@50: 0.177, R@50: 0.2712, P@50: 0.03424

6.425596769544532
2024-06-06 20:39:11,439 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:40:23,517 - [INFO] - E:3|TAU:6.506 24.92, train_time: 70.53, VALID_time: 1.534, loss: 1.94e+03, emb_loss:1.122e-06, nce_loss:1.09, best_valid(recall@20): 0.1744
valid 	 N@5: 0.1321, R@5: 0.08509, P@5: 0.1039
valid 	 N@10: 0.1343, R@10: 0.1245, P@10: 0.07624
valid 	 N@15: 0.1423, R@15: 0.1547, P@15: 0.06353
valid 	 N@20: 0.1497, R@20: 0.1788, P@20: 0.05533
valid 	 N@25: 0.1566, R@25: 0.2004, P@25: 0.04971
valid 	 N@30: 0.1627, R@30: 0.2197, P@30: 0.04552
valid 	 N@40: 0.1726, R@40: 0.2513, P@40: 0.03922
valid 	 N@50: 0.1805, R@50: 0.2775, P@50: 0.03486

6.425596769544532
2024-06-06 20:40:23,588 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:41:35,896 - [INFO] - E:4|TAU:6.492 24.37, train_time: 70.84, VALID_time: 1.449, loss: 1.918e+03, emb_loss:1.378e-06, nce_loss:1.09, best_valid(recall@20): 0.1788
valid 	 N@5: 0.1346, R@5: 0.08696, P@5: 0.1055
valid 	 N@10: 0.1369, R@10: 0.127, P@10: 0.07749
valid 	 N@15: 0.1446, R@15: 0.1565, P@15: 0.0641
valid 	 N@20: 0.1525, R@20: 0.1819, P@20: 0.05618
valid 	 N@25: 0.1593, R@25: 0.2032, P@25: 0.05039
valid 	 N@30: 0.1652, R@30: 0.222, P@30: 0.04598
valid 	 N@40: 0.1755, R@40: 0.2548, P@40: 0.03972
valid 	 N@50: 0.1835, R@50: 0.2815, P@50: 0.03526

6.425596769544532
2024-06-06 20:41:35,970 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:42:48,325 - [INFO] - E:5|TAU:6.525 23.86, train_time: 70.72, VALID_time: 1.613, loss: 1.905e+03, emb_loss:1.646e-06, nce_loss:1.09, best_valid(recall@20): 0.1819
valid 	 N@5: 0.1352, R@5: 0.08757, P@5: 0.1063
valid 	 N@10: 0.1377, R@10: 0.128, P@10: 0.0781
valid 	 N@15: 0.1453, R@15: 0.1575, P@15: 0.06458
valid 	 N@20: 0.153, R@20: 0.1824, P@20: 0.05638
valid 	 N@25: 0.1599, R@25: 0.2045, P@25: 0.05054
valid 	 N@30: 0.1662, R@30: 0.224, P@30: 0.04628
valid 	 N@40: 0.1763, R@40: 0.2562, P@40: 0.03998
valid 	 N@50: 0.1846, R@50: 0.2836, P@50: 0.03556

6.425596769544532
2024-06-06 20:42:48,395 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:44:00,748 - [INFO] - E:6|TAU:6.516 23.1, train_time: 70.65, VALID_time: 1.681, loss: 1.894e+03, emb_loss:1.931e-06, nce_loss:1.09, best_valid(recall@20): 0.1824
valid 	 N@5: 0.1361, R@5: 0.0885, P@5: 0.107
valid 	 N@10: 0.1382, R@10: 0.1285, P@10: 0.07829
valid 	 N@15: 0.1458, R@15: 0.1578, P@15: 0.06471
valid 	 N@20: 0.1538, R@20: 0.1836, P@20: 0.05661
valid 	 N@25: 0.1607, R@25: 0.2052, P@25: 0.05079
valid 	 N@30: 0.1668, R@30: 0.2246, P@30: 0.04641
valid 	 N@40: 0.1771, R@40: 0.2572, P@40: 0.04013
valid 	 N@50: 0.1852, R@50: 0.2841, P@50: 0.03562

6.425596769544532
2024-06-06 20:44:00,829 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:45:13,121 - [INFO] - E:7|TAU:6.54 23.15, train_time: 70.73, VALID_time: 1.544, loss: 1.888e+03, emb_loss:2.227e-06, nce_loss:1.09, best_valid(recall@20): 0.1836
valid 	 N@5: 0.1363, R@5: 0.0885, P@5: 0.1071
valid 	 N@10: 0.1388, R@10: 0.1291, P@10: 0.07875
valid 	 N@15: 0.1465, R@15: 0.1588, P@15: 0.06499
valid 	 N@20: 0.1545, R@20: 0.1843, P@20: 0.05696
valid 	 N@25: 0.1614, R@25: 0.2062, P@25: 0.05102
valid 	 N@30: 0.1674, R@30: 0.2254, P@30: 0.04658
valid 	 N@40: 0.1777, R@40: 0.2582, P@40: 0.04029
valid 	 N@50: 0.1858, R@50: 0.2849, P@50: 0.03575

6.425596769544532
2024-06-06 20:45:13,194 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:46:25,096 - [INFO] - E:8|TAU:6.518 22.48, train_time: 70.32, VALID_time: 1.557, loss: 1.882e+03, emb_loss:2.538e-06, nce_loss:1.09, best_valid(recall@20): 0.1843
valid 	 N@5: 0.1369, R@5: 0.08875, P@5: 0.1077
valid 	 N@10: 0.1392, R@10: 0.1293, P@10: 0.07895
valid 	 N@15: 0.1471, R@15: 0.1597, P@15: 0.06533
valid 	 N@20: 0.155, R@20: 0.1852, P@20: 0.05711
valid 	 N@25: 0.162, R@25: 0.207, P@25: 0.05128
valid 	 N@30: 0.1682, R@30: 0.2266, P@30: 0.04688
valid 	 N@40: 0.1784, R@40: 0.2591, P@40: 0.04045
valid 	 N@50: 0.1866, R@50: 0.286, P@50: 0.03595

6.425596769544532
2024-06-06 20:46:25,167 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:47:42,951 - [INFO] - E:9|TAU:6.523 23.15, train_time: 76.32, VALID_time: 1.436, loss: 1.878e+03, emb_loss:2.864e-06, nce_loss:1.09, best_valid(recall@20): 0.1852
valid 	 N@5: 0.137, R@5: 0.08857, P@5: 0.1075
valid 	 N@10: 0.1396, R@10: 0.1296, P@10: 0.07903
valid 	 N@15: 0.1477, R@15: 0.1603, P@15: 0.06563
valid 	 N@20: 0.1557, R@20: 0.1861, P@20: 0.05736
valid 	 N@25: 0.1626, R@25: 0.2079, P@25: 0.05142
valid 	 N@30: 0.1688, R@30: 0.2274, P@30: 0.047
valid 	 N@40: 0.1789, R@40: 0.2595, P@40: 0.04049
valid 	 N@50: 0.1871, R@50: 0.2866, P@50: 0.03601

6.425596769544532
2024-06-06 20:47:43,018 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:48:55,476 - [INFO] - E:10|TAU:6.512 23.24, train_time: 70.99, VALID_time: 1.45, loss: 1.874e+03, emb_loss:3.204e-06, nce_loss:1.09, best_valid(recall@20): 0.1861
valid 	 N@5: 0.1377, R@5: 0.08944, P@5: 0.1082
valid 	 N@10: 0.1402, R@10: 0.1304, P@10: 0.07952
valid 	 N@15: 0.1483, R@15: 0.161, P@15: 0.06587
valid 	 N@20: 0.156, R@20: 0.1863, P@20: 0.05738
valid 	 N@25: 0.163, R@25: 0.2081, P@25: 0.05149
valid 	 N@30: 0.1689, R@30: 0.2269, P@30: 0.04693
valid 	 N@40: 0.1794, R@40: 0.2604, P@40: 0.04062
valid 	 N@50: 0.1877, R@50: 0.2875, P@50: 0.03611

6.425596769544532
2024-06-06 20:48:55,546 - [INFO] - current w_0 is 9.17942388767301
2024-06-06 20:50:07,929 - [INFO] - E:11|TAU:6.523 22.51, train_time: 70.89, VALID_time: 1.473, loss: 1.87e+03, emb_loss:3.558e-06, nce_loss:1.09, best_valid(recall@20): 0.1863
valid 	 N@5: 0.1375, R@5: 0.0894, P@5: 0.108
valid 	 N@10: 0.1402, R@10: 0.1304, P@10: 0.07956
valid 	 N@15: 0.1484, R@15: 0.1614, P@15: 0.06603
valid 	 N@20: 0.1562, R@20: 0.1865, P@20: 0.05752
valid 	 N@25: 0.1632, R@25: 0.2086, P@25: 0.05157
valid 	 N@30: 0.1692, R@30: 0.2275, P@30: 0.04704
valid 	 N@40: 0.1797, R@40: 0.2611, P@40: 0.04074
valid 	 N@50: 0.1879, R@50: 0.288, P@50: 0.03618

6.425596769544532
2024-06-06 20:50:08,001 - [INFO] - current w_0 is 9.17942388767301
