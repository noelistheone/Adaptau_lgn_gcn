2024-04-28 15:48:53,006 - [INFO] - {'dataset': 'amazon-beauty', 'data_path': './data/', 'name': 'amazon-beauty_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-4_l2_1e-5_t1_1.0_t2_0.6_nodrop_28_04_2024_15:48:53', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 1e-05, 'lr': 0.0001, 'mess_dropout': False, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-28 15:48:53,374 - [INFO] - load train.txt
2024-04-28 15:48:54,523 - [INFO] - building the adj mat ...
2024-04-28 15:48:54,633 - [INFO] - train set len is 176139
2024-04-28 15:48:54,634 - [INFO] - test set len is 22363
2024-04-28 15:48:54,634 - [INFO] - loading over ...
2024-04-28 15:48:54,634 - [INFO] - users are 22363 items are 12101
Adap_tau_Loss
start to make tables
2024-04-28 15:49:07,459 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-28 15:49:07,460 - [INFO] - start training ...
6.435490250430879
2024-04-28 15:49:07,479 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:11,155 - [INFO] - E:0|TAU:9.194 9.194, train_time: 3.032, VALID_time: 0.6426, loss: 544.8, emb_loss:9.465e-08, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.006976, R@5: 0.01109, P@5: 0.002218
valid 	 N@10: 0.009219, R@10: 0.01811, P@10: 0.001811
valid 	 N@15: 0.01043, R@15: 0.02272, P@15: 0.001514
valid 	 N@20: 0.01138, R@20: 0.02674, P@20: 0.001337
valid 	 N@25: 0.01207, R@25: 0.02987, P@25: 0.001195
valid 	 N@30: 0.01269, R@30: 0.03287, P@30: 0.001096
valid 	 N@40: 0.01365, R@40: 0.03788, P@40: 0.0009469
valid 	 N@50: 0.01457, R@50: 0.04293, P@50: 0.0008586

6.435490250430879
2024-04-28 15:49:11,184 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:15,324 - [INFO] - E:1|TAU:6.845 24.85, train_time: 3.513, VALID_time: 0.6235, loss: 492.4, emb_loss:1.03e-07, nce_loss:0.0, best_valid(recall@20): 0.02674
valid 	 N@5: 0.009883, R@5: 0.01579, P@5: 0.003157
valid 	 N@10: 0.01293, R@10: 0.02518, P@10: 0.002518
valid 	 N@15: 0.01458, R@15: 0.03144, P@15: 0.002096
valid 	 N@20: 0.01577, R@20: 0.03649, P@20: 0.001824
valid 	 N@25: 0.01688, R@25: 0.04159, P@25: 0.001663
valid 	 N@30: 0.01782, R@30: 0.0461, P@30: 0.001537
valid 	 N@40: 0.01917, R@40: 0.05312, P@40: 0.001328
valid 	 N@50: 0.02017, R@50: 0.05862, P@50: 0.001172

6.435490250430879
2024-04-28 15:49:15,375 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:19,038 - [INFO] - E:2|TAU:6.729 24.84, train_time: 3.044, VALID_time: 0.618, loss: 473.2, emb_loss:1.078e-07, nce_loss:0.0, best_valid(recall@20): 0.03649
valid 	 N@5: 0.01066, R@5: 0.01663, P@5: 0.003327
valid 	 N@10: 0.01384, R@10: 0.02652, P@10: 0.002652
valid 	 N@15: 0.0158, R@15: 0.03394, P@15: 0.002263
valid 	 N@20: 0.01722, R@20: 0.03998, P@20: 0.001999
valid 	 N@25: 0.01825, R@25: 0.04467, P@25: 0.001787
valid 	 N@30: 0.01934, R@30: 0.04999, P@30: 0.001666
valid 	 N@40: 0.02085, R@40: 0.05782, P@40: 0.001445
valid 	 N@50: 0.02199, R@50: 0.06412, P@50: 0.001282

6.435490250430879
2024-04-28 15:49:19,086 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:23,211 - [INFO] - E:3|TAU:6.689 24.82, train_time: 3.522, VALID_time: 0.5995, loss: 428.3, emb_loss:1.132e-07, nce_loss:0.0, best_valid(recall@20): 0.03998
valid 	 N@5: 0.01439, R@5: 0.02272, P@5: 0.004543
valid 	 N@10: 0.01863, R@10: 0.03595, P@10: 0.003595
valid 	 N@15: 0.02121, R@15: 0.0457, P@15: 0.003047
valid 	 N@20: 0.02314, R@20: 0.05388, P@20: 0.002694
valid 	 N@25: 0.02477, R@25: 0.06135, P@25: 0.002454
valid 	 N@30: 0.02616, R@30: 0.0681, P@30: 0.00227
valid 	 N@40: 0.028, R@40: 0.07758, P@40: 0.00194
valid 	 N@50: 0.02942, R@50: 0.08545, P@50: 0.001709

6.435490250430879
2024-04-28 15:49:23,260 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:26,898 - [INFO] - E:4|TAU:6.648 24.83, train_time: 3.036, VALID_time: 0.6006, loss: 401.7, emb_loss:1.194e-07, nce_loss:0.0, best_valid(recall@20): 0.05388
valid 	 N@5: 0.01593, R@5: 0.02486, P@5: 0.004972
valid 	 N@10: 0.021, R@10: 0.04056, P@10: 0.004056
valid 	 N@15: 0.02356, R@15: 0.05022, P@15: 0.003348
valid 	 N@20: 0.02599, R@20: 0.0605, P@20: 0.003025
valid 	 N@25: 0.02764, R@25: 0.06801, P@25: 0.002721
valid 	 N@30: 0.02902, R@30: 0.07472, P@30: 0.002491
valid 	 N@40: 0.03129, R@40: 0.08648, P@40: 0.002162
valid 	 N@50: 0.03297, R@50: 0.09574, P@50: 0.001915

6.435490250430879
2024-04-28 15:49:26,948 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:31,070 - [INFO] - E:5|TAU:6.589 24.73, train_time: 3.518, VALID_time: 0.6037, loss: 388.0, emb_loss:1.241e-07, nce_loss:0.0, best_valid(recall@20): 0.0605
valid 	 N@5: 0.01636, R@5: 0.02558, P@5: 0.005116
valid 	 N@10: 0.02136, R@10: 0.04127, P@10: 0.004127
valid 	 N@15: 0.02413, R@15: 0.05174, P@15: 0.003449
valid 	 N@20: 0.02628, R@20: 0.06086, P@20: 0.003043
valid 	 N@25: 0.02799, R@25: 0.06868, P@25: 0.002747
valid 	 N@30: 0.02932, R@30: 0.07517, P@30: 0.002506
valid 	 N@40: 0.03153, R@40: 0.08662, P@40: 0.002165
valid 	 N@50: 0.0335, R@50: 0.09748, P@50: 0.00195

6.435490250430879
2024-04-28 15:49:31,115 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:34,746 - [INFO] - E:6|TAU:6.552 24.73, train_time: 3.035, VALID_time: 0.5945, loss: 371.0, emb_loss:1.287e-07, nce_loss:0.0, best_valid(recall@20): 0.06086
valid 	 N@5: 0.01858, R@5: 0.0292, P@5: 0.00584
valid 	 N@10: 0.02404, R@10: 0.04628, P@10: 0.004628
valid 	 N@15: 0.02714, R@15: 0.05804, P@15: 0.003869
valid 	 N@20: 0.02994, R@20: 0.06989, P@20: 0.003495
valid 	 N@25: 0.03173, R@25: 0.07808, P@25: 0.003123
valid 	 N@30: 0.03318, R@30: 0.0851, P@30: 0.002837
valid 	 N@40: 0.0357, R@40: 0.09815, P@40: 0.002454
valid 	 N@50: 0.03766, R@50: 0.109, P@50: 0.00218

6.435490250430879
2024-04-28 15:49:34,795 - [INFO] - current w_0 is 9.193557026776489
2024-04-28 15:49:38,916 - [INFO] - E:7|TAU:6.517 24.08, train_time: 3.518, VALID_time: 0.6012, loss: 357.4, emb_loss:1.339e-07, nce_loss:0.0, best_valid(recall@20): 0.06989
valid 	 N@5: 0.0195, R@5: 0.03063, P@5: 0.006126
valid 	 N@10: 0.02546, R@10: 0.04923, P@10: 0.004923
valid 	 N@15: 0.02899, R@15: 0.0626, P@15: 0.004174
valid 	 N@20: 0.03155, R@20: 0.07342, P@20: 0.003671
valid 	 N@25: 0.03341, R@25: 0.08197, P@25: 0.003279
valid 	 N@30: 0.03504, R@30: 0.08984, P@30: 0.002995
valid 	 N@40: 0.03748, R@40: 0.1025, P@40: 0.002562
valid 	 N@50: 0.03953, R@50: 0.1138, P@50: 0.002276

6.435490250430879
2024-04-28 15:49:38,962 - [INFO] - current w_0 is 9.193557026776489
