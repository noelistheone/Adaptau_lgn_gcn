2024-04-25 16:47:05,601 - [INFO] - {'dataset': 'Epinions', 'data_path': './data/', 'name': 'Epinions_LGN_mode_weight_mean_no_sample_nocosine_TAU_Adap_tau_Loss_2048_1024_lr_1e-3_l2_1e-4_t1_1.0_t2_0.6_drop_25_04_2024_16:47:05', 'train_ratio': 0.8, 'gnn': 'lgn', 'epoch': 1000, 'batch_size': 2048, 'test_batch_size': 2048, 'dim': 64, 'l2': 0.0001, 'lr': 0.001, 'mess_dropout': True, 'mess_dropout_rate': 0.1, 'edge_dropout': False, 'edge_dropout_rate': 0.1, 'n_negs': 1024, 'pool': 'mean', 'cuda': True, 'gpu_id': 0, 'Ks': '[5, 10, 15, 20, 25, 30, 40, 50]', 'context_hops': 3, 'eval_earlystop': 'recall@20', 'temperature': 1.0, 'temperature_2': 0.6, 'temperature_3': 1.0, 'u_norm': True, 'i_norm': True, 'out_dir': './weights/', 'log_dir': './log/', 'config_dir': './config/', 'restore': False, 'loss_fn': 'Adap_tau_Loss', 'sampling_method': 'no_sample', 'generate_mode': 'nocosine', 'tau_mode': 'weight_mean', 'cnt_lr': 100}
2024-04-25 16:47:08,307 - [INFO] - load train.txt
2024-04-25 16:47:11,934 - [INFO] - building the adj mat ...
2024-04-25 16:47:12,174 - [INFO] - train set len is 356185
2024-04-25 16:47:12,174 - [INFO] - test set len is 152652
2024-04-25 16:47:12,174 - [INFO] - loading over ...
2024-04-25 16:47:12,174 - [INFO] - users are 75888 items are 75882
Adap_tau_Loss
start to make tables
2024-04-25 16:47:30,208 - [INFO] - Evaluation Protocols is 1 @ 20
2024-04-25 16:47:30,208 - [INFO] - start training ...
8.59217033394023
2024-04-25 16:47:30,241 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:47:51,247 - [INFO] - E:0|TAU:12.27 12.27, train_time: 18.97, VALID_time: 2.036, loss: 801.0, emb_loss:2.302e-06, nce_loss:0.0, best_valid(recall@20): -inf
valid 	 N@5: 0.05063, R@5: 0.04714, P@5: 0.03353
valid 	 N@10: 0.05623, R@10: 0.06816, P@10: 0.02731
valid 	 N@15: 0.06001, R@15: 0.08197, P@15: 0.0236
valid 	 N@20: 0.06326, R@20: 0.09349, P@20: 0.02117
valid 	 N@25: 0.06577, R@25: 0.1022, P@25: 0.01928
valid 	 N@30: 0.06795, R@30: 0.1099, P@30: 0.01778
valid 	 N@40: 0.07142, R@40: 0.1219, P@40: 0.01558
valid 	 N@50: 0.07425, R@50: 0.1318, P@50: 0.014

8.59217033394023
2024-04-25 16:47:51,358 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:48:13,203 - [INFO] - E:1|TAU:3.311 4.106, train_time: 19.88, VALID_time: 1.961, loss: -34.35, emb_loss:1.008e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.03909, R@5: 0.0326, P@5: 0.02551
valid 	 N@10: 0.04157, R@10: 0.04756, P@10: 0.01955
valid 	 N@15: 0.04437, R@15: 0.05935, P@15: 0.01692
valid 	 N@20: 0.04665, R@20: 0.06837, P@20: 0.01515
valid 	 N@25: 0.04889, R@25: 0.07687, P@25: 0.01403
valid 	 N@30: 0.05095, R@30: 0.08447, P@30: 0.01323
valid 	 N@40: 0.05413, R@40: 0.09673, P@40: 0.01169
valid 	 N@50: 0.05691, R@50: 0.1073, P@50: 0.01067

8.59217033394023
2024-04-25 16:48:13,219 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:48:35,271 - [INFO] - E:2|TAU:3.332 4.573, train_time: 20.01, VALID_time: 2.044, loss: -177.6, emb_loss:1.907e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.03682, R@5: 0.03043, P@5: 0.0238
valid 	 N@10: 0.03881, R@10: 0.04395, P@10: 0.01815
valid 	 N@15: 0.04116, R@15: 0.0544, P@15: 0.01559
valid 	 N@20: 0.04329, R@20: 0.06301, P@20: 0.01398
valid 	 N@25: 0.04526, R@25: 0.07064, P@25: 0.01286
valid 	 N@30: 0.04702, R@30: 0.07715, P@30: 0.01209
valid 	 N@40: 0.05001, R@40: 0.0886, P@40: 0.01077
valid 	 N@50: 0.05265, R@50: 0.09853, P@50: 0.00991

8.59217033394023
2024-04-25 16:48:35,290 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:48:56,189 - [INFO] - E:3|TAU:3.371 4.954, train_time: 18.86, VALID_time: 2.032, loss: -198.5, emb_loss:2.326e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.0359, R@5: 0.02969, P@5: 0.02326
valid 	 N@10: 0.03773, R@10: 0.04268, P@10: 0.01769
valid 	 N@15: 0.03992, R@15: 0.05263, P@15: 0.01515
valid 	 N@20: 0.04195, R@20: 0.06082, P@20: 0.0136
valid 	 N@25: 0.04393, R@25: 0.06866, P@25: 0.01249
valid 	 N@30: 0.04554, R@30: 0.07457, P@30: 0.01171
valid 	 N@40: 0.04848, R@40: 0.08565, P@40: 0.01049
valid 	 N@50: 0.05112, R@50: 0.0957, P@50: 0.009665

8.59217033394023
2024-04-25 16:48:56,206 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:49:18,120 - [INFO] - E:4|TAU:3.378 4.878, train_time: 19.96, VALID_time: 1.953, loss: -204.6, emb_loss:2.604e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.03568, R@5: 0.02931, P@5: 0.02307
valid 	 N@10: 0.03751, R@10: 0.04231, P@10: 0.01757
valid 	 N@15: 0.03971, R@15: 0.05232, P@15: 0.01504
valid 	 N@20: 0.04175, R@20: 0.06052, P@20: 0.0135
valid 	 N@25: 0.04359, R@25: 0.0678, P@25: 0.01237
valid 	 N@30: 0.04521, R@30: 0.0738, P@30: 0.01159
valid 	 N@40: 0.04814, R@40: 0.08483, P@40: 0.01041
valid 	 N@50: 0.05071, R@50: 0.09459, P@50: 0.009582

8.59217033394023
2024-04-25 16:49:18,138 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:49:39,216 - [INFO] - E:5|TAU:3.382 4.999, train_time: 19.12, VALID_time: 1.96, loss: -207.5, emb_loss:2.845e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.03511, R@5: 0.02868, P@5: 0.02277
valid 	 N@10: 0.03721, R@10: 0.04235, P@10: 0.01752
valid 	 N@15: 0.03926, R@15: 0.05176, P@15: 0.01498
valid 	 N@20: 0.04133, R@20: 0.06017, P@20: 0.01344
valid 	 N@25: 0.04311, R@25: 0.06721, P@25: 0.01229
valid 	 N@30: 0.04467, R@30: 0.07298, P@30: 0.01151
valid 	 N@40: 0.04766, R@40: 0.08424, P@40: 0.01036
valid 	 N@50: 0.05025, R@50: 0.09418, P@50: 0.009536

8.59217033394023
2024-04-25 16:49:39,233 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:50:01,304 - [INFO] - E:6|TAU:3.383 4.934, train_time: 19.96, VALID_time: 2.109, loss: -208.5, emb_loss:3.082e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.035, R@5: 0.02854, P@5: 0.02271
valid 	 N@10: 0.03703, R@10: 0.04188, P@10: 0.01748
valid 	 N@15: 0.03917, R@15: 0.05165, P@15: 0.01497
valid 	 N@20: 0.04117, R@20: 0.05979, P@20: 0.01341
valid 	 N@25: 0.04302, R@25: 0.06701, P@25: 0.01231
valid 	 N@30: 0.04458, R@30: 0.07286, P@30: 0.01151
valid 	 N@40: 0.04752, R@40: 0.08392, P@40: 0.01035
valid 	 N@50: 0.05014, R@50: 0.094, P@50: 0.009528

8.59217033394023
2024-04-25 16:50:01,321 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:50:22,388 - [INFO] - E:7|TAU:3.383 4.982, train_time: 18.99, VALID_time: 2.072, loss: -209.4, emb_loss:3.334e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.0349, R@5: 0.02853, P@5: 0.02272
valid 	 N@10: 0.03688, R@10: 0.0418, P@10: 0.01743
valid 	 N@15: 0.039, R@15: 0.05149, P@15: 0.01494
valid 	 N@20: 0.04091, R@20: 0.0593, P@20: 0.01337
valid 	 N@25: 0.04282, R@25: 0.0667, P@25: 0.01231
valid 	 N@30: 0.04443, R@30: 0.07281, P@30: 0.01151
valid 	 N@40: 0.04733, R@40: 0.08363, P@40: 0.01036
valid 	 N@50: 0.04991, R@50: 0.09349, P@50: 0.009532

8.59217033394023
2024-04-25 16:50:22,410 - [INFO] - current w_0 is 12.274529170852588
2024-04-25 16:50:44,579 - [INFO] - E:8|TAU:3.383 4.958, train_time: 19.89, VALID_time: 2.275, loss: -209.9, emb_loss:3.603e-05, nce_loss:0.0, best_valid(recall@20): 0.09349
valid 	 N@5: 0.03502, R@5: 0.02866, P@5: 0.02277
valid 	 N@10: 0.0369, R@10: 0.04167, P@10: 0.01741
valid 	 N@15: 0.03909, R@15: 0.05154, P@15: 0.01495
valid 	 N@20: 0.04101, R@20: 0.05934, P@20: 0.01341
valid 	 N@25: 0.04292, R@25: 0.0668, P@25: 0.01233
valid 	 N@30: 0.04451, R@30: 0.07289, P@30: 0.01151
valid 	 N@40: 0.04744, R@40: 0.08381, P@40: 0.01037
valid 	 N@50: 0.05, R@50: 0.09366, P@50: 0.00953

8.59217033394023
2024-04-25 16:50:44,603 - [INFO] - current w_0 is 12.274529170852588
